<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1&nbsp; Energy Data Analysis – Anwendungsbaustein Energiedatenanalyse</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../index.html" rel="prev">
<link href="../skript/00-bilder/favicon_bcd_new.svg" rel="icon" type="image/svg+xml">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-e0b6cb0f66c6c3f8d27641e5d4bcc9c8.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../skript/energiedatenanalyse.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Energy Data Analysis</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../skript/00-bilder/logo_with_text_new.svg" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="../skript/00-bilder/logo_with_text_new.svg" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Anwendungsbaustein Energiedatenanalyse</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/bausteine-der-datenanalyse/a-energiedatenanalyse" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="../Anwendungsbaustein-Energiedatenanalyse.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preamble</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../skript/energiedatenanalyse.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Energy Data Analysis</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title"><p>Anwendungsbaustein Energiedatenanalyse</p>
<p><img src="skript/00-bilder/logo_with_text_new.svg" class="img-fluid"></p></h2>
   
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background"><span class="header-section-number">2</span> Background</a></li>
  <li><a href="#reading-the-data" id="toc-reading-the-data" class="nav-link" data-scroll-target="#reading-the-data"><span class="header-section-number">3</span> Reading the data</a></li>
  <li><a href="#organizing-data" id="toc-organizing-data" class="nav-link" data-scroll-target="#organizing-data"><span class="header-section-number">4</span> Organizing Data</a></li>
  <li><a href="#descriptive-data-analysis" id="toc-descriptive-data-analysis" class="nav-link" data-scroll-target="#descriptive-data-analysis"><span class="header-section-number">5</span> Descriptive Data Analysis</a>
  <ul class="collapse">
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization"><span class="header-section-number">5.1</span> Visualization</a>
  <ul class="collapse">
  <li><a href="#aggregating-data" id="toc-aggregating-data" class="nav-link" data-scroll-target="#aggregating-data">Aggregating Data</a></li>
  <li><a href="#generation-storage-injection" id="toc-generation-storage-injection" class="nav-link" data-scroll-target="#generation-storage-injection">Generation, Storage, Injection</a></li>
  </ul></li>
  <li><a href="#sec-task-descriptive-data-analysis" id="toc-sec-task-descriptive-data-analysis" class="nav-link" data-scroll-target="#sec-task-descriptive-data-analysis"><span class="header-section-number">5.2</span> Task: Descriptive Data Analysis</a></li>
  </ul></li>
  <li><a href="#sec-exploratory-data-analysis" id="toc-sec-exploratory-data-analysis" class="nav-link" data-scroll-target="#sec-exploratory-data-analysis"><span class="header-section-number">6</span> Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#background-marginal-electricity-analysis" id="toc-background-marginal-electricity-analysis" class="nav-link" data-scroll-target="#background-marginal-electricity-analysis"><span class="header-section-number">6.1</span> Background: Marginal Electricity Analysis</a></li>
  <li><a href="#background-priority-feed-in-of-renewable-energy" id="toc-background-priority-feed-in-of-renewable-energy" class="nav-link" data-scroll-target="#background-priority-feed-in-of-renewable-energy"><span class="header-section-number">6.2</span> Background: Priority Feed-in of Renewable Energy</a></li>
  <li><a href="#determine-residual-load-and-remaining-load" id="toc-determine-residual-load-and-remaining-load" class="nav-link" data-scroll-target="#determine-residual-load-and-remaining-load"><span class="header-section-number">6.3</span> Determine residual load and remaining load</a></li>
  <li><a href="#visualizing-the-annual-cycle" id="toc-visualizing-the-annual-cycle" class="nav-link" data-scroll-target="#visualizing-the-annual-cycle"><span class="header-section-number">6.4</span> Visualizing the Annual Cycle</a></li>
  <li><a href="#background-base-medium-and-peak-load" id="toc-background-base-medium-and-peak-load" class="nav-link" data-scroll-target="#background-base-medium-and-peak-load"><span class="header-section-number">6.5</span> Background: Base, Medium, and Peak Load</a></li>
  <li><a href="#sec-PumpedStorageContent" id="toc-sec-PumpedStorageContent" class="nav-link" data-scroll-target="#sec-PumpedStorageContent"><span class="header-section-number">6.6</span> Determining the Electricity Stored in Pumped Storage Plants</a></li>
  <li><a href="#task-exploratory-data-analysis" id="toc-task-exploratory-data-analysis" class="nav-link" data-scroll-target="#task-exploratory-data-analysis"><span class="header-section-number">6.7</span> Task: Exploratory Data Analysis</a></li>
  </ul></li>
  <li><a href="#inferential-data-analysis" id="toc-inferential-data-analysis" class="nav-link" data-scroll-target="#inferential-data-analysis"><span class="header-section-number">7</span> Inferential Data Analysis</a>
  <ul class="collapse">
  <li><a href="#background-renewable-energy-expansion-path" id="toc-background-renewable-energy-expansion-path" class="nav-link" data-scroll-target="#background-renewable-energy-expansion-path"><span class="header-section-number">7.1</span> Background: Renewable Energy Expansion Path</a></li>
  <li><a href="#background-energy-storage" id="toc-background-energy-storage" class="nav-link" data-scroll-target="#background-energy-storage"><span class="header-section-number">7.2</span> Background: Energy Storage</a></li>
  <li><a href="#calculating-storage-size" id="toc-calculating-storage-size" class="nav-link" data-scroll-target="#calculating-storage-size"><span class="header-section-number">7.3</span> Calculating Storage Size</a>
  <ul class="collapse">
  <li><a href="#surplus-or-deficit-of-renewable-energy" id="toc-surplus-or-deficit-of-renewable-energy" class="nav-link" data-scroll-target="#surplus-or-deficit-of-renewable-energy">Surplus or Deficit of Renewable Energy</a></li>
  <li><a href="#cyclicality" id="toc-cyclicality" class="nav-link" data-scroll-target="#cyclicality">Cyclicality</a></li>
  <li><a href="#capping" id="toc-capping" class="nav-link" data-scroll-target="#capping">Capping</a></li>
  </ul></li>
  <li><a href="#determine-share-of-renewable-electricity-generation" id="toc-determine-share-of-renewable-electricity-generation" class="nav-link" data-scroll-target="#determine-share-of-renewable-electricity-generation"><span class="header-section-number">7.4</span> Determine Share of Renewable Electricity Generation</a></li>
  <li><a href="#task-final-data-analysis" id="toc-task-final-data-analysis" class="nav-link" data-scroll-target="#task-final-data-analysis"><span class="header-section-number">7.5</span> Task: Final Data Analysis</a>
  <ul class="collapse">
  <li><a href="#graphical-representation-of-selected-storage-configurations" id="toc-graphical-representation-of-selected-storage-configurations" class="nav-link" data-scroll-target="#graphical-representation-of-selected-storage-configurations">Graphical Representation of Selected Storage Configurations</a></li>
  </ul></li>
  <li><a href="#bonus-estimating-the-required-peak-power-of-backup-power-plants" id="toc-bonus-estimating-the-required-peak-power-of-backup-power-plants" class="nav-link" data-scroll-target="#bonus-estimating-the-required-peak-power-of-backup-power-plants"><span class="header-section-number">7.6</span> Bonus: Estimating the Required Peak Power of Backup Power Plants</a></li>
  </ul></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways"><span class="header-section-number">8</span> Key Takeaways</a></li>
  <li><a href="#learning-check" id="toc-learning-check" class="nav-link" data-scroll-target="#learning-check"><span class="header-section-number">9</span> Learning Check</a>
  <ul class="collapse">
  <li><a href="#skills-quiz" id="toc-skills-quiz" class="nav-link" data-scroll-target="#skills-quiz"><span class="header-section-number">9.1</span> Skills Quiz</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">9.2</span> Exercises</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/bausteine-der-datenanalyse/a-energiedatenanalyse/blob/main/skript/energiedatenanalyse.qmd" class="toc-action"><i class="bi bi-github"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Energy Data Analysis</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="background" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Background</h1>
<p>Electric power is generated in power plants and transported via the power grid to electricity consumers. Power generation and consumption must always be balanced. The share of weather-dependent renewable generation is increasing, but electricity cannot yet be stored economically on a large scale. In 2023, pumped-storage power plants in Germany, with a capacity of 37.4 GWh <span class="citation" data-cites="Heimerl-Kohler-2017-Pumpspeicher-in-Deutschland">(<a href="#ref-Heimerl-Kohler-2017-Pumpspeicher-in-Deutschland" role="doc-biblioref">Heimerl und Kohler 2017</a>, p.&nbsp;77)</span>, fed in 11.1 TWh of electricity, which corresponded to 2.4 percent of Germany’s total electricity consumption of 458.3 TWh <span class="citation" data-cites="energy-charts-strom">(<a href="#ref-energy-charts-strom" role="doc-biblioref">Fraunhofer Institut für Solare Energiesysteme ISE o.&nbsp;J.</a>)</span>. Power plant scheduling and storage sizing based on generation and consumption data is therefore a relevant application area for data analysis.<br>
The Federal Network Agency publishes, among other things, data on electricity generation, consumption, and wholesale prices on <a href="https://www.smard.de/home/downloadcenter/download-marktdaten/">https://www.smard.de/</a>. (Note: Power plant data is available for generation units with an installed generation capacity of at least 100 MW.)</p>
</section>
<section id="reading-the-data" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Reading the data</h1>
<p>The electricity market data from the Federal Network Agency must be manually downloaded from <a href="https://www.smard.de/home/downloadcenter/download-marktdaten/">https://www.smard.de/</a>. In this script, data for the year 2023 is used.</p>
<div style="font-size: 90%;">
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Data</th>
<th>File name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Installed generation capacity 2023</td>
<td>Installierte_Erzeugungsleistung_202301010000_202401010000_Jahr.csv</td>
</tr>
<tr class="even">
<td>Realized electricity generation 2023</td>
<td>Realisierte_Erzeugung_202301010000_202401010000_Viertelstunde.csv</td>
</tr>
<tr class="odd">
<td>Realized electricity consumption 2023</td>
<td>Realisierter_Stromverbrauch_202301010000_202401010000_Viertelstunde.csv</td>
</tr>
</tbody>
</table>
</div>
<div id="wrn-SMARD" class="callout callout-style-simple callout-warning callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hinweis&nbsp;3.1: Download SMARD data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="quarto-layout-panel" data-layout="[[50, 50], [50, 50], [1]]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p>When selecting the time period, click “Accept”.</p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p>Select data for installed capacity in the original resolution (annual basis).</p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="00-bilder/smard-accept.png" class="img-fluid figure-img" alt="Screenshot of the data selection input mask."></p>
<figcaption>&nbsp;</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="00-bilder/smard-installed-capacity-de.png" class="img-fluid figure-img" alt="Screenshot of the data selection input mask."></p>
<figcaption>&nbsp;</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>The date format of the files depends on the language set on the website (German/English).</p>
</div>
</div>
</div>
</div>
</div>
</div>
<p>The semicolon-separated files are read as a DataFrame using the Python <code>pandas</code> module, which is imported with the alias <code>pd</code>. For this, the function <code>pd.read_csv()</code> is used. In this process:</p>
<ul>
<li><p>The value, thousands, and decimal separators are specified.<br>
<code>sep = ";", thousands = ".", decimal = ","</code></p></li>
<li><p>The columns with date and time information and the date format are defined.<br>
<code>parse_dates = [0, 1], date_format = "%d.%m.%Y %H:%M"</code></p></li>
</ul>
<div id="2305384b" class="cell" data-results="hold" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">"display.precision"</span>, <span class="dv">2</span>) <span class="co"># number of decimal places</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>installed_capacity_df <span class="op">=</span> pd.read_csv(filepath_or_buffer <span class="op">=</span> <span class="op">\</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="st">"01-daten/Installierte_Erzeugungsleistung_202301010000_202401010000_Jahr.csv"</span>, <span class="op">\</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>sep <span class="op">=</span> <span class="st">";"</span>, thousands <span class="op">=</span> <span class="st">"."</span>, decimal <span class="op">=</span> <span class="st">","</span>, <span class="op">\</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>parse_dates <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">1</span>], date_format <span class="op">=</span> <span class="st">"</span><span class="sc">%d</span><span class="st">.%m.%Y"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>generation_df <span class="op">=</span> pd.read_csv(filepath_or_buffer <span class="op">=</span> <span class="op">\</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="st">"01-daten/Realisierte_Erzeugung_202301010000_202401010000_Viertelstunde.csv"</span>, <span class="op">\</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>sep <span class="op">=</span> <span class="st">";"</span>, thousands <span class="op">=</span> <span class="st">"."</span>, decimal <span class="op">=</span> <span class="st">","</span>, <span class="op">\</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>parse_dates <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">1</span>], date_format <span class="op">=</span> <span class="st">"</span><span class="sc">%d</span><span class="st">.%m.%Y %H:%M"</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>consumption_df <span class="op">=</span> pd.read_csv(filepath_or_buffer <span class="op">=</span> <span class="op">\</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="st">"01-daten/Realisierter_Stromverbrauch_202301010000_202401010000_Viertelstunde.csv"</span>, <span class="op">\</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>sep <span class="op">=</span> <span class="st">";"</span>, thousands <span class="op">=</span> <span class="st">"."</span>, decimal <span class="op">=</span> <span class="st">","</span>, <span class="op">\</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>parse_dates <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">1</span>], date_format <span class="op">=</span> <span class="st">"</span><span class="sc">%d</span><span class="st">.%m.%Y %H:%M"</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Take a look at the string used to specify the date format: <code>"%d.%m.%Y %H:%M"</code>. Using the <a href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior">documentation</a>, can you determine what format the dates in the file use? What would be the format for April 14, 2023, at a quarter past two in the afternoon?</p>
<textarea id="date-format" name="date-format" rows="4" cols="80">You can enter your answer here. The solution is shown in the dropdown.</textarea>
<div id="tip-datumsformat" class="callout callout-style-default callout-tip callout-titled" title="Date format solution">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tipp&nbsp;3.1: Date format solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<!-- The format is different in the English-language files! -->
<table class="caption-top table">
<thead>
<tr class="header">
<th>Code</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>%d.</td>
<td>Day as a two-digit integer with separator “.”</td>
</tr>
<tr class="even">
<td>%m.</td>
<td>Month (possibly with leading zero) with separator “.”</td>
</tr>
<tr class="odd">
<td>%Y</td>
<td>Year as a four-digit integer with separator ” ”</td>
</tr>
<tr class="even">
<td>%H:</td>
<td>Hour as a two-digit integer with separator “:”</td>
</tr>
<tr class="odd">
<td>%M</td>
<td>Minute as a two-digit integer</td>
</tr>
</tbody>
</table>
<p><strong>Solution</strong>: 14.04.2023 14:15</p>
</div>
</div>
</div>
</section>
<section id="organizing-data" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Organizing Data</h1>
<p>Before data analysis, it should be checked whether the data has been correctly loaded. This means, on the one hand, verifying if the data type of all columns has been correctly recognized. You can check whether the column types of a file have been correctly loaded in Python with the command <code>df.dtypes</code>. Here is the output of this command for the DataFrame <code>generation_df</code>.</p>
<div id="2567303b" class="cell" data-results="hold" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Columns:</span><span class="ch">\n</span><span class="sc">{</span>generation_df<span class="sc">.</span>dtypes<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Columns:
Datum von                                            datetime64[ns]
Datum bis                                            datetime64[ns]
Biomasse [MWh] Originalauflösungen                          float64
Wasserkraft [MWh] Originalauflösungen                       float64
Wind Offshore [MWh] Originalauflösungen                     float64
Wind Onshore [MWh] Originalauflösungen                      float64
Photovoltaik [MWh] Originalauflösungen                      float64
Sonstige Erneuerbare [MWh] Originalauflösungen              float64
Kernenergie [MWh] Originalauflösungen                       float64
Braunkohle [MWh] Originalauflösungen                        float64
Steinkohle [MWh] Originalauflösungen                        float64
Erdgas [MWh] Originalauflösungen                            float64
Pumpspeicher [MWh] Originalauflösungen                      float64
Sonstige Konventionelle [MWh] Originalauflösungen           float64
dtype: object</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Many of the column names contain the string ” Originalauflösungen” which can be removed for clarity (note the leading space). In this way, the unit indication [MWh] could also be removed if found distracting.</p>
<div id="4354a875" class="cell" data-results="hold" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the string " Originalauflösungen"</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>installed_capacity_df.columns <span class="op">=</span> installed_capacity_df.columns.<span class="bu">str</span>.replace(pat <span class="op">=</span> <span class="st">" Originalauflösungen"</span>, repl <span class="op">=</span> <span class="st">""</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>generation_df.columns <span class="op">=</span> generation_df.columns.<span class="bu">str</span>.replace(pat <span class="op">=</span> <span class="st">" Originalauflösungen"</span>, repl <span class="op">=</span> <span class="st">""</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Columns:</span><span class="ch">\n</span><span class="sc">{</span>generation_df<span class="sc">.</span>dtypes<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>consumption_df.columns <span class="op">=</span> consumption_df.columns.<span class="bu">str</span>.replace(pat <span class="op">=</span> <span class="st">" Originalauflösungen"</span>, repl <span class="op">=</span> <span class="st">""</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Columns:
Datum von                        datetime64[ns]
Datum bis                        datetime64[ns]
Biomasse [MWh]                          float64
Wasserkraft [MWh]                       float64
Wind Offshore [MWh]                     float64
Wind Onshore [MWh]                      float64
Photovoltaik [MWh]                      float64
Sonstige Erneuerbare [MWh]              float64
Kernenergie [MWh]                       float64
Braunkohle [MWh]                        float64
Steinkohle [MWh]                        float64
Erdgas [MWh]                            float64
Pumpspeicher [MWh]                      float64
Sonstige Konventionelle [MWh]           float64
dtype: object</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>On the other hand, the loaded data should be inspected to identify errors such as conversion problems with decimal and thousand separators, date formats, an unexpected number of missing values, or other anomalies. For this purpose, not only the first rows of the dataset but also slices from the middle and the end should be checked. The command <code>pd.concat([a, b, c])</code> is useful for this, where a list of index ranges can be passed (see the second and third tabs in the following panel).</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">installed capacity</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">realized generation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">realized consumption</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div id="78cdf42d" class="cell" data-results="hold" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The DataFrame installed_capacity_df has only 1 row</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>installed_capacity_df</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Datum von</th>
<th data-quarto-table-cell-role="th">Datum bis</th>
<th data-quarto-table-cell-role="th">Biomasse [MW]</th>
<th data-quarto-table-cell-role="th">Wasserkraft [MW]</th>
<th data-quarto-table-cell-role="th">Wind Offshore [MW]</th>
<th data-quarto-table-cell-role="th">Wind Onshore [MW]</th>
<th data-quarto-table-cell-role="th">Photovoltaik [MW]</th>
<th data-quarto-table-cell-role="th">Sonstige Erneuerbare [MW]</th>
<th data-quarto-table-cell-role="th">Kernenergie [MW]</th>
<th data-quarto-table-cell-role="th">Braunkohle [MW]</th>
<th data-quarto-table-cell-role="th">Steinkohle [MW]</th>
<th data-quarto-table-cell-role="th">Erdgas [MW]</th>
<th data-quarto-table-cell-role="th">Pumpspeicher [MW]</th>
<th data-quarto-table-cell-role="th">Sonstige Konventionelle [MW]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>2023-01-01</td>
<td>2024-01-01</td>
<td>8467.0</td>
<td>5049.0</td>
<td>8129.0</td>
<td>57590.0</td>
<td>63066.0</td>
<td>440.0</td>
<td>4056.0</td>
<td>17692.0</td>
<td>18127.0</td>
<td>31808.0</td>
<td>9379.0</td>
<td>8958.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div id="93174aa4" class="cell" data-results="hold" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>pd.concat([generation_df.head(<span class="dv">2</span>), <span class="op">\</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>generation_df.iloc[<span class="bu">len</span>(generation_df)<span class="op">//</span><span class="dv">2</span>:(<span class="bu">len</span>(generation_df)<span class="op">//</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span>)], <span class="op">\</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>generation_df.tail(<span class="dv">2</span>)])</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Datum von</th>
<th data-quarto-table-cell-role="th">Datum bis</th>
<th data-quarto-table-cell-role="th">Biomasse [MWh]</th>
<th data-quarto-table-cell-role="th">Wasserkraft [MWh]</th>
<th data-quarto-table-cell-role="th">Wind Offshore [MWh]</th>
<th data-quarto-table-cell-role="th">Wind Onshore [MWh]</th>
<th data-quarto-table-cell-role="th">Photovoltaik [MWh]</th>
<th data-quarto-table-cell-role="th">Sonstige Erneuerbare [MWh]</th>
<th data-quarto-table-cell-role="th">Kernenergie [MWh]</th>
<th data-quarto-table-cell-role="th">Braunkohle [MWh]</th>
<th data-quarto-table-cell-role="th">Steinkohle [MWh]</th>
<th data-quarto-table-cell-role="th">Erdgas [MWh]</th>
<th data-quarto-table-cell-role="th">Pumpspeicher [MWh]</th>
<th data-quarto-table-cell-role="th">Sonstige Konventionelle [MWh]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>2023-01-01 00:00:00</td>
<td>2023-01-01 00:15:00</td>
<td>1094.25</td>
<td>320.0</td>
<td>684.25</td>
<td>7145.75</td>
<td>0.50</td>
<td>32.25</td>
<td>615.25</td>
<td>962.75</td>
<td>517.00</td>
<td>429.75</td>
<td>13.50</td>
<td>307.25</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2023-01-01 00:15:00</td>
<td>2023-01-01 00:30:00</td>
<td>1091.25</td>
<td>317.5</td>
<td>743.50</td>
<td>7158.25</td>
<td>0.25</td>
<td>32.25</td>
<td>614.75</td>
<td>963.25</td>
<td>518.00</td>
<td>429.50</td>
<td>9.75</td>
<td>307.25</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">17520</th>
<td>2023-07-02 13:00:00</td>
<td>2023-07-02 13:15:00</td>
<td>955.25</td>
<td>317.5</td>
<td>736.00</td>
<td>4228.50</td>
<td>6832.75</td>
<td>25.25</td>
<td>0.00</td>
<td>795.00</td>
<td>216.75</td>
<td>546.00</td>
<td>0.75</td>
<td>264.75</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">17521</th>
<td>2023-07-02 13:15:00</td>
<td>2023-07-02 13:30:00</td>
<td>956.75</td>
<td>321.5</td>
<td>693.75</td>
<td>3885.25</td>
<td>6961.25</td>
<td>25.25</td>
<td>0.00</td>
<td>791.00</td>
<td>215.00</td>
<td>545.00</td>
<td>0.00</td>
<td>266.00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">35038</th>
<td>2023-12-31 23:30:00</td>
<td>2023-12-31 23:45:00</td>
<td>1053.25</td>
<td>412.5</td>
<td>1479.25</td>
<td>7544.25</td>
<td>0.50</td>
<td>24.00</td>
<td>0.00</td>
<td>845.25</td>
<td>444.50</td>
<td>683.00</td>
<td>122.75</td>
<td>348.50</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">35039</th>
<td>2023-12-31 23:45:00</td>
<td>2024-01-01 00:00:00</td>
<td>1051.50</td>
<td>404.0</td>
<td>1469.00</td>
<td>7480.50</td>
<td>0.50</td>
<td>24.00</td>
<td>0.00</td>
<td>840.75</td>
<td>442.25</td>
<td>679.00</td>
<td>58.25</td>
<td>348.00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div id="17c1563a" class="cell" data-results="hold" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pd.concat([consumption_df.head(<span class="dv">2</span>), <span class="op">\</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>consumption_df.iloc[<span class="bu">len</span>(consumption_df)<span class="op">//</span><span class="dv">2</span>:(<span class="bu">len</span>(consumption_df)<span class="op">//</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span>)], <span class="op">\</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>consumption_df.tail(<span class="dv">2</span>)])</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Datum von</th>
<th data-quarto-table-cell-role="th">Datum bis</th>
<th data-quarto-table-cell-role="th">Gesamt (Netzlast) [MWh]</th>
<th data-quarto-table-cell-role="th">Residuallast [MWh]</th>
<th data-quarto-table-cell-role="th">Pumpspeicher [MWh]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>2023-01-01 00:00:00</td>
<td>2023-01-01 00:15:00</td>
<td>9720.75</td>
<td>1890.25</td>
<td>424.75</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2023-01-01 00:15:00</td>
<td>2023-01-01 00:30:00</td>
<td>9641.25</td>
<td>1739.25</td>
<td>443.50</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">17520</th>
<td>2023-07-02 13:00:00</td>
<td>2023-07-02 13:15:00</td>
<td>11564.00</td>
<td>-233.25</td>
<td>1147.75</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">17521</th>
<td>2023-07-02 13:15:00</td>
<td>2023-07-02 13:30:00</td>
<td>11536.25</td>
<td>-4.00</td>
<td>1223.25</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">35038</th>
<td>2023-12-31 23:30:00</td>
<td>2023-12-31 23:45:00</td>
<td>10495.75</td>
<td>1471.75</td>
<td>470.00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">35039</th>
<td>2023-12-31 23:45:00</td>
<td>2024-01-01 00:00:00</td>
<td>10289.25</td>
<td>1339.25</td>
<td>528.00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Finally, a plausibility check of the data is advisable. At the beginning, the total electricity consumption in Germany for 2023 was mentioned as 458.3 TWh. The electricity consumption and the sum of electricity generation should approximately correspond to this value.</p>
<div id="a79e4b2c" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># exclude columns with datetime</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Electricity consumption in million MWh:</span><span class="ch">\n</span><span class="st">"</span>, <span class="op">\</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>consumption_df.<span class="bu">sum</span>(numeric_only <span class="op">=</span> <span class="va">True</span>) <span class="op">//</span> (<span class="dv">1000</span> <span class="op">*</span> <span class="dv">1000</span>), sep <span class="op">=</span> <span class="st">""</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Electricity generation in million MWh"</span>, <span class="op">\</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>generation_df.<span class="bu">sum</span>(numeric_only <span class="op">=</span> <span class="va">True</span>).<span class="bu">sum</span>() <span class="op">//</span> (<span class="dv">1000</span> <span class="op">*</span> <span class="dv">1000</span>))</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Electricity consumption in million MWh:
Gesamt (Netzlast) [MWh]    458.0
Residuallast [MWh]         260.0
Pumpspeicher [MWh]          14.0
dtype: float64

Electricity generation in million MWh 448.0</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>If all files have been correctly loaded, working copies can be created with the command <code>df.copy()</code>. This way, the raw data remains always available and can be reloaded if necessary, for example, after accidentally overwriting the working copies.</p>
<div id="df5651de" class="cell" data-results="hold" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>generation <span class="op">=</span> generation_df.copy()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>consumption <span class="op">=</span> consumption_df.copy()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>installed_capacity <span class="op">=</span> installed_capacity_df.copy()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="descriptive-data-analysis" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Descriptive Data Analysis</h1>
<p>With methods of descriptive statistics, an overview of the datasets and the data can be obtained. This step is particularly useful for identifying possible errors and anomalies in the dataset. The findings obtained here can be explored in greater depth in the subsequent exploratory and inferential data analysis.</p>
<p>An initial overview of the data is provided by the method <code>pd.DataFrame.describe()</code>, which describes the distribution of the data. By using the argument <code>include = [np.number]</code>, the output can be restricted to columns with numerical data, meaning that columns with date information are excluded.</p>
<div id="edfbce95" class="cell" data-results="hold" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The DataFrame 'generation' has </span><span class="sc">{</span>generation<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> rows and </span><span class="sc">{</span>generation<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> columns.</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>generation.describe(include <span class="op">=</span> [np.number])</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>The DataFrame 'generation' has 35040 rows and 14 columns.
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Biomasse [MWh]</th>
<th data-quarto-table-cell-role="th">Wasserkraft [MWh]</th>
<th data-quarto-table-cell-role="th">Wind Offshore [MWh]</th>
<th data-quarto-table-cell-role="th">Wind Onshore [MWh]</th>
<th data-quarto-table-cell-role="th">Photovoltaik [MWh]</th>
<th data-quarto-table-cell-role="th">Sonstige Erneuerbare [MWh]</th>
<th data-quarto-table-cell-role="th">Kernenergie [MWh]</th>
<th data-quarto-table-cell-role="th">Braunkohle [MWh]</th>
<th data-quarto-table-cell-role="th">Steinkohle [MWh]</th>
<th data-quarto-table-cell-role="th">Erdgas [MWh]</th>
<th data-quarto-table-cell-role="th">Pumpspeicher [MWh]</th>
<th data-quarto-table-cell-role="th">Sonstige Konventionelle [MWh]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">count</th>
<td>35040.00</td>
<td>35040.00</td>
<td>35040.00</td>
<td>35040.00</td>
<td>35040.00</td>
<td>35040.00</td>
<td>35040.00</td>
<td>35040.00</td>
<td>35040.00</td>
<td>35040.00</td>
<td>35040.00</td>
<td>35040.00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">mean</th>
<td>1079.50</td>
<td>411.50</td>
<td>671.23</td>
<td>3389.91</td>
<td>1590.11</td>
<td>33.32</td>
<td>192.37</td>
<td>2221.58</td>
<td>1134.42</td>
<td>1431.02</td>
<td>318.19</td>
<td>330.81</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">std</th>
<td>80.16</td>
<td>83.08</td>
<td>457.65</td>
<td>2627.46</td>
<td>2470.00</td>
<td>7.69</td>
<td>305.80</td>
<td>939.80</td>
<td>838.85</td>
<td>682.72</td>
<td>425.94</td>
<td>39.99</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">min</th>
<td>892.50</td>
<td>249.75</td>
<td>0.00</td>
<td>30.25</td>
<td>0.25</td>
<td>21.75</td>
<td>0.00</td>
<td>634.25</td>
<td>170.25</td>
<td>373.00</td>
<td>0.00</td>
<td>208.50</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">25%</th>
<td>1017.50</td>
<td>334.00</td>
<td>259.00</td>
<td>1237.25</td>
<td>0.50</td>
<td>25.50</td>
<td>0.00</td>
<td>1396.25</td>
<td>506.75</td>
<td>893.25</td>
<td>38.00</td>
<td>304.50</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">50%</th>
<td>1066.75</td>
<td>420.50</td>
<td>612.25</td>
<td>2657.00</td>
<td>24.88</td>
<td>32.50</td>
<td>0.00</td>
<td>2111.25</td>
<td>814.75</td>
<td>1300.00</td>
<td>110.75</td>
<td>337.00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">75%</th>
<td>1133.25</td>
<td>481.00</td>
<td>1040.56</td>
<td>5017.19</td>
<td>2466.50</td>
<td>39.25</td>
<td>535.00</td>
<td>3000.31</td>
<td>1501.00</td>
<td>1810.75</td>
<td>443.00</td>
<td>356.00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">max</th>
<td>1293.25</td>
<td>618.25</td>
<td>1910.00</td>
<td>12039.50</td>
<td>10361.25</td>
<td>51.25</td>
<td>771.00</td>
<td>4121.75</td>
<td>3814.00</td>
<td>4169.25</td>
<td>2399.00</td>
<td>512.50</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>&nbsp;</p>
<p>From the descriptive statistics of the data, it can be seen, for example, that onshore wind contributed the largest share to electricity generation. It is also noticeable that neither onshore wind nor photovoltaics have a minimum generation value of 0, whereas this is the case for offshore wind and nuclear energy.</p>
<section id="visualization" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="visualization"><span class="header-section-number">5.1</span> Visualization</h2>
<p>Analyzing the descriptive statistics for 12 different types of generation requires focus. Complex information should therefore be presented graphically.</p>
<p>For a quick overview, for example of the distribution of total generation capacity by generation type, a pie or donut chart is useful. However, as explained in the <strong>Statistics Basics Module (Chapter 2: Single Variables)</strong>, this type of chart has the drawback that with an increasing number of categories (or characteristics to be displayed), it quickly becomes cluttered and the angles become difficult to read accurately.</p>
<p>In the following donut chart created using the method <code>pd.DataFrame.plot.pie()</code>, two adjustments were made: first, the automatic annotation of the percentage values was enabled using the format string <code>autopct='%1.1f%%'</code>. Second, the order of the columns in the DataFrame was swapped because otherwise the percentage labels and the labels of smaller slices overlap. Additionally, the substring ” [MWh]” was removed from the column names for the slice labels. While this improves the readability of the chart, this is not the main reason why the substring was removed.<br>
<strong>What do you think is the reason for this?</strong></p>
<div id="tip-DonutChart" class="callout callout-style-default callout-tip callout-titled" title="Pie Chart Solution">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tipp&nbsp;5.1: Pie Chart Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A pie or donut chart represents proportions and is therefore dimensionless.</p>
</div>
</div>
</div>
<p>You can find the details of the plot creation in the second tab.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Plotting with Pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Code for Pandas</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div id="d702c5e9" class="cell" data-results="hold" data-execution_count="10">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-11-output-1.png" alt="A pie chart shows the shares of different generation types in electricity production. The pie segments are not sorted by size but arranged to avoid label overlap." width="462" height="389" class="figure-img"></p>
<figcaption>Share of electricity generation</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div id="0a161e9e" class="cell" data-results="hold" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the pie first try - Other Erneuerbare [MWh] overlaps with Kernenergie [MWh] and Pumpspeicher [MWh]</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># generation.sum(numeric_only = True).plot.pie(colormap = "Blues", startangle = 90, rotatelabels = True, explode = explosion)</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rearrange columns, remove " [MWh]"</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>plotting_data <span class="op">=</span> generation.copy()</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>column_to_move <span class="op">=</span> plotting_data.pop(<span class="st">"Kernenergie [MWh]"</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>plotting_data.insert(<span class="dv">4</span>, <span class="st">"Kernenergie [MWh]"</span>, column_to_move)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>column_to_move <span class="op">=</span> plotting_data.pop(<span class="st">"Pumpspeicher [MWh]"</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>plotting_data.insert(<span class="dv">10</span>, <span class="st">"Pumpspeicher [MWh]"</span>, column_to_move)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>plotting_data.columns <span class="op">=</span> plotting_data.columns.<span class="bu">str</span>.replace(pat <span class="op">=</span> <span class="st">" [MWh]"</span>, repl <span class="op">=</span> <span class="st">""</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the pie</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plotting_data.<span class="bu">sum</span>(numeric_only <span class="op">=</span> <span class="va">True</span>).plot.pie(colormap <span class="op">=</span> <span class="st">"Blues"</span>, startangle <span class="op">=</span> <span class="dv">90</span>, rotatelabels <span class="op">=</span> <span class="va">False</span>, autopct<span class="op">=</span><span class="st">'</span><span class="sc">%1.1f%%</span><span class="st">'</span>, pctdistance <span class="op">=</span> <span class="fl">0.6</span>, textprops <span class="op">=</span> <span class="bu">dict</span>(size <span class="op">=</span> <span class="dv">7</span>, color <span class="op">=</span> <span class="st">'black'</span>), wedgeprops <span class="op">=</span> {<span class="st">"linewidth"</span>: <span class="fl">0.5</span>, <span class="st">"edgecolor"</span>: <span class="st">"white"</span>})</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co"># make a donut</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>circle <span class="op">=</span> plt.Circle((<span class="dv">0</span>, <span class="dv">0</span>), radius <span class="op">=</span> <span class="fl">0.7</span>, color <span class="op">=</span> <span class="st">"white"</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>ax.add_patch(circle)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
<section id="aggregating-data" class="level3">
<h3 class="anchored" data-anchor-id="aggregating-data">Aggregating Data</h3>
<p>Due to the numerous features, the descriptive and visual representation of generation capacity does not necessarily yield a clear conclusion. One way to better understand the data is to group similar features together. In the following, renewable and conventional (fossil-fuel based) generation types are aggregated to display their share values in a donut chart. Both groups are also shown in a bar chart. The <code>matplotlib.pyplot</code> module is used for the visualization. Details of the plot creation can be found in the second tab.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">Plotting with matplotlib</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Code for matplotlib</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div id="e3c5db5f" class="cell" data-results="hold" data-execution_count="12">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-13-output-1.png" alt="The graphic consists of three vertically stacked subplots. In the middle is a pie chart showing the shares of renewable energy generation (56%), conventional energy (40%), pumped storage (2.5%), and nuclear energy (1.5%). The pie segments are colored in shades of blue. Above is a horizontal bar chart showing absolute generation of renewable energies sorted ascending from bottom to top, starting with the lowest: Other Renewables, Hydropower, Offshore Wind, Biomass, Photovoltaics, Onshore Wind. Below is a horizontal bar chart showing absolute generation of conventional energy sorted ascending from bottom to top, starting with the lowest: Other Conventional, Hard Coal, Natural Gas, Lignite." width="710" height="710" class="figure-img"></p>
<figcaption>Absolute electricity generation and relative shares by generation type</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div id="ee08c491" class="cell" data-results="hold" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define renewables and conventionals, sum each</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Renewables</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>plotting_data <span class="op">=</span> generation.copy()</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>plotting_data.drop(columns <span class="op">=</span> [<span class="st">'Datum von'</span>, <span class="st">'Datum bis'</span>, <span class="st">'Biomasse [MWh]'</span>, <span class="st">'Wasserkraft [MWh]'</span>, <span class="st">'Wind Offshore [MWh]'</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="st">'Wind Onshore [MWh]'</span>, <span class="st">'Photovoltaik [MWh]'</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="st">'Sonstige Erneuerbare [MWh]'</span>], inplace <span class="op">=</span> <span class="va">True</span>)  <span class="co"># drop date columns; inplace=False returns a copy and does nothing without assignment</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>renewables <span class="op">=</span> [<span class="st">'Biomasse [MWh]'</span>, <span class="st">'Wasserkraft [MWh]'</span>, <span class="st">'Wind Offshore [MWh]'</span>, <span class="st">'Wind Onshore [MWh]'</span>, <span class="st">'Photovoltaik [MWh]'</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="st">'Sonstige Erneuerbare [MWh]'</span>]</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>plotting_data[<span class="st">"Erneuerbare"</span>] <span class="op">=</span> generation[renewables].<span class="bu">sum</span>(axis <span class="op">=</span> <span class="st">'columns'</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">## Conventionals</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>plotting_data.drop(columns <span class="op">=</span> [<span class="st">'Braunkohle [MWh]'</span>,  <span class="st">'Steinkohle [MWh]'</span>, <span class="st">'Erdgas [MWh]'</span>, <span class="st">'Sonstige Konventionelle [MWh]'</span>], inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>conventionals <span class="op">=</span> [<span class="st">'Braunkohle [MWh]'</span>,  <span class="st">'Steinkohle [MWh]'</span>, <span class="st">'Erdgas [MWh]'</span>, <span class="st">'Sonstige Konventionelle [MWh]'</span>]</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>plotting_data[<span class="st">"Konventionelle"</span>] <span class="op">=</span> generation[conventionals].<span class="bu">sum</span>(axis <span class="op">=</span> <span class="st">'columns'</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co"># rearrange columns, remove " [MWh]"</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>plotting_data <span class="op">=</span> plotting_data[[<span class="st">'Erneuerbare'</span>, <span class="st">'Pumpspeicher [MWh]'</span>, <span class="st">'Konventionelle'</span>, <span class="st">'Kernenergie [MWh]'</span>]]</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>plotting_data.columns <span class="op">=</span> plotting_data.columns.<span class="bu">str</span>.replace(pat <span class="op">=</span> <span class="st">" [MWh]"</span>, repl <span class="op">=</span> <span class="st">""</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co"># for checking - axis=columns sums columns row-wise</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co">## print(renewables)</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="co">## print(generation[renewables].sum(axis = 'columns'))</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="co">## print(plotting_data.columns)</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co">## print(plotting_data[0:3])</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="co"># create figure with three subplots</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="fl">7.5</span>, <span class="fl">7.5</span>))</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>nrows <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>ncols <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>font_size <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="co"># value for shared x-axis on barplots</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>x_lim <span class="op">=</span> generation.<span class="bu">sum</span>(numeric_only <span class="op">=</span> <span class="va">True</span>).<span class="bu">max</span>() <span class="op">*</span> <span class="fl">1.1</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a><span class="co"># array of colors</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>my_colors <span class="op">=</span> plt.get_cmap(<span class="st">'Blues'</span>)(np.linspace(<span class="fl">0.2</span>, <span class="dv">1</span>, <span class="bu">len</span>(plotting_data.<span class="bu">sum</span>())))</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the pie, use 4 out of 8 panels = middle 2 rows</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(nrows, ncols, (<span class="dv">3</span>, <span class="dv">6</span>))</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>plt.pie(x <span class="op">=</span> plotting_data.<span class="bu">sum</span>(), colors <span class="op">=</span> my_colors, startangle <span class="op">=</span> <span class="dv">350</span>, labels <span class="op">=</span> <span class="bu">list</span>(plotting_data.columns), autopct<span class="op">=</span><span class="st">'</span><span class="sc">%1.1f%%</span><span class="st">'</span>, pctdistance <span class="op">=</span> <span class="fl">0.5</span>, textprops <span class="op">=</span> <span class="bu">dict</span>(size <span class="op">=</span> font_size <span class="op">+</span> <span class="dv">1</span>), wedgeprops <span class="op">=</span> {<span class="st">"linewidth"</span>: <span class="fl">0.5</span>, <span class="st">"edgecolor"</span>: <span class="st">"white"</span>})</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a><span class="co"># make a donut</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>circle <span class="op">=</span> plt.Circle((<span class="dv">0</span>, <span class="dv">0</span>), radius <span class="op">=</span> <span class="fl">0.65</span>, color <span class="op">=</span> <span class="st">"white"</span>)</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>ax.add_patch(circle)</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a><span class="co"># top row unstacked barplot </span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>plt.subplot(nrows, ncols, (<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>generation[renewables].<span class="bu">sum</span>().sort_values(ascending <span class="op">=</span> <span class="va">False</span>).plot.barh(fontsize <span class="op">=</span> font_size, xlim <span class="op">=</span> (<span class="dv">0</span>, x_lim), color <span class="op">=</span> my_colors[<span class="dv">0</span>], edgecolor <span class="op">=</span> <span class="st">'darkgrey'</span>)</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Renewables"</span>, fontsize <span class="op">=</span> font_size <span class="op">+</span> <span class="dv">2</span>)</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a><span class="co"># bottom row unstacked barplot </span></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>plt.subplot(nrows, ncols, (<span class="dv">7</span>, <span class="dv">8</span>))</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>generation[conventionals].<span class="bu">sum</span>().sort_values(ascending <span class="op">=</span> <span class="va">False</span>).plot.barh(fontsize <span class="op">=</span> font_size, xlim <span class="op">=</span> (<span class="dv">0</span>, x_lim), color <span class="op">=</span> my_colors[<span class="dv">2</span>], edgecolor <span class="op">=</span> <span class="st">'darkgrey'</span>)</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Conventionals"</span>, fontsize <span class="op">=</span> font_size <span class="op">+</span> <span class="dv">2</span>)</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
<p>&nbsp; By aggregating similar types of electricity generation, the donut chart has been reduced to four generation categories. The generation types with only small shares of total electricity generation, pumped storage and nuclear energy, therefore stand out clearly compared to the individual representation of all generation types. Based on this, it can be discussed whether the shown aggregation is appropriate. On one hand, nuclear energy could be assigned to the conventionals if this group is defined not by fossil fuel use but by the principle of thermal steam expansion. On the other hand, generation from pumped storage should be critically examined. This aspect is discussed in the following section.</p>
<div id="wrn-komplexe-grafiken" class="callout callout-style-simple callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hinweis&nbsp;5.1: Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Complex graphics, like the one shown here, should generally be used sparingly because they can be difficult to understand and interpret. Therefore, the purpose of the graphic and the key conclusions should be clearly explained in the text.</p>
<p>Tip: Imagine you were showing the graphic spontaneously to a friend who hasn’t read your work. How would you explain the graphic to your friend? Write this explanation in your report.</p>
</div>
</div>
</section>
<section id="generation-storage-injection" class="level3">
<h3 class="anchored" data-anchor-id="generation-storage-injection">Generation, Storage, Injection</h3>
<p>Pumped-storage power plants are energy storage systems that do not produce primary energy but store electricity generated by other producers and feed it back into the grid when needed. Which producers supplied electricity to fill the pumped storage is analyzed in <a href="#sec-exploratory-data-analysis" class="quarto-xref"><span>Kapitel 6</span></a>. The realized grid feed-in of pumped-storage plants corresponds to the energy production of other power plants reduced by the losses incurred during charging and discharging (as well as any storage losses such as evaporation or seepage). The efficiency of pumped-storage power plants can be calculated using the available data for the year 2023.<br>
<strong>What was the efficiency of the pumped-storage power plants in 2023?</strong></p>
<div id="tip-pumped-storage-efficiency" class="callout callout-style-default callout-tip callout-titled" title="Solution: Pumped Storage Efficiency">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tipp&nbsp;5.2: Solution: Pumped Storage Efficiency
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="aac5c806" class="cell" data-results="hold" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total Generation Pumped Storage: </span><span class="sc">{</span>generation[<span class="st">'Pumpspeicher [MWh]'</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Total Consumption Pumped Storage: </span><span class="sc">{</span>consumption[<span class="st">'Pumpspeicher [MWh]'</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"</span><span class="sc">{</span><span class="dv">41</span> <span class="op">*</span> <span class="st">'='</span><span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Efficiency in Percent: </span><span class="ch">\t\t\t</span><span class="sc">{</span>(generation[<span class="st">'Pumpspeicher [MWh]'</span>].<span class="bu">sum</span>() <span class="op">/</span> consumption[<span class="st">'Pumpspeicher [MWh]'</span>].<span class="bu">sum</span>()) <span class="op">*</span> <span class="dv">100</span><span class="sc">:,.2f}</span><span class="ss">"</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total Generation Pumped Storage: 11,149,398.50
Total Consumption Pumped Storage: 14,095,632.75
=========================================
Efficiency in Percent:          79.10</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The actually realized electricity generation is therefore the cumulative electricity generation of the pumped-storage power plants published by the Federal Network Agency, plus the storage losses. The Federal Network Agency includes this value in the electricity consumption dataset. The following code uses the “walrus” operator <code>:=</code>, which allows assignments within expressions (here within the print statement). This makes the code more concise (although readability decreases). Assignments made using the walrus operator must be enclosed in parentheses:</p>
<div id="4fa717cb" class="cell" data-results="hold" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Storage losses:</span><span class="ch">\t\t\t</span><span class="sc">{</span>(storage_losses <span class="op">:=</span> (consumption[<span class="st">"Pumpspeicher [MWh]"</span>].<span class="bu">sum</span>() <span class="op">-</span> generation[<span class="st">"Pumpspeicher [MWh]"</span>].<span class="bu">sum</span>()) <span class="op">/</span> (<span class="dv">1000</span> <span class="op">*</span> <span class="dv">1000</span>))<span class="sc">:&gt;6.2f}</span><span class="ss"> TWh</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Cumulative electricity generation:</span><span class="ch">\t</span><span class="sc">{</span>(cumulative_generation <span class="op">:=</span> generation.<span class="bu">sum</span>(numeric_only<span class="op">=</span><span class="va">True</span>).<span class="bu">sum</span>() <span class="op">//</span> (<span class="dv">1000</span> <span class="op">*</span> <span class="dv">1000</span>))<span class="sc">:,.2f}</span><span class="ss"> TWh</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Total:</span><span class="ch">\t\t\t\t\t\t</span><span class="sc">{</span>storage_losses <span class="op">+</span> cumulative_generation<span class="sc">:,.2f}</span><span class="ss"> TWh</span><span class="ch">\n\n</span><span class="ss">"</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Storage losses:           2.95 TWh
Cumulative electricity generation:  448.00 TWh
Total:                      450.95 TWh

</code></pre>
</div>
</div>
<p>The difference between the actual realized and the electricity generation published by the Federal Network Agency amounts to just under 3 TWh, which is less than 1 percent of the total electricity generation. In other countries, the correct allocation of data is also materially significant. In Austria, pumped-storage power plants play an important role in the electricity mix.</p>
</section>
</section>
<section id="sec-task-descriptive-data-analysis" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="sec-task-descriptive-data-analysis"><span class="header-section-number">5.2</span> Task: Descriptive Data Analysis</h2>
<div class="border">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="00-bilder/Schlegeisspeicher_von_Friesenberghaus_von_Klaus_Kettner_CC_BY-SA_3.0.png" class="img-fluid figure-img" style="width:80.0%" alt="View of the Austrian alpine reservoir Schlegeisspeicher with dam."></p>
<figcaption>&nbsp;</figcaption>
</figure>
</div>
<p>View of the Schlegeisspeicher from Höhenweg. Photo by Klaus Kettner is licensed under <a href="https://creativecommons.org/licenses/by-sa/3.0/deed.de">CC BY-SA 3.0</a> and available on <a href="https://commons.wikimedia.org/w/index.php?curid=20380105">Wikimedia</a>. The image was cropped and saved in PNG format. 2012.</p>
</div>
<p>&nbsp;</p>
<p>Similar to the Federal Network Agency, the Austrian Power Grid AG (APG) publishes electricity market data at <a href="https://markttransparenz.apg.at/de/markt/Markttransparenz/erzeugung/Erzeugung-pro-Typ">https://markttransparenz.apg.at/</a>. Generation data for the year 2023 can be downloaded via this link.</p>
<p>The following file is attached to this script.</p>
<div style="font-size: 90%;">
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Data</th>
<th>Filename</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Realized Electricity Generation 2023</td>
<td>AGPT_2022-12-31T23_00_00Z_2023-12-31T23_00_00Z_15M_en_2024-06-10T09_32_38Z.csv</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<p><strong>Load the Austrian generation data and visualize the shares of generation types. What do you notice in the dataset?</strong></p>
<div id="wrn-electricity-market-austria" class="callout callout-style-simple callout-warning callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hinweis&nbsp;5.2: Download Austria Market Transparency Data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>After selecting the time period, click Export, then the Download button will appear.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="00-bilder/APG-erzeugungsdaten-2023-de.png" class="img-fluid figure-img" alt="View of the input fields to download the Austrian electricity market data."></p>
<figcaption>&nbsp;</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="00-bilder/english/APG-generation-data-2023-en.png" class="img-fluid figure-img" alt="View of the input fields to download the Austrian electricity market data in English."></p>
<figcaption>&nbsp;</figcaption>
</figure>
</div>
<p>The date format of the files depends on the language setting on the website (German/English).</p>
</div>
</div>
</div>
<p>&nbsp;</p>
<div id="tip-Austria" class="callout callout-style-default callout-tip callout-titled" title="Tip for Generation Data and Sample Solution">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tipp&nbsp;5.3: Tip for Generation Data and Sample Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The Austrian dataset differs in that it reports power (capacity) instead of generated energy. (This does not affect the visualization of generation shares.) The dataset also differs in another aspect.</p>
<p>Tip: If not all columns appear in the output of the <code>.describe()</code> method, try printing the DataFrame in two or more parts. For example:</p>
<div id="128cbb9a" class="cell" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.iloc[:, <span class="dv">0</span>:<span class="dv">5</span>].describe(include<span class="op">=</span>np.number))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.iloc[:, <span class="dv">5</span>:<span class="dv">10</span>].describe(include<span class="op">=</span>np.number))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.iloc[:, <span class="dv">10</span>:<span class="dv">15</span>].describe(include<span class="op">=</span>np.number))</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Musterlösung Strommarktdaten Österreich">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tipp</span>Musterlösung Strommarktdaten Österreich
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="border">
<div id="cbb69726" class="cell" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set decimal precision for display</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">"display.precision"</span>, <span class="dv">2</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Load dataset into variable generation0</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># !</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust the file path to the correct location of the downloaded .csv file for your own use.</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># !</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>generation0_austria_ms <span class="op">=</span> pd.read_csv(<span class="st">"01-daten/AGPT_2022-12-31T23_00_00Z_2023-12-31T23_00_00Z_15M_de_2024-06-10T09_32_38Z.csv"</span>, </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>                                     sep <span class="op">=</span> <span class="st">";"</span>, thousands <span class="op">=</span> <span class="st">"."</span>, decimal <span class="op">=</span> <span class="st">","</span>, parse_dates <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">1</span>], date_format <span class="op">=</span> <span class="st">"</span><span class="sc">%d</span><span class="st">.%m.%Y"</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generation0_austria_ms.head(<span class="dv">10</span>))</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The DataFrame generation0_austria_ms has </span><span class="sc">{</span>generation0_austria_ms<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> rows and </span><span class="sc">{</span>generation0_austria_ms<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> columns."</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Brief summary statistics of dataset</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generation0_austria_ms.describe(include<span class="op">=</span>[np.number]))</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="co"># If the dataset has many columns, some may be truncated in output.</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Print descriptive stats in chunks if needed:</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generation0_austria_ms.iloc[:, <span class="dv">0</span>:<span class="dv">5</span>].describe(include<span class="op">=</span>[np.number]))</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generation0_austria_ms.iloc[:, <span class="dv">5</span>:<span class="dv">10</span>].describe(include<span class="op">=</span>[np.number]))</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generation0_austria_ms.iloc[:, <span class="dv">10</span>:<span class="dv">15</span>].describe(include<span class="op">=</span>[np.number]))</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a copy of the dataset</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>generation_austria_ms_c <span class="op">=</span> generation0_austria_ms.copy()</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop columns with time data</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>generation_austria_ms_c <span class="op">=</span> generation_austria_ms_c.drop(columns<span class="op">=</span>[<span class="st">"Zeit von [CET/CEST]"</span>, <span class="st">"Zeit bis [CET/CEST]"</span>])</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generation_austria_ms_c.head(<span class="dv">5</span>))</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the string " [MW]" from column names</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>generation_austria_ms_c.columns <span class="op">=</span> generation_austria_ms_c.columns.<span class="bu">str</span>.replace(pat<span class="op">=</span><span class="st">" [MW]"</span>, repl<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generation_austria_ms_c.head(<span class="dv">5</span>))</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Plausibility check: the .csv file in Excel shows that the "Pumpspeicher" column contains both positive and negative values.</span></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a><span class="co"># This is also visible in the .describe() output.</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for negative values in generation columns:</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>check_negative_values <span class="op">=</span> (generation_austria_ms_c <span class="op">&lt;</span> <span class="dv">0</span>).<span class="bu">any</span>().<span class="bu">any</span>()</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> check_negative_values:</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"ERROR: Negative values detected in generation data."</span>)</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Set negative values in "Pumpspeicher" column to 0</span></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>generation_austria_ms_c[<span class="st">"Pumpspeicher"</span>] <span class="op">=</span> generation_austria_ms_c[<span class="st">"Pumpspeicher"</span>].clip(lower<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove columns with a sum of zero</span></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Approach: drop any column where the sum of all values is zero</span></span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>columns_to_drop <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> generation_austria_ms_c.columns <span class="cf">if</span> generation_austria_ms_c[col].<span class="bu">sum</span>() <span class="op">==</span> <span class="dv">0</span>]</span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>generation_austria_ms_c <span class="op">=</span> generation_austria_ms_c.drop(columns<span class="op">=</span>columns_to_drop)</span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generation_austria_ms_c.head(<span class="dv">10</span>))</span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a><span class="co"># To improve readability of very small pie chart segments, rearrange columns:</span></span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a><span class="co"># alternate between largest and smallest segment, second largest and second smallest, etc.</span></span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>sorted_columns <span class="op">=</span> generation_austria_ms_c.<span class="bu">sum</span>().sort_values().index</span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>new_order <span class="op">=</span> []</span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sorted_columns) <span class="op">//</span> <span class="dv">2</span>):</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>    new_order.append(sorted_columns[i])</span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>    new_order.append(sorted_columns[<span class="op">-</span>(i <span class="op">+</span> <span class="dv">1</span>)])</span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a><span class="co"># If odd number of columns, append the middle one last</span></span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">len</span>(sorted_columns) <span class="op">%</span> <span class="dv">2</span> <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>    new_order.append(sorted_columns[<span class="bu">len</span>(sorted_columns) <span class="op">//</span> <span class="dv">2</span>])</span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>generation_austria_ms_c <span class="op">=</span> generation_austria_ms_c[new_order]</span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">7</span>))</span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>pie_plot <span class="op">=</span> generation_austria_ms_c.<span class="bu">sum</span>(numeric_only<span class="op">=</span><span class="va">True</span>).plot.pie(</span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>    colormap<span class="op">=</span><span class="st">"Blues"</span>,</span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a>    startangle<span class="op">=</span><span class="dv">90</span>,</span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a>    rotatelabels<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a>    wedgeprops<span class="op">=</span>{<span class="st">"linewidth"</span>: <span class="dv">1</span>, <span class="st">"edgecolor"</span>: <span class="st">"white"</span>},</span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>    autopct<span class="op">=</span><span class="st">'</span><span class="sc">%1.1f%%</span><span class="st">'</span>,</span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a>    pctdistance<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a>    textprops<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">7</span>),</span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a donut chart by adding a white circle at the center</span></span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a>circle <span class="op">=</span> plt.Circle((<span class="dv">0</span>, <span class="dv">0</span>), radius<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span><span class="st">"white"</span>)</span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a>pie_plot.add_patch(circle)</span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Zeit von [CET/CEST]  Zeit bis [CET/CEST]  Wind [MW]  Solar [MW]  \
0  01.01.2023 00:00:00  01.01.2023 00:15:00     1000.0         0.0   
1  01.01.2023 00:15:00  01.01.2023 00:30:00      964.0         0.0   
2  01.01.2023 00:30:00  01.01.2023 00:45:00      956.0         0.0   
3  01.01.2023 00:45:00  01.01.2023 01:00:00      992.0         0.0   
4  01.01.2023 01:00:00  01.01.2023 01:15:00      880.0         0.0   
5  01.01.2023 01:15:00  01.01.2023 01:30:00      888.0         0.0   
6  01.01.2023 01:30:00  01.01.2023 01:45:00      948.0         0.0   
7  01.01.2023 01:45:00  01.01.2023 02:00:00      968.0         0.0   
8  01.01.2023 02:00:00  01.01.2023 02:15:00      956.0         0.0   
9  01.01.2023 02:15:00  01.01.2023 02:30:00      952.0         0.0   

   Biomasse [MW]  Gas [MW]  Kohle [MW]  Öl [MW]  Geothermie [MW]  \
0          240.0      27.6         0.0      0.0             0.07   
1          240.0      27.6         0.0      0.0             0.07   
2          240.0      28.0         0.0      0.0             0.07   
3          240.0      27.6         0.0      0.0             0.07   
4          240.0      27.6         0.0      0.0             0.07   
5          240.0      28.4         0.0      0.0             0.07   
6          240.0      28.8         0.0      0.0             0.07   
7          240.0      28.0         0.0      0.0             0.07   
8          240.0      28.8         0.0      0.0             0.07   
9          240.0      28.4         0.0      0.0             0.07   

   Pumpspeicher [MW]  Lauf- und Schwellwasser [MW]  Speicher [MW]  \
0            -1404.8                        2291.6           70.4   
1            -1532.8                        2283.2           66.8   
2            -1544.4                        2240.0          100.4   
3            -1579.6                        2199.6           77.6   
4            -1590.8                        2234.8           63.2   
5            -1602.8                        2229.2           73.6   
6            -1572.0                        2211.2           69.2   
7            -1579.2                        2194.8           70.8   
8            -1649.6                        2202.8           75.2   
9            -1702.0                        2172.4           65.6   

   Sonstige Erneuerbare [MW]  Müll [MW]  Andere [MW]  
0                        0.0      100.0         22.0  
1                        0.0      100.0         22.0  
2                        0.0      100.0         22.0  
3                        0.0      100.0         22.0  
4                        0.0      100.0         22.0  
5                        0.0      100.0         22.0  
6                        0.0      100.0         22.0  
7                        0.0      100.0         22.0  
8                        0.0      100.0         22.0  
9                        0.0      100.0         22.0  
The DataFrame generation0_austria_ms has 35040 rows and 15 columns.
       Wind [MW]  Solar [MW]  Biomasse [MW]  Gas [MW]  Kohle [MW]  Öl [MW]  \
count   35040.00    35040.00       35040.00  35040.00     35040.0  35040.0   
mean      942.84      268.01         159.94    736.68         0.0      0.0   
std       884.56      421.28          64.30    799.65         0.0      0.0   
min         4.00        0.00          52.00      0.00         0.0      0.0   
25%       204.00        0.00         100.00      0.40         0.0      0.0   
50%       644.00       20.00         156.00    472.00         0.0      0.0   
75%      1484.00      392.00         216.00   1273.60         0.0      0.0   
max      3400.00     2028.00         312.00   3599.60         0.0      0.0   

       Geothermie [MW]  Pumpspeicher [MW]  Lauf- und Schwellwasser [MW]  \
count         3.50e+04           35040.00                      35040.00   
mean          7.20e-02             283.53                       3477.12   
std           1.39e-17            1101.68                       1032.45   
min           7.20e-02           -2082.80                       1375.60   
25%           7.20e-02            -451.20                       2591.60   
50%           7.20e-02             181.60                       3516.00   
75%           7.20e-02            1010.40                       4131.20   
max           7.20e-02            3160.80                       6290.40   

       Speicher [MW]  Sonstige Erneuerbare [MW]  Müll [MW]  Andere [MW]  
count       35040.00                    35040.0    35040.0      35040.0  
mean          488.40                        0.0      100.0         22.0  
std           301.89                        0.0        0.0          0.0  
min            16.00                        0.0      100.0         22.0  
25%           248.00                        0.0      100.0         22.0  
50%           424.40                        0.0      100.0         22.0  
75%           686.00                        0.0      100.0         22.0  
max          1434.40                        0.0      100.0         22.0  
       Wind [MW]  Solar [MW]  Biomasse [MW]
count   35040.00    35040.00       35040.00
mean      942.84      268.01         159.94
std       884.56      421.28          64.30
min         4.00        0.00          52.00
25%       204.00        0.00         100.00
50%       644.00       20.00         156.00
75%      1484.00      392.00         216.00
max      3400.00     2028.00         312.00
       Gas [MW]  Kohle [MW]  Öl [MW]  Geothermie [MW]  Pumpspeicher [MW]
count  35040.00     35040.0  35040.0         3.50e+04           35040.00
mean     736.68         0.0      0.0         7.20e-02             283.53
std      799.65         0.0      0.0         1.39e-17            1101.68
min        0.00         0.0      0.0         7.20e-02           -2082.80
25%        0.40         0.0      0.0         7.20e-02            -451.20
50%      472.00         0.0      0.0         7.20e-02             181.60
75%     1273.60         0.0      0.0         7.20e-02            1010.40
max     3599.60         0.0      0.0         7.20e-02            3160.80
       Lauf- und Schwellwasser [MW]  Speicher [MW]  Sonstige Erneuerbare [MW]  \
count                      35040.00       35040.00                    35040.0   
mean                        3477.12         488.40                        0.0   
std                         1032.45         301.89                        0.0   
min                         1375.60          16.00                        0.0   
25%                         2591.60         248.00                        0.0   
50%                         3516.00         424.40                        0.0   
75%                         4131.20         686.00                        0.0   
max                         6290.40        1434.40                        0.0   

       Müll [MW]  Andere [MW]  
count    35040.0      35040.0  
mean       100.0         22.0  
std          0.0          0.0  
min        100.0         22.0  
25%        100.0         22.0  
50%        100.0         22.0  
75%        100.0         22.0  
max        100.0         22.0  
   Wind [MW]  Solar [MW]  Biomasse [MW]  Gas [MW]  Kohle [MW]  Öl [MW]  \
0     1000.0         0.0          240.0      27.6         0.0      0.0   
1      964.0         0.0          240.0      27.6         0.0      0.0   
2      956.0         0.0          240.0      28.0         0.0      0.0   
3      992.0         0.0          240.0      27.6         0.0      0.0   
4      880.0         0.0          240.0      27.6         0.0      0.0   

   Geothermie [MW]  Pumpspeicher [MW]  Lauf- und Schwellwasser [MW]  \
0             0.07            -1404.8                        2291.6   
1             0.07            -1532.8                        2283.2   
2             0.07            -1544.4                        2240.0   
3             0.07            -1579.6                        2199.6   
4             0.07            -1590.8                        2234.8   

   Speicher [MW]  Sonstige Erneuerbare [MW]  Müll [MW]  Andere [MW]  
0           70.4                        0.0      100.0         22.0  
1           66.8                        0.0      100.0         22.0  
2          100.4                        0.0      100.0         22.0  
3           77.6                        0.0      100.0         22.0  
4           63.2                        0.0      100.0         22.0  
     Wind  Solar  Biomasse   Gas  Kohle   Öl  Geothermie  Pumpspeicher  \
0  1000.0    0.0     240.0  27.6    0.0  0.0        0.07       -1404.8   
1   964.0    0.0     240.0  27.6    0.0  0.0        0.07       -1532.8   
2   956.0    0.0     240.0  28.0    0.0  0.0        0.07       -1544.4   
3   992.0    0.0     240.0  27.6    0.0  0.0        0.07       -1579.6   
4   880.0    0.0     240.0  27.6    0.0  0.0        0.07       -1590.8   

   Lauf- und Schwellwasser  Speicher  Sonstige Erneuerbare   Müll  Andere  
0                   2291.6      70.4                   0.0  100.0    22.0  
1                   2283.2      66.8                   0.0  100.0    22.0  
2                   2240.0     100.4                   0.0  100.0    22.0  
3                   2199.6      77.6                   0.0  100.0    22.0  
4                   2234.8      63.2                   0.0  100.0    22.0  
ERROR: Negative values detected in generation data.
     Wind  Solar  Biomasse   Gas  Geothermie  Pumpspeicher  \
0  1000.0    0.0     240.0  27.6        0.07           0.0   
1   964.0    0.0     240.0  27.6        0.07           0.0   
2   956.0    0.0     240.0  28.0        0.07           0.0   
3   992.0    0.0     240.0  27.6        0.07           0.0   
4   880.0    0.0     240.0  27.6        0.07           0.0   
5   888.0    0.0     240.0  28.4        0.07           0.0   
6   948.0    0.0     240.0  28.8        0.07           0.0   
7   968.0    0.0     240.0  28.0        0.07           0.0   
8   956.0    0.0     240.0  28.8        0.07           0.0   
9   952.0    0.0     240.0  28.4        0.07           0.0   

   Lauf- und Schwellwasser  Speicher   Müll  Andere  
0                   2291.6      70.4  100.0    22.0  
1                   2283.2      66.8  100.0    22.0  
2                   2240.0     100.4  100.0    22.0  
3                   2199.6      77.6  100.0    22.0  
4                   2234.8      63.2  100.0    22.0  
5                   2229.2      73.6  100.0    22.0  
6                   2211.2      69.2  100.0    22.0  
7                   2194.8      70.8  100.0    22.0  
8                   2202.8      75.2  100.0    22.0  
9                   2172.4      65.6  100.0    22.0  </code></pre>
</div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-18-output-2.png" alt="A pie chart showing shares of various generation types in electricity production. Segments are alternated by size (largest, smallest, second largest, second smallest, etc.)." width="627" height="537" class="figure-img"></p>
<figcaption>Share of electricity generation in Austria</figcaption>
</figure>
</div>
</div>
</div>
<p>Sample solution by Marc Sönnecken. For compatibility with this script, file paths and object names were adjusted. For accessibility, figure size and color palette were changed, a white inner circle added, and percentage labels repositioned.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="sec-exploratory-data-analysis" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Exploratory Data Analysis</h1>
<p>Exploratory data analysis means asking questions about the available data and answering them using data analysis methods. The insights gained in this way can help refine the questions or generate new ones. It is therefore an iterative process, aimed primarily at gaining a deeper understanding of the data. <span class="citation" data-cites="R-for-Data-Science">(<a href="#ref-R-for-Data-Science" role="doc-biblioref">Wickham, Çetinkaya-Rundel, und Grolemund 2023, Kap. 10</a> Exploratory data analysis)</span></p>
<section id="background-marginal-electricity-analysis" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="background-marginal-electricity-analysis"><span class="header-section-number">6.1</span> Background: Marginal Electricity Analysis</h2>
<p>In the present case, the exploratory examination of the dataset is guided by the question of which producers supplied electricity to <em>additionally</em> fill the pumped storage facilities beyond meeting the grid demand. The aim is to determine which electricity producers, at the times when the pumped storage plants were being filled, were capable of providing additional output. This additional electricity can be referred to briefly as marginal electricity.</p>
<div id="imp-MarginalElectricity" class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition&nbsp;6.1: Marginal Electricity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Marginal analysis examines the conditions prevailing when producing or consuming an <em>additional</em> unit. This differs from an average analysis, which examines the effect of a change in quantity across <em>all</em> units. Marginal electricity refers to an additional unit of electricity.</p>
<p>For example, suppose the current electricity generation is 100 units, consisting of 60 units of solar power and, because solar production is insufficient, an additional 40 units of coal power. In this case, each unit of electricity contains, on average, 0.4 parts coal power. Now, if an additional 20 units of electricity are demanded, these must be supplied through additional coal-fired generation. In the average view, the electricity mix now consists of 60 units of solar power and 40 + 20 = 60 units of coal power. This changes the average coal share in electricity production from 0.4 to 0.5.</p>
<p>In the marginal view, the coal share of the <em>additionally consumed</em> electricity is 20 out of 20 units, i.e., 1.</p>
</div>
</div>
</section>
<section id="background-priority-feed-in-of-renewable-energy" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="background-priority-feed-in-of-renewable-energy"><span class="header-section-number">6.2</span> Background: Priority Feed-in of Renewable Energy</h2>
<p>In Germany, since the year 2000, the Renewable Energy Sources Act has been in effect, originally introduced as the Act on the Priority of Renewable Energy Sources <a href="https://dip.bundestag.de/vorgang/gesetz-f%C3%BCr-den-vorrang-erneuerbarer-energien-erneuerbare-energien-gesetz-eeg-sowie/111957">Documentation and Information System for Parliamentary Materials</a>. This act stipulated in § 3 the priority feed-in of renewable energies:</p>
<div class="border quarto-layout-panel" data-layout="[[5, 90, 5], [1]]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 5.0%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 90.0%;justify-content: flex-start;">
<p><strong>Obligation to Purchase and Remunerate</strong><br>
(1) Grid operators are obliged to connect installations for the generation of electricity according to § 2 to their grid, to purchase all electricity offered from these installations with priority, and to remunerate the fed-in electricity in accordance with §§ 4 to 8.</p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 5.0%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>&nbsp;<br>
Act on the Priority of Renewable Energy Sources (Renewable Energy Sources Act – EEG) as well as amendments to the Energy Industry Act and the Mineral Oil Tax Act. Federal Law Gazette Year 2000 Part I No.&nbsp;13, issued in Bonn on March 31, 2000. <a href="https://www.bgbl.de/xaver/bgbl/start.xav?startbk=Bundesanzeiger_BGBl&amp;start=//*%5b@attr_id=%27bgbl100s0305.pdf%27%5d#__bgbl__%2F%2F*%5B%40attr_id%3D%27bgbl100s0305.pdf%27%5D__1718177313490">Federal Gazette</a></p>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Producers classified as renewable energy have priority feed-in to the grid. According to the current version of the law, these are:</p>
<div class="border">
<ol type="a">
<li><p>Hydropower, including wave, tidal, salinity gradient, and current energy,</p></li>
<li><p>Wind energy,</p></li>
<li><p>Solar radiation energy,</p></li>
<li><p>Geothermal energy,</p></li>
<li><p>Energy from biomass, including biogas, biomethane, landfill gas, and sewage gas, as well as from the biodegradable fraction of waste from households and industry</p></li>
</ol>
<p>Act for the Expansion of Renewable Energy Sources (Renewable Energy Sources Act – EEG 2023). § 3 Definitions. <a href="https://www.gesetze-im-internet.de/eeg_2014/__3.html" class="uri">https://www.gesetze-im-internet.de/eeg_2014/__3.html</a></p>
</div>
<p>&nbsp;</p>
<p>Non-renewable producers operate in load-following mode to cover the residual load, i.e., the grid load minus the renewable generation output. This means that two scenarios can be distinguished:</p>
<ol type="1">
<li><p><strong>Surplus of renewable energy:</strong> Electricity demand is fully met by renewable energy generation, and there is a generation surplus (or generators have been curtailed), which can serve additional electricity consumption.</p></li>
<li><p><strong>Electricity mix from renewable feed-in and load-following non-renewable producers:</strong> Renewable energy sources feed in at full capacity, and the residual load and additional electricity consumption are met by non-renewable producers.</p></li>
</ol>
<p>Which scenario applies in the power grid at a given moment can thus be determined by looking at the residual load.</p>
</section>
<section id="determine-residual-load-and-remaining-load" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="determine-residual-load-and-remaining-load"><span class="header-section-number">6.3</span> Determine residual load and remaining load</h2>
<p>The Federal Network Agency publishes, in its dataset on realized electricity consumption, the grid load, residual load, and electricity consumption by pumped storage power plants.</p>
<div id="be65eee0" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(consumption.<span class="bu">sum</span>(numeric_only <span class="op">=</span> <span class="va">True</span>))</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Gesamt (Netzlast) [MWh]    4.58e+08
Residuallast [MWh]         2.60e+08
Pumpspeicher [MWh]         1.41e+07
dtype: float64</code></pre>
</div>
</div>
<div id="imp-Residuallast" class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition&nbsp;6.2: Residual Load
</div>
</div>
<div class="callout-body-container callout-body">
<p>“Residual load […] corresponds to the total realized electricity consumption, minus the feed-in from photovoltaic, onshore wind, and offshore wind plants.” <a href="https://www.smard.de/resource/blob/212924/61a75e052eddb43a8d3cc4c6e1653fa3/smard-benutzerhandbuch-02-2024-data.pdf">SMARD.de User Manual (p.&nbsp;53)</a></p>
</div>
</div>
<p>&nbsp;</p>
<p>The residual load not covered by renewable energies is the difference between electricity consumption and generation from renewable sources. Consequently, this residual load is smaller than the residual load published by the Federal Network Agency. Both residual load and this remaining load can be calculated from the difference between grid load and the corresponding renewable electricity generation.</p>
<div id="6086964f" class="cell" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>renewables <span class="op">=</span> [<span class="st">'Biomasse [MWh]'</span>, <span class="st">'Wasserkraft [MWh]'</span>, <span class="st">'Wind Offshore [MWh]'</span>, <span class="st">'Wind Onshore [MWh]'</span>, <span class="st">'Photovoltaik [MWh]'</span>, <span class="st">'Sonstige Erneuerbare [MWh]'</span>]</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>PV_WindOnshore_WindOffshore <span class="op">=</span> [<span class="st">'Wind Offshore [MWh]'</span>, <span class="st">'Wind Onshore [MWh]'</span>, <span class="st">'Photovoltaik [MWh]'</span>] </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>plotting_data <span class="op">=</span> pd.DataFrame()</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>plotting_data[<span class="st">"Netzlast [MWh]"</span>] <span class="op">=</span> consumption[<span class="st">"Gesamt (Netzlast) [MWh]"</span>].copy() </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>plotting_data[<span class="st">"volatile EE [MWh]"</span>] <span class="op">=</span> generation[PV_WindOnshore_WindOffshore].<span class="bu">sum</span>(axis<span class="op">=</span><span class="st">"columns"</span>).copy()</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>plotting_data[<span class="st">"Erneuerbare [MWh]"</span>] <span class="op">=</span> generation[renewables].<span class="bu">sum</span>(axis<span class="op">=</span><span class="st">"columns"</span>).copy()</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>plotting_data[<span class="st">"Residuallast BNetzA [MWh]"</span>] <span class="op">=</span> consumption[<span class="st">"Residuallast [MWh]"</span>].copy()</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>plotting_data[<span class="st">"Residuallast [MWh]"</span>] <span class="op">=</span> plotting_data[<span class="st">"Netzlast [MWh]"</span>] <span class="op">-</span> plotting_data[<span class="st">"volatile EE [MWh]"</span>]</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>plotting_data[<span class="st">"Restlast [MWh]"</span>] <span class="op">=</span> plotting_data[<span class="st">"Netzlast [MWh]"</span>] <span class="op">-</span> plotting_data[<span class="st">"Erneuerbare [MWh]"</span>]</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>plotting_data.head()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Netzlast [MWh]</th>
<th data-quarto-table-cell-role="th">volatile EE [MWh]</th>
<th data-quarto-table-cell-role="th">Erneuerbare [MWh]</th>
<th data-quarto-table-cell-role="th">Residuallast BNetzA [MWh]</th>
<th data-quarto-table-cell-role="th">Residuallast [MWh]</th>
<th data-quarto-table-cell-role="th">Restlast [MWh]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>9720.75</td>
<td>7830.50</td>
<td>9277.00</td>
<td>1890.25</td>
<td>1890.25</td>
<td>443.75</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>9641.25</td>
<td>7902.00</td>
<td>9343.00</td>
<td>1739.25</td>
<td>1739.25</td>
<td>298.25</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>9609.50</td>
<td>8119.50</td>
<td>9559.50</td>
<td>1490.00</td>
<td>1490.00</td>
<td>50.00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>9565.00</td>
<td>7919.00</td>
<td>9362.25</td>
<td>1646.00</td>
<td>1646.00</td>
<td>202.75</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>9473.50</td>
<td>8107.75</td>
<td>9540.50</td>
<td>1365.75</td>
<td>1365.75</td>
<td>-67.00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>&nbsp;</p>
<p>The residual load published by the Federal Network Agency <code>Residual Load BNetzA [MWh]</code> corresponds, based on the inspection of the first few rows, to the self-calculated residual load <code>Residual Load [MWh]</code>. Whether this holds true for the entire time series can be easily checked using the method <code>pd.Series.equals()</code>, which returns a boolean value, i.e., True or False.</p>
<div id="bffe3c9c" class="cell" data-results="hold" data-execution_count="20">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>plotting_data[<span class="st">'Residuallast BNetzA [MWh]'</span>].equals(plotting_data[<span class="st">'Residuallast [MWh]'</span>])</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>True</code></pre>
</div>
</div>
<p>This allows the redundant column to be removed.</p>
<div id="ba6078d8" class="cell" data-results="hold" data-execution_count="21">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>plotting_data.drop([<span class="st">'Residuallast BNetzA [MWh]'</span>], axis<span class="op">=</span><span class="st">'columns'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="visualizing-the-annual-cycle" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="visualizing-the-annual-cycle"><span class="header-section-number">6.4</span> Visualizing the Annual Cycle</h2>
<p>The network load, renewable energy generation, as well as the residual and remaining load should be visualized over the course of a year. For better clarity, only every 100th value will be plotted.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">Network Load Throughout the Year</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href="">Code for the Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div id="c1c23367" class="cell" data-results="hold" data-execution_count="23">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-24-output-1.png" alt="Combined display in five stacked subplots: 1. network load, 2. cumulative generation from photovoltaics, onshore wind, and offshore wind, 3. cumulative renewable generation, 4. residual load, and 5. remaining load over the year." width="740" height="686" class="figure-img"></p>
<figcaption>Network Load Throughout the Year</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div id="1fd558e1" class="cell" data-results="hold" data-execution_count="24">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find position and content for x-axis labels</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>months <span class="op">=</span> generation[<span class="st">"Datum von"</span>].dt.month.unique().tolist() <span class="co"># gives numbers 1-12</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">## using Pandas</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>months_index <span class="op">=</span> generation[<span class="op">~</span>generation[<span class="st">"Datum von"</span>].dt.month.duplicated()].index</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>month_names <span class="op">=</span> generation[<span class="st">"Datum von"</span>].iloc[months_index].dt.strftime(<span class="st">"%B"</span>) </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co">## alternatively using a list operation</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># months_index = []</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># month_names = []</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co"># for i in months:</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   months_index.append(generation.index[generation["Datum von"].dt.month == i].min())</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   month_names.append(generation["Datum von"].iloc[months_index[i - 1]].strftime("%B"))</span></span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="588ae4f0" class="cell" data-results="hold" data-execution_count="25">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot every 100th value</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>plotting_data[::<span class="dv">100</span>].plot(figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">8</span>), subplots <span class="op">=</span> <span class="va">True</span>, sharey <span class="op">=</span> <span class="va">True</span>, xlim <span class="op">=</span> (plotting_data.index.<span class="bu">min</span>() <span class="op">-</span> (<span class="bu">len</span>(plotting_data.index) <span class="op">/</span> <span class="dv">100</span>), plotting_data.index.<span class="bu">max</span>() <span class="op">*</span> <span class="fl">1.01</span>), rot <span class="op">=</span> <span class="dv">45</span>, grid <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>plt.ylim(top <span class="op">=</span> <span class="dv">20000</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>plt.minorticks_off()</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>plt.xticks(months_index, month_names)<span class="op">;</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
<p>It can be observed that the grid load consistently remains above 9,000 MWh. Furthermore, the grid load fluctuates strongly on a monthly basis, reaching values of up to 19,000 MWh. Each month sees performance near the absolute minimum and maximum. In summer, the grid load is generally somewhat lower than in winter.</p>
<p>The electricity generation from renewable energy, shown in the second subplot (volatile RE [MWh]), is highly volatile. Periods of high production alternate with periods of low production, each lasting only a few days and at most two weeks. This is mainly due to electricity generation from photovoltaics and offshore/onshore wind, whose combined nationwide output in Germany often drops close to zero before reaching a (local) production maximum. In the third subplot (Renewables [MWh]), it can be seen that the additional feed-in from less volatile renewable sources such as biomass and hydropower is comparatively low. Therefore, while the total electricity generation summed across all renewable sources is never zero, it often reaches a low overall output. Nevertheless, there are also short periods of full renewable supply or surplus production, as can be seen from the annual curve of non-renewable residual load.</p>
<p>Regarding the question of the origin of the electricity stored in pumped-storage plants, the graphical representation already indicates that it was predominantly generated by non-renewable sources, as the residual load is rarely zero or negative.</p>
<p>The annual curve of the residual load mirrors the generation pattern of volatile renewable energy. This poses a challenge for conventional power plants. This aspect will be explored in more detail in the next section.</p>
<p>But first, a small task:<br>
<strong>How would a doubling of renewable generation affect the residual load? Display the effect graphically in a comparable manner (e.g., by adding an extra column ‘Grid Load - 2x RE’).</strong></p>
<div id="tip-doubling-RE" class="callout callout-style-default callout-tip callout-titled" title="Sample Solution Doubling RE">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tipp&nbsp;6.1: Sample Solution Doubling RE
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false" href="">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false" href="">Possible Interpretation</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div id="7552c5c9" class="cell" data-execution_count="26">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-27-output-1.png" alt="Visualization of the grid load and the grid load minus the doubled cumulative renewable energy generation over the year. The grid load minus the doubled renewable generation approaches a symmetric distribution around zero. This means periods of renewable over- and underproduction roughly balance each other out." width="751" height="538" class="figure-img"></p>
<figcaption>Example solution doubling Renewable Energy (RE)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div id="28aee340" class="cell" data-execution_count="27">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>plotting_data_2xRE <span class="op">=</span> plotting_data.copy()</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>plotting_data_2xRE[<span class="st">"2x EE"</span>] <span class="op">=</span> plotting_data_2xRE[<span class="st">"Erneuerbare [MWh]"</span>] <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>plotting_data_2xRE[<span class="st">"Netzlast - 2x EE"</span>] <span class="op">=</span> plotting_data_2xRE[<span class="st">"Netzlast [MWh]"</span>] <span class="op">-</span> plotting_data_2xRE[<span class="st">"2x EE"</span>]</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>plotting_data_2xRE <span class="op">=</span> plotting_data_2xRE[[<span class="st">"Netzlast [MWh]"</span>, <span class="st">"Netzlast - 2x EE"</span>]]</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot every 100th value</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>plotting_data_2xRE[::<span class="dv">100</span>].plot(figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">6</span>), subplots<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>                               xlim<span class="op">=</span>(plotting_data_2xRE.index.<span class="bu">min</span>() <span class="op">-</span> (<span class="bu">len</span>(plotting_data_2xRE.index)) <span class="op">/</span> <span class="dv">100</span>,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>                                     plotting_data_2xRE.index.<span class="bu">max</span>() <span class="op">*</span> <span class="fl">1.01</span>),</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>                               rot<span class="op">=</span><span class="dv">45</span>, grid<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>plt.minorticks_off()</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>plt.xticks(months_index, month_names)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<p>The grid load minus the doubled renewable power generation approaches a symmetric distribution around the zero line. This means that periods of renewable overproduction and underproduction roughly balance each other out.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="background-base-medium-and-peak-load" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="background-base-medium-and-peak-load"><span class="header-section-number">6.5</span> Background: Base, Medium, and Peak Load</h2>
<p>Not all power plants are equally suitable for load-following operation due to technical or economic reasons. For example, coal-fired power plants are less flexibly controllable than gas-fired plants. Nuclear power plants are preferred for base load operation due to their high fixed and low variable costs. In the power grid, three operational profiles for power plants are distinguished: base load, medium load, and peak load.</p>
<div id="imp-Base-Medium-Peak-Load" class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition&nbsp;6.3: Base, Medium, and Peak Load
</div>
</div>
<div class="callout-body-container callout-body">
<div class="border">
<ul>
<li><p>Base load: The power continuously demanded throughout the year.<br>
Plant types: Lignite, Nuclear, Run-of-river hydro</p></li>
<li><p>Medium load: Power demanded beyond the base load, planable on a daily and yearly basis.<br>
Plant types: Combined cycle gas plants, Hard coal</p></li>
<li><p>Peak load: Power demanded beyond the medium load, only briefly or unexpectedly during the day or year.<br>
Plant types: Gas turbines, Pumped-storage hydro</p></li>
</ul>
<p>ISPEX AG: <a href="https://www.ispex.de/lexikon/grundlast/">Base load</a>, <a href="https://www.ispex.de/lexikon/mittellast/">Medium load</a>, <a href="https://www.ispex.de/lexikon/spitzenlast/">Peak load</a></p>
<p>Grünwald, Reinhard / Caviezel, Claudio 2017: Load-following capability of German nuclear power plants. Monitoring. Office for Technology Assessment at the German Bundestag (TAB). doi: <a href="https://publikationen.bibliothek.kit.edu/1000102277">10.5445/IR/1000102277</a>. Page 16.</p>
</div>
</div>
</div>
<p>For the question of which power plants supply the marginal power for filling the pumped-storage hydro plants, the distinction between base-load plants on the one hand, and medium- and peak-load plants on the other hand, is particularly relevant. Base-load plants operate at full capacity 24 hours a day. For example, in 2021, nuclear energy reached nearly continuous full-load operation with 8,070 annual full-load hours <a href="https://de.statista.com/statistik/daten/studie/37610/umfrage/jahresvolllaststunden-deutscher-kraftwerke-im-jahr-2009/">statista</a>. Plants running at full load can no longer respond to additional electricity demand. This is left to plants operating in medium and peak load.</p>
<p>Thus, by distinguishing between power plant types operating in base load and those in medium or peak load, one can narrow down which plant types supplied the electricity required to fill the pumped-storage plants.</p>
<p>The utilization of a power plant (or group of plants) can be quantified using its annual full-load hours.</p>
<div id="imp-Annual-Full-Load-Hours" class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition&nbsp;6.4: Annual Full-Load Hours
</div>
</div>
<div class="callout-body-container callout-body">
<p>The annual full-load hours indicate how many of the 8,760 hours in a year a power plant would need to operate at maximum capacity to produce its annual output. <a href="https://de.statista.com/statistik/daten/studie/37610/umfrage/jahresvolllaststunden-deutscher-kraftwerke-im-jahr-2009/">statista</a></p>
<p><span class="math display">\[
Annual~Full\text{-}Load~Hours~(h) = \frac{Total~electricity~generated~in~MWh}{Installed~capacity~in~MW}
\]</span></p>
</div>
</div>
<p>The annual full-load hours can be calculated as follows. Applying the <code>.sum</code> method to the dataset <code>installed_capacity</code> is not necessary since it contains only one row. However, the <code>.sum</code> method allows you to exclude date columns using the parameter <code>numeric_only = True</code>.</p>
<div id="37682761" class="cell" data-execution_count="28">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"{generation.sum(numeric_only=True)}\n")</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># print(installed_capacity.sum(numeric_only=True), "\n")</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># For the division, indices need to be reset</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>full_load_hours_per_year <span class="op">=</span> generation.<span class="bu">sum</span>(numeric_only<span class="op">=</span><span class="va">True</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>).divide(installed_capacity.<span class="bu">sum</span>(numeric_only<span class="op">=</span><span class="va">True</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset index</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>full_load_hours_per_year.index <span class="op">=</span> generation.<span class="bu">sum</span>(numeric_only<span class="op">=</span><span class="va">True</span>).index.<span class="bu">str</span>.replace(pat<span class="op">=</span><span class="st">" [MWh]"</span>, repl<span class="op">=</span><span class="st">" [h]"</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n\n</span><span class="ss">Full load hours per year</span><span class="ch">\n\n</span><span class="sc">{</span>full_load_hours_per_year<span class="sc">.</span>sort_values(ascending<span class="op">=</span><span class="va">False</span>)<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Full load hours per year

Biomasse [h]                   4467.41
Braunkohle [h]                 4399.96
Wind Offshore [h]              2893.34
Wasserkraft [h]                2855.83
Sonstige Erneuerbare [h]       2653.47
Steinkohle [h]                 2192.86
Wind Onshore [h]               2062.55
Kernenergie [h]                1661.92
Erdgas [h]                     1576.42
Sonstige Konventionelle [h]    1293.98
Pumpspeicher [h]               1188.76
Photovoltaik [h]                883.48
dtype: float64</code></pre>
</div>
</div>
<p>The calculation of annual operating hours shows that no type of power plant ran even close to full capacity. The highest utilization is observed for biomass and lignite. Biomass operated at full load for the equivalent of 51 percent of the 8,760 annual hours, while lignite did so for 50 percent. In contrast, the classic base-load generator, nuclear energy, reached only 25 percent. Hard coal, mainly used in Germany for mid-load operation, reached 19 percent. The year 2023 was particularly unusual for nuclear energy.</p>
<p>Therefore, the annual profile of selected conventional generators is presented. To achieve high resolution, a monthly representation is chosen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true" href="">Example Code: Nuclear Energy</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false" href="">Nuclear Energy</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false" href="">Lignite</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false" href="">Hard Coal</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-5" role="tab" aria-controls="tabset-6-5" aria-selected="false" href="">Natural Gas</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div id="decb6348" class="cell" data-execution_count="29">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>plotting_data <span class="op">=</span> generation.copy()</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>producer <span class="op">=</span> <span class="st">"Kernenergie"</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">12</span>))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>fig.suptitle(producer, fontsize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">13</span>):</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    plotting_data_monthly <span class="op">=</span> plotting_data[plotting_data[<span class="st">'Datum von'</span>].dt.month <span class="op">==</span> i]</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">12</span>, <span class="dv">1</span>, i)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    ax.plot(plotting_data_monthly[producer <span class="op">+</span> <span class="st">" [MWh]"</span>])</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    plt.margins(x <span class="op">=</span> <span class="fl">0.01</span>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">"MWh"</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate title</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    plt.title(plotting_data_monthly[<span class="st">'Datum von'</span>].head(<span class="dv">1</span>).dt.strftime(<span class="st">'%B'</span>).item(), fontsize <span class="op">=</span> <span class="dv">10</span>)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate xticks</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    day_index <span class="op">=</span> plotting_data_monthly[<span class="op">~</span>plotting_data_monthly[<span class="st">'Datum von'</span>].dt.day.duplicated()].index</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    day_names <span class="op">=</span> plotting_data_monthly[<span class="st">'Datum von'</span>].dt.day.unique()</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    plt.xticks(day_index, day_names, fontsize <span class="op">=</span> <span class="dv">8</span>)</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div id="a2a86829" class="cell" data-execution_count="30">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-31-output-1.png" alt="Each month is shown in 12 subplots representing nuclear power generation. While production stays within a narrow range from January to March, it drops to zero on April 15." width="758" height="1134" class="figure-img"></p>
<figcaption>Annual Pattern of Nuclear Energy</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div id="bcd5b7ee" class="cell" data-execution_count="31">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-32-output-1.png" alt="The annual profile of electricity generation from lignite is shown month by month in 12 charts. The annual pattern is characterized by strong fluctuations. Phases of full-load production in the range of 4000 MWh per quarter hour are rarely maintained for periods longer than a week. Production peaks are often reached only for a few hours, after which production is sometimes sharply reduced. Low production levels in the range of 1000 MWh per quarter hour are not uncommon." width="758" height="1134" class="figure-img"></p>
<figcaption>Annual Profile Lignite</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div id="7aaf57e8" class="cell" data-execution_count="32">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-33-output-1.png" alt="The annual profile of electricity generation from hard coal is shown month by month in 12 charts. Production peaks rarely reach 3000 MWh per quarter hour and last only a few hours. Intraday ramp-up and ramp-down cycles dominate. Phases of low production in the range of 1000 MWh are also common." width="758" height="1134" class="figure-img"></p>
<figcaption>Annual Profile Hard Coal</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-5-tab">
<div id="f20bd2fb" class="cell" data-execution_count="33">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-34-output-1.png" alt="The annual profile of electricity generation from natural gas is shown month by month in 12 charts. The annual pattern of natural gas resembles that of hard coal, albeit at a significantly lower production level. Although the installed capacity of gas power plants is about three-quarters higher than that of lignite and hard coal plants, peak production on a quarter-hour basis reaches only 4000 MWh. Typical production levels are below 2000 MWh, often well below 1000 MWh." width="758" height="1134" class="figure-img"></p>
<figcaption>Annual Profile Natural Gas</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>In the <strong>Nuclear Energy</strong> tab, it can be seen that in 2023 the last German nuclear power plants Emsland, Isar 2, and Neckarwestheim 2 were taken off the grid. In autumn 2022, due to the energy crisis, an extended stretch operation was decided for these plants beyond the original shutdown date of December 31, 2022. <a href="https://www.bmwk.de/Redaktion/DE/Pressemitteilungen/2023/04/20230413-deutschland-beendet-das-zeitalter-der-atomkraft.html">BMWK</a></p>
<p><strong>Until which day was the stretch operation approved? Determine the shutdown date using the dataset <code>generation</code>. Output the shutdown time from the column <code>'Datum bis'</code> in German date formatting <code>DD. Month YYYY um HH:MM Uhr</code>.</strong></p>
<div id="tip-abschaltung-akw" class="callout callout-style-default callout-tip callout-titled" title="Hint and Sample Solution">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tipp&nbsp;6.3: Hint and Sample Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>When the shutdown occurred, electricity production from nuclear energy reached the value 0. The shutdown was completed in the period preceding the first period in which nuclear power generation had the value 0.</p>
<p>You can format the output of a column as datetime using the method <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.dt.strftime.html">pandas.Series.dt.strftime</a>.</p>
<div id="tip-abschaltung-akw" class="callout callout-style-default callout-tip callout-titled" title="Sample Solution">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tipp&nbsp;6.2: Sample Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In the graphical representation of the annual profile, only every 100th value was plotted, so it is possible that electricity generation reached zero before the final shutdown. Therefore, it is more reliable to search the dataset backwards.</p>
<p>In the forward search, the position of the first occurrence of the value 0 is determined with the <code>.eq()</code> method, and 1 is subtracted. In the backward search, the position of the first value greater than 0 is determined using the <code>.gt()</code> method.</p>
<div id="2b93fbed" class="cell" data-execution_count="34">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Forward search: generation['Kernenergie [MWh]'].eq(0).idxmax() - 1</span><span class="ch">\n</span><span class="sc">{</span>generation[<span class="st">'Kernenergie [MWh]'</span>]<span class="sc">.</span>eq(<span class="dv">0</span>)<span class="sc">.</span>idxmax() <span class="op">-</span> <span class="dv">1</span><span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># backward search</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Backward search: position := generation['Kernenergie [MWh]'].iloc[::-1].gt(0).idxmax()</span><span class="ch">\n</span><span class="sc">{</span> ( position <span class="op">:=</span> generation[<span class="st">'Kernenergie [MWh]'</span>].iloc[::<span class="op">-</span><span class="dv">1</span>].gt(<span class="dv">0</span>).idxmax() ) <span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"generation['Datum bis'].iloc[position].strftime('%d. %B %Y um %H:%M Uhr')</span><span class="ch">\n</span><span class="sc">{</span>generation[<span class="st">'Datum bis'</span>]<span class="sc">.</span>iloc[position]<span class="sc">.</span>strftime(<span class="st">'</span><span class="sc">%d</span><span class="st">. %B %Y um %H:%M Uhr'</span>)<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Forward search: generation['Kernenergie [MWh]'].eq(0).idxmax() - 1
10075

Backward search: position := generation['Kernenergie [MWh]'].iloc[::-1].gt(0).idxmax()
10075

generation['Datum bis'].iloc[position].strftime('%d. %B %Y um %H:%M Uhr')
16. April 2023 um 00:00 Uhr</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>The calculation of annual full-load hours and the visualization of annual profiles show that, due to the high share of volatile renewable electricity generation in the German power system, there is no longer any baseload that can be served by conventional generators. This means that all non-renewable generators operate in load-following mode. This can be illustrated by the example of hard coal, whose achieved annual full-load hours are closer to the classic peak load generation from natural gas than to the mid-load generation from lignite. The utilization of a power generator can be represented using a sorted annual duration curve.</p>
<div id="imp-Jahresdauerlinie" class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition&nbsp;6.5: Sorted Annual Duration Curve
</div>
</div>
<div class="callout-body-container callout-body">
<p>The sorted annual duration curve is a diagram of the data sorted in descending order.</p>
<div class="border">
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/rMxYJuGqR4s" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Energy Technology. 2 Introduction. 2.13 Sorted Annual Duration Curve by Henrik te Heesen is licensed under <a href="https://creativecommons.org/licenses/by-sa/3.0/deed.en">CC BY-SA 3.0</a> and available on <a href="https://www.youtube.com/watch?v=rMxYJuGqR4s">YouTube</a>.</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false" href="">Code for the Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div id="a86614d1" class="cell" data-execution_count="35">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-36-output-1.png" alt="The sorted annual duration curves for lignite, hard coal, and natural gas are shown. Lignite shows an almost linear descending pattern, while natural gas and especially hard coal show sharply descending curves, meaning that high production levels are reached much less frequently than low levels. For example, lignite reaches a maximum production of about 4000 MWh on a single day. Half of this value (or more) is reached on 200 days of the year. In contrast, hard coal reaches its maximum production of about 3750 MWh on a single day, but half of this value (or more) is only reached on about 60 days of the year." width="691" height="376" class="figure-img"></p>
<figcaption>sorted annual duration curve of selected conventional generators</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div id="23d1bdde" class="cell" data-execution_count="36">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group data by day and aggregate by daily mean.</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>lignite_daily <span class="op">=</span> generation[<span class="st">'Braunkohle [MWh]'</span>].groupby(generation[<span class="st">"Datum von"</span>].dt.dayofyear).mean()</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>hardcoal_daily <span class="op">=</span> generation[<span class="st">'Steinkohle [MWh]'</span>].groupby(generation[<span class="st">"Datum von"</span>].dt.dayofyear).mean()</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>naturalgas_daily <span class="op">=</span> generation[<span class="st">'Erdgas [MWh]'</span>].groupby(generation[<span class="st">"Datum von"</span>].dt.dayofyear).mean()</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co">## For verification</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co">## print(generation["Datum von"].dt.dayofyear)</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co">## print(f"\n\nlignite_daily.head()\n{lignite_daily.head()}\n\n"</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co">##       f"For comparison:\ngeneration['Braunkohle [MWh]'].iloc[[0, 1, 95, 96]]\n{generation['Braunkohle [MWh]'].iloc[[0, 1, 95, 96]]}\n\n"</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co">##       f"generation['Braunkohle [MWh]'].iloc[0:96].mean()\n{generation['Braunkohle [MWh]'].iloc[0:96].mean()}") </span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot line chart</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Shift index by 1 because index starts at 0 but represents day count.</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>line_width <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">4</span>))</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>lignite_daily <span class="op">=</span> lignite_daily.sort_values(ascending <span class="op">=</span> <span class="va">False</span>, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>lignite_daily.index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>lignite_daily.plot.line(lw <span class="op">=</span> line_width, color <span class="op">=</span> <span class="st">'brown'</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, label <span class="op">=</span> <span class="st">'Lignite'</span>)</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>hardcoal_daily <span class="op">=</span> hardcoal_daily.sort_values(ascending <span class="op">=</span> <span class="va">False</span>, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>hardcoal_daily.index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>hardcoal_daily.plot.line(lw <span class="op">=</span> line_width, color <span class="op">=</span> <span class="st">'black'</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, label <span class="op">=</span> <span class="st">'Hard Coal'</span>)</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>naturalgas_daily <span class="op">=</span> naturalgas_daily.sort_values(ascending <span class="op">=</span> <span class="va">False</span>, ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>naturalgas_daily.index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>naturalgas_daily.plot.line(lw <span class="op">=</span> line_width, color <span class="op">=</span> <span class="st">'lightskyblue'</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, label <span class="op">=</span> <span class="st">'Natural Gas'</span>)</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>plt.title(label <span class="op">=</span> <span class="st">"sorted load duration curve for selected conventional generators"</span>)</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'average electricity generation in MWh</span><span class="ch">\n</span><span class="st">(on a quarter-hour basis)'</span>)</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'number of days per year'</span>)</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>plt.margins(x <span class="op">=</span> <span class="fl">0.02</span>)</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
<p>When comparing the achieved annual full-load hours, it was observed that the utilization of hard coal more closely resembles that of the peak load generator natural gas rather than the mid-load generator lignite. Furthermore, the graphical representation of the sorted annual duration curves shows that the generation profile of hard coal even resembles that of lignite less than that of natural gas.</p>
<p>So far, only the generation from conventional power plants has been considered. Biomass and lignite reach comparable annual full-load hours, making a comparison of the two generators interesting.<br>
<strong>Display the annual profile and the annual duration curves for biomass and lignite.</strong></p>
<div id="tip-generation-profiles-biomass-lignite" class="callout callout-style-default callout-tip callout-titled" title="Sample Solution: Generation Profiles of Biomass and Lignite">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tipp&nbsp;6.4: Sample Solution: Generation Profiles of Biomass and Lignite
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="border">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true" href="">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false" href="">Text-Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false" href="">Annual Biomass Profile</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-4" role="tab" aria-controls="tabset-8-4" aria-selected="false" href="">Annual Profile of Lignite</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-5" role="tab" aria-controls="tabset-8-5" aria-selected="false" href="">Sorted Annual Duration Curves</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div id="e6ca15c3" class="cell" data-execution_count="37">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the number of decimal places for display</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">"display.precision"</span>, <span class="dv">2</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load datasets</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co"># !</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co"># For your own use, adjust the file path to the correct location of the downloaded .csv file.</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co"># !</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>generation0_ms <span class="op">=</span> pd.read_csv(</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"01-daten/Realisierte_Erzeugung_202301010000_202401010000_Viertelstunde.csv"</span>,</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    sep<span class="op">=</span><span class="st">";"</span>, thousands<span class="op">=</span><span class="st">"."</span>, decimal<span class="op">=</span><span class="st">","</span>, parse_dates<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>], date_format<span class="op">=</span><span class="st">"</span><span class="sc">%d</span><span class="st">.%m.%Y %H:%M"</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove string " Originalauflösungen" from column names</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>generation0_ms.columns <span class="op">=</span> generation0_ms.columns.<span class="bu">str</span>.replace(pat<span class="op">=</span><span class="st">" Originalauflösungen"</span>, repl<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generation0_ms.head(<span class="dv">10</span>))</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Group data of selected generation types by day and aggregate by daily mean</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>lignite_daily_qtr <span class="op">=</span> generation0_ms[<span class="st">'Braunkohle [MWh]'</span>].groupby(generation0_ms[<span class="st">"Datum von"</span>].dt.dayofyear).mean()</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>biomass_daily_qtr <span class="op">=</span> generation0_ms[<span class="st">'Biomasse [MWh]'</span>].groupby(generation0_ms[<span class="st">"Datum von"</span>].dt.dayofyear).mean()</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot line chart</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>line_width <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">4</span>))</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>lignite_daily_qtr <span class="op">=</span> lignite_daily_qtr.sort_values(ascending<span class="op">=</span><span class="va">False</span>, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>lignite_daily_qtr.index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>lignite_daily_qtr.plot.line(lw<span class="op">=</span>line_width, color<span class="op">=</span><span class="st">'brown'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="st">'Lignite'</span>)</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>biomass_daily_qtr <span class="op">=</span> biomass_daily_qtr.sort_values(ascending<span class="op">=</span><span class="va">False</span>, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>biomass_daily_qtr.index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>biomass_daily_qtr.plot.line(lw<span class="op">=</span>line_width, color<span class="op">=</span><span class="st">'greenyellow'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="st">'Biomass'</span>)</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>plt.title(label<span class="op">=</span><span class="st">"Sorted annual duration curve for selected generators"</span>)</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Average electricity generation in MWh</span><span class="ch">\n</span><span class="st">(quarter-hourly basis)'</span>)</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Number of days per year'</span>)</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>plt.margins(x<span class="op">=</span><span class="fl">0.02</span>)</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Load profile: Select the generator type here for which load profile should be plotted. Comment out the other.</span></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>generator <span class="op">=</span> <span class="st">"Biomasse"</span></span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a><span class="co">#generator = "Braunkohle"</span></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">12</span>))</span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>fig.suptitle(generator, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">13</span>):</span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>    monthly_data <span class="op">=</span> generation0_ms[generation0_ms[<span class="st">'Datum von'</span>].dt.month <span class="op">==</span> i]</span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">12</span>, <span class="dv">1</span>, i)</span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>    ax.plot(monthly_data[generator <span class="op">+</span> <span class="st">" [MWh]"</span>])</span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>    plt.margins(x<span class="op">=</span><span class="fl">0.01</span>)</span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(ylabel<span class="op">=</span><span class="st">"MWh"</span>)</span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create title</span></span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>    plt.title(label<span class="op">=</span>monthly_data[<span class="st">'Datum von'</span>].head(<span class="dv">1</span>).dt.strftime(<span class="st">'%B'</span>).item(), fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate xticks</span></span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>    day_index <span class="op">=</span> monthly_data[<span class="op">~</span>monthly_data[<span class="st">"Datum von"</span>].dt.day.duplicated()].index</span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>    day_numbers <span class="op">=</span> monthly_data[<span class="st">"Datum von"</span>].dt.day.unique()</span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a>    plt.xticks(day_index, day_numbers, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div id="ccb450b6" class="cell" data-execution_count="38">
<div class="cell-output cell-output-stdout">
<pre><code>            Datum von           Datum bis  Biomasse [MWh]  Wasserkraft [MWh]  \
0 2023-01-01 00:00:00 2023-01-01 00:15:00         1094.25             320.00   
1 2023-01-01 00:15:00 2023-01-01 00:30:00         1091.25             317.50   
2 2023-01-01 00:30:00 2023-01-01 00:45:00         1090.25             317.25   
3 2023-01-01 00:45:00 2023-01-01 01:00:00         1089.25             321.50   
4 2023-01-01 01:00:00 2023-01-01 01:15:00         1085.25             315.25   
5 2023-01-01 01:15:00 2023-01-01 01:30:00         1087.75             304.75   
6 2023-01-01 01:30:00 2023-01-01 01:45:00         1086.50             303.50   
7 2023-01-01 01:45:00 2023-01-01 02:00:00         1085.25             304.25   
8 2023-01-01 02:00:00 2023-01-01 02:15:00         1080.25             308.25   
9 2023-01-01 02:15:00 2023-01-01 02:30:00         1084.25             305.50   

   Wind Offshore [MWh]  Wind Onshore [MWh]  Photovoltaik [MWh]  \
0               684.25             7145.75                0.50   
1               743.50             7158.25                0.25   
2               817.00             7302.25                0.25   
3               814.50             7104.25                0.25   
4               785.50             7322.00                0.25   
5               898.50             7332.75                0.25   
6               943.75             7259.75                0.25   
7               958.25             7390.50                0.25   
8              1009.75             7229.00                0.50   
9               967.00             7421.75                0.25   

   Sonstige Erneuerbare [MWh]  Kernenergie [MWh]  Braunkohle [MWh]  \
0                       32.25             615.25            962.75   
1                       32.25             614.75            963.25   
2                       32.50             615.00            966.50   
3                       32.50             614.50            966.75   
4                       32.25             614.50            969.00   
5                       32.25             614.75            965.75   
6                       32.25             614.75            967.50   
7                       32.25             614.75            964.25   
8                       32.25             615.00            963.00   
9                       32.25             614.75            967.00   

   Steinkohle [MWh]  Erdgas [MWh]  Pumpspeicher [MWh]  \
0            517.00        429.75               13.50   
1            518.00        429.50                9.75   
2            517.00        432.00                9.75   
3            515.50        430.50                9.75   
4            513.25        391.25               26.50   
5            514.00        389.50               45.00   
6            513.75        393.75               50.50   
7            511.00        393.50               50.50   
8            509.75        391.50               41.25   
9            509.00        394.50               40.75   

   Sonstige Konventionelle [MWh]  
0                         307.25  
1                         307.25  
2                         308.25  
3                         306.00  
4                         306.75  
5                         305.00  
6                         302.00  
7                         304.50  
8                         303.00  
9                         303.75  </code></pre>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div id="b194ab5d" class="cell" data-execution_count="39">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-40-output-1.png" alt="For each month, 12 subplots show electricity generation from biomass. Generation remains above 900 MWh per 15 minutes throughout the year. Above this level, frequent fluctuations in generation are observed. On one hand, generation seems to follow the daily load profile. On the other hand, in the bright generation, production appears reduced during midday hours." width="758" height="1134" class="figure-img"></p>
<figcaption>Annual Biomass Profile</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-4-tab">
<div id="a0c696d2" class="cell" data-execution_count="40">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-41-output-1.png" alt="For each month, 12 subplots show electricity generation from lignite. The chart corresponds to the previously shown annual profile of lignite in this section." width="758" height="1134" class="figure-img"></p>
<figcaption>Annual Profile of Biomass</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-5-tab">
<div id="8974f578" class="cell" data-execution_count="41">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-42-output-1.png" alt="Displayed are the sorted annual duration curves for lignite and biomass. The sorted annual duration curve for lignite corresponds to the one shown earlier in this section (almost linearly decreasing). In contrast, the sorted annual duration curve for biomass runs almost parallel to the x-axis, indicating consistently high generation." width="758" height="374" class="figure-img"></p>
<figcaption>Sorted annual duration curves for selected generators</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Solution template by Marc Sönnecken. The code and the outputs generated by sections of the code have been separated into tabs. For compatibility with this script, the file path and object names have been adjusted. Colors used have been adapted for accessibility.</p>
</div>
</div>
</div>
</div>
</section>
<section id="sec-PumpedStorageContent" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="sec-PumpedStorageContent"><span class="header-section-number">6.6</span> Determining the Electricity Stored in Pumped Storage Plants</h2>
<p>Previous analyses have shown that two fundamental scenarios in the power grid must be distinguished:</p>
<ol type="1">
<li><p>Residual load zero or negative: Marginal electricity is produced by renewable energy sources.</p></li>
<li><p>Residual load positive: Marginal electricity is produced by conventional energy sources operating in load-following mode.</p></li>
</ol>
<p>The annual course of electricity consumption through pumped storage plants and the corresponding scenario is shown in the following graph, which displays every 100th value of the data series <code>verbrauch['Pumpspeicher [MWh]']</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false" href="">Code for the Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div id="3b0b17ab" class="cell" data-execution_count="42">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-43-output-1.png" alt="This plot shows the annual pattern of pumped-storage electricity feed-in. The colors differentiate between the predominantly conventional feed-in phases from power plants operating in load-following mode and the rare phases of renewable feed-in. Renewable feed-in occurred almost exclusively during the Christmas holidays." width="753" height="591" class="figure-img"></p>
<figcaption>Pumped-Storage Feed-in 2023</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div id="0ebfc19c" class="cell" data-execution_count="43">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate residual load</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>renewables <span class="op">=</span> [<span class="st">'Biomasse [MWh]'</span>, <span class="st">'Wasserkraft [MWh]'</span>, <span class="st">'Wind Offshore [MWh]'</span>, <span class="st">'Wind Onshore [MWh]'</span>, <span class="st">'Photovoltaik [MWh]'</span>, <span class="st">'Sonstige Erneuerbare [MWh]'</span>]</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>residual_load <span class="op">=</span> pd.DataFrame()</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>residual_load[<span class="st">"Netzlast [MWh]"</span>] <span class="op">=</span> consumption[<span class="st">"Gesamt (Netzlast) [MWh]"</span>].copy() </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>residual_load[<span class="st">"Erneuerbare [MWh]"</span>] <span class="op">=</span> generation[renewables].<span class="bu">sum</span>(axis<span class="op">=</span><span class="st">"columns"</span>).copy()</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>residual_load[<span class="st">"Restlast [MWh]"</span>] <span class="op">=</span> residual_load[<span class="st">"Netzlast [MWh]"</span>] <span class="op">-</span> residual_load[<span class="st">"Erneuerbare [MWh]"</span>]</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>residual_load <span class="op">=</span> residual_load[<span class="st">"Restlast [MWh]"</span>]</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate xticks</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>months_index <span class="op">=</span> generation[<span class="op">~</span>generation[<span class="st">"Datum von"</span>].dt.month.duplicated()].index</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>month_names <span class="op">=</span> generation[<span class="st">"Datum von"</span>].iloc[months_index].dt.strftime(<span class="st">"%B"</span>) </span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot every n-th value</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>step <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>consumption[<span class="st">'Pumpspeicher [MWh]'</span>][::step].plot(</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">6</span>),</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    xlim<span class="op">=</span>(consumption.index.<span class="bu">min</span>() <span class="op">-</span> (<span class="bu">len</span>(consumption.index) <span class="op">/</span> <span class="dv">100</span>), consumption.index.<span class="bu">max</span>() <span class="op">*</span> <span class="fl">1.01</span>),</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>    rot<span class="op">=</span><span class="dv">45</span>,</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    grid<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">""</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Storage [MWh]'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Pumped Storage in 2023'</span>)</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Set xticks</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>plt.minorticks_off()</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>plt.xticks(months_index, month_names)</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill under the curve: plt.fill_between has a convenient "where" parameter</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>plt.fill_between(</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>consumption[<span class="st">'Pumpspeicher [MWh]'</span>].index[::step],</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>    y1<span class="op">=</span>consumption[<span class="st">'Pumpspeicher [MWh]'</span>][::step],</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">'conventional storage'</span></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>)  <span class="co"># , where=residual_load[::step] &gt; 0 would leave white spaces</span></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>plt.fill_between(</span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>consumption[<span class="st">'Pumpspeicher [MWh]'</span>].index[::step],</span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>    y1<span class="op">=</span>consumption[<span class="st">'Pumpspeicher [MWh]'</span>][::step],</span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>    where<span class="op">=</span>residual_load[::step] <span class="op">&lt;=</span> <span class="dv">0</span>,</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">'greenyellow'</span>,</span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">'renewable storage'</span></span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
<p>The graphic reflects the insight gained in determining the residual and remaining load, namely that with the electricity mix realized in 2023, additional electricity demand is primarily met by conventional sources.<br>
<strong>What would the graphic look like if the feed-in from renewable energies were twice as high?</strong></p>
<div id="tip-pumpspeicher" class="callout callout-style-default callout-tip callout-titled" title="Sample solution: Storage with double renewable generation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tipp&nbsp;6.5: Sample solution: Storage with double renewable generation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For the calculation, it is sufficient to multiply the total electricity generation from renewable energies by 2.</p>
<pre><code>residual_load = pd.DataFrame()
residual_load["Netzlast [MWh]"] = consumption["Gesamt (Netzlast) [MWh]"].copy()
residual_load["Erneuerbare [MWh]"] = generation[renewables].sum(axis="columns").copy()
residual_load["Restlast [MWh]"] = residual_load["Netzlast [MWh]"] - 2 * residual_load["Erneuerbare [MWh]"]
residual_load = residual_load["Restlast [MWh]"]</code></pre>
<div id="f9c34855" class="cell" data-execution_count="44">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-45-output-1.png" alt="The annual pattern of energy storage in pumped-storage hydroelectric plants is shown with a doubling of renewable electricity production. Colors distinguish conventional storage phases by power plants operating in load-following mode and much more frequent phases of renewable storage." width="753" height="591" class="figure-img"></p>
<figcaption>Energy Storage in Pumped-Storage Hydropower Plants 2023</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="task-exploratory-data-analysis" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="task-exploratory-data-analysis"><span class="header-section-number">6.7</span> Task: Exploratory Data Analysis</h2>
<div class="border">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="00-bilder/960px-StauseeMooserboden_von_Tigerente_CC_BY-SA_3.0.jpg" class="img-fluid figure-img" style="width:80.0%" alt="Image of Kappruner Valley with the Mooserboden Reservoir"></p>
<figcaption>&nbsp;</figcaption>
</figure>
</div>
<p>Upper and main stages of the power plant group: Mooser- and Wasserfallboden with Karlingerkees at the top left, in the background on the right the Großvenediger. Image by Tigerente is licensed under <a href="https://creativecommons.org/licenses/by-sa/3.0/de/deed.de">CC BY-SA 3.0</a> and available on <a href="https://commons.wikimedia.org/w/index.php?curid=4595972">wikimedia.org</a>. 2008</p>
</div>
<p>&nbsp;</p>
<p><strong>Visualize the annual pattern of pumped storage in Austria for 2023.</strong> Notes on downloading the data can be found in section <a href="#sec-task-descriptive-data-analysis" class="quarto-xref"><span>Kapitel 5.2</span></a>.</p>
<div id="wrn-DateColumn-Austria" class="callout callout-style-simple callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hinweis&nbsp;6.1: Time Change in the Austrian Dataset
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>In the Austrian dataset, due to the switch from summer to winter time on the last Sunday in October, the 2 AM hour is recorded twice (and one hour is missing during the switch from winter to summer time on the last Sunday in March). The duplicated hour is marked in the dataset as 2A and 2B. (Notification from Austrian Power Grid AG, 13.08.2024)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="00-bilder/erzeugung-aut-zeitumstellung.png" class="img-fluid figure-img" alt="A snippet from the Austrian generation dataset is shown. In the columns 'Zeit von [CET/CEST]' and 'Zeit bis [CET/CEST]', the period from 29.10.2023 02:00:00 to 29.10.2023 03:00:00 is highlighted in yellow to illustrate the anomaly described above."></p>
<figcaption>Time change in the Austrian dataset</figcaption>
</figure>
</div>
<p>To read the date columns correctly, the entries need to be cleaned. One option is to replace the strings “2A” and “2B” with “02” using the <code>str.replace()</code> method (which will create a duplicate in the dataset).</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Example Solution: Correct Reading Using str.replace()">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tipp</span>Example Solution: Correct Reading Using str.replace()
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="d92dbad4" class="cell" data-execution_count="45">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>austria_generation <span class="op">=</span> pd.read_csv(</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    filepath_or_buffer<span class="op">=</span><span class="st">"01-daten/AGPT_2022-12-31T23_00_00Z_2023-12-31T23_00_00Z_15M_de_2024-06-10T09_32_38Z.csv"</span>,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    sep<span class="op">=</span><span class="st">";"</span>, </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    decimal<span class="op">=</span><span class="st">","</span>, </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    thousands<span class="op">=</span><span class="st">"."</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># String replace &amp; convert to datetime</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co">## Column 'Zeit von [CET/CEST]'</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>austria_generation[<span class="st">'Zeit von [CET/CEST]'</span>] <span class="op">=</span> austria_generation[<span class="st">'Zeit von [CET/CEST]'</span>].<span class="bu">str</span>.replace(pat<span class="op">=</span><span class="st">'2A'</span>, repl<span class="op">=</span><span class="st">'02'</span>)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>austria_generation[<span class="st">'Zeit von [CET/CEST]'</span>] <span class="op">=</span> austria_generation[<span class="st">'Zeit von [CET/CEST]'</span>].<span class="bu">str</span>.replace(pat<span class="op">=</span><span class="st">'2B'</span>, repl<span class="op">=</span><span class="st">'02'</span>)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>austria_generation[<span class="st">'Zeit von [CET/CEST]'</span>] <span class="op">=</span> pd.to_datetime(austria_generation[<span class="st">'Zeit von [CET/CEST]'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">"</span><span class="sc">%d</span><span class="st">.%m.%Y %H:%M:%S"</span>)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="co">## Column 'Zeit bis [CET/CEST]'</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>austria_generation[<span class="st">'Zeit bis [CET/CEST]'</span>] <span class="op">=</span> austria_generation[<span class="st">'Zeit bis [CET/CEST]'</span>].<span class="bu">str</span>.replace(pat<span class="op">=</span><span class="st">'2A'</span>, repl<span class="op">=</span><span class="st">'02'</span>)</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>austria_generation[<span class="st">'Zeit bis [CET/CEST]'</span>] <span class="op">=</span> austria_generation[<span class="st">'Zeit bis [CET/CEST]'</span>].<span class="bu">str</span>.replace(pat<span class="op">=</span><span class="st">'2B'</span>, repl<span class="op">=</span><span class="st">'02'</span>)</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>austria_generation[<span class="st">'Zeit bis [CET/CEST]'</span>] <span class="op">=</span> pd.to_datetime(austria_generation[<span class="st">'Zeit bis [CET/CEST]'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">"</span><span class="sc">%d</span><span class="st">.%m.%Y %H:%M:%S"</span>)</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(austria_generation.dtypes)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Zeit von [CET/CEST]             datetime64[ns]
Zeit bis [CET/CEST]             datetime64[ns]
Wind [MW]                              float64
Solar [MW]                             float64
Biomasse [MW]                          float64
Gas [MW]                               float64
Kohle [MW]                             float64
Öl [MW]                                float64
Geothermie [MW]                        float64
Pumpspeicher [MW]                      float64
Lauf- und Schwellwasser [MW]           float64
Speicher [MW]                          float64
Sonstige Erneuerbare [MW]              float64
Müll [MW]                              float64
Andere [MW]                            float64
dtype: object</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Musterlösung Aufgabe explorative Datenanalyse">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tipp</span>Musterlösung Aufgabe explorative Datenanalyse
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="border">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true" href="">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false" href="">Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div id="3530dd10" class="cell" data-execution_count="46">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the number of decimal places</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">"display.precision"</span>, <span class="dv">2</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load dataset into variable generation0_austria_ms</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co"># !</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="co"># For your own use, adjust the file path to the correct location of the downloaded .csv file.</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="co"># !</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>generation0_austria_ms <span class="op">=</span> pd.read_csv(</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"01-daten/AGPT_2022-12-31T23_00_00Z_2023-12-31T23_00_00Z_15M_de_2024-06-10T09_32_38Z.csv"</span>, </span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    sep<span class="op">=</span><span class="st">";"</span>, thousands<span class="op">=</span><span class="st">"."</span>, decimal<span class="op">=</span><span class="st">","</span>, parse_dates<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>], date_format<span class="op">=</span><span class="st">"</span><span class="sc">%d</span><span class="st">.%m.%Y %H:%M"</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="co"># String replace &amp; convert to datetime</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="co">## Column "Zeit von [CET/CEST]"</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>generation0_austria_ms[<span class="st">'Zeit von [CET/CEST]'</span>] <span class="op">=</span> generation0_austria_ms[<span class="st">'Zeit von [CET/CEST]'</span>].<span class="bu">str</span>.replace(pat<span class="op">=</span><span class="st">'2A'</span>, repl<span class="op">=</span><span class="st">'02'</span>)</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>generation0_austria_ms[<span class="st">'Zeit von [CET/CEST]'</span>] <span class="op">=</span> generation0_austria_ms[<span class="st">'Zeit von [CET/CEST]'</span>].<span class="bu">str</span>.replace(pat<span class="op">=</span><span class="st">'2B'</span>, repl<span class="op">=</span><span class="st">'02'</span>)</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>generation0_austria_ms[<span class="st">'Zeit von [CET/CEST]'</span>] <span class="op">=</span> pd.to_datetime(</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>    generation0_austria_ms[<span class="st">'Zeit von [CET/CEST]'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">"</span><span class="sc">%d</span><span class="st">.%m.%Y %H:%M:%S"</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="co">## Column "Time to [CET/CEST]"</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>generation0_austria_ms[<span class="st">'Zeit bis [CET/CEST]'</span>] <span class="op">=</span> generation0_austria_ms[<span class="st">'Zeit bis [CET/CEST]'</span>].<span class="bu">str</span>.replace(pat<span class="op">=</span><span class="st">'2A'</span>, repl<span class="op">=</span><span class="st">'02'</span>)</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>generation0_austria_ms[<span class="st">'Zeit bis [CET/CEST]'</span>] <span class="op">=</span> generation0_austria_ms[<span class="st">'Zeit bis [CET/CEST]'</span>].<span class="bu">str</span>.replace(pat<span class="op">=</span><span class="st">'2B'</span>, repl<span class="op">=</span><span class="st">'02'</span>)</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>generation0_austria_ms[<span class="st">'Zeit bis [CET/CEST]'</span>] <span class="op">=</span> pd.to_datetime(</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>    generation0_austria_ms[<span class="st">'Zeit bis [CET/CEST]'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">"</span><span class="sc">%d</span><span class="st">.%m.%Y %H:%M:%S"</span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generation0_austria_ms.dtypes)</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generation0_austria_ms.head(<span class="dv">10</span>))</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a copy of the dataset</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>generation_c_austria_ms <span class="op">=</span> generation0_austria_ms.copy()</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>plotting_data_ms <span class="op">=</span> generation_c_austria_ms.copy()</span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>generator_type <span class="op">=</span> <span class="st">"Pumpspeicher"</span></span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="fl">7.5</span>, <span class="dv">12</span>))</span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>fig.suptitle(generator_type, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">13</span>):</span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a>    plotting_data_monthly_ms <span class="op">=</span> plotting_data_ms[plotting_data_ms[<span class="st">"Zeit von [CET/CEST]"</span>].dt.month <span class="op">==</span> i]</span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">12</span>, <span class="dv">1</span>, i)</span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>    ax.plot(plotting_data_monthly_ms[generator_type <span class="op">+</span> <span class="st">" [MW]"</span>])</span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>    plt.margins(x<span class="op">=</span><span class="fl">0.01</span>)</span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">"MW"</span>)</span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create title</span></span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>    plt.title(</span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a>        plotting_data_monthly_ms[<span class="st">"Zeit von [CET/CEST]"</span>].head(<span class="dv">1</span>).dt.strftime(<span class="st">'%B'</span>).item(), </span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a>        fontsize<span class="op">=</span><span class="dv">10</span></span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create xticks</span></span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a>    day_index <span class="op">=</span> plotting_data_monthly_ms[<span class="op">~</span>plotting_data_monthly_ms[<span class="st">"Zeit von [CET/CEST]"</span>].dt.day.duplicated()].index</span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a>    day_labels <span class="op">=</span> plotting_data_monthly_ms[<span class="st">"Zeit von [CET/CEST]"</span>].dt.day.unique()</span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a>    plt.xticks(day_index, day_labels, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div id="2e046d1d" class="cell" data-execution_count="47">
<div class="cell-output cell-output-stdout">
<pre><code>Zeit von [CET/CEST]             datetime64[ns]
Zeit bis [CET/CEST]             datetime64[ns]
Wind [MW]                              float64
Solar [MW]                             float64
Biomasse [MW]                          float64
Gas [MW]                               float64
Kohle [MW]                             float64
Öl [MW]                                float64
Geothermie [MW]                        float64
Pumpspeicher [MW]                      float64
Lauf- und Schwellwasser [MW]           float64
Speicher [MW]                          float64
Sonstige Erneuerbare [MW]              float64
Müll [MW]                              float64
Andere [MW]                            float64
dtype: object
  Zeit von [CET/CEST] Zeit bis [CET/CEST]  Wind [MW]  Solar [MW]  \
0 2023-01-01 00:00:00 2023-01-01 00:15:00     1000.0         0.0   
1 2023-01-01 00:15:00 2023-01-01 00:30:00      964.0         0.0   
2 2023-01-01 00:30:00 2023-01-01 00:45:00      956.0         0.0   
3 2023-01-01 00:45:00 2023-01-01 01:00:00      992.0         0.0   
4 2023-01-01 01:00:00 2023-01-01 01:15:00      880.0         0.0   
5 2023-01-01 01:15:00 2023-01-01 01:30:00      888.0         0.0   
6 2023-01-01 01:30:00 2023-01-01 01:45:00      948.0         0.0   
7 2023-01-01 01:45:00 2023-01-01 02:00:00      968.0         0.0   
8 2023-01-01 02:00:00 2023-01-01 02:15:00      956.0         0.0   
9 2023-01-01 02:15:00 2023-01-01 02:30:00      952.0         0.0   

   Biomasse [MW]  Gas [MW]  Kohle [MW]  Öl [MW]  Geothermie [MW]  \
0          240.0      27.6         0.0      0.0             0.07   
1          240.0      27.6         0.0      0.0             0.07   
2          240.0      28.0         0.0      0.0             0.07   
3          240.0      27.6         0.0      0.0             0.07   
4          240.0      27.6         0.0      0.0             0.07   
5          240.0      28.4         0.0      0.0             0.07   
6          240.0      28.8         0.0      0.0             0.07   
7          240.0      28.0         0.0      0.0             0.07   
8          240.0      28.8         0.0      0.0             0.07   
9          240.0      28.4         0.0      0.0             0.07   

   Pumpspeicher [MW]  Lauf- und Schwellwasser [MW]  Speicher [MW]  \
0            -1404.8                        2291.6           70.4   
1            -1532.8                        2283.2           66.8   
2            -1544.4                        2240.0          100.4   
3            -1579.6                        2199.6           77.6   
4            -1590.8                        2234.8           63.2   
5            -1602.8                        2229.2           73.6   
6            -1572.0                        2211.2           69.2   
7            -1579.2                        2194.8           70.8   
8            -1649.6                        2202.8           75.2   
9            -1702.0                        2172.4           65.6   

   Sonstige Erneuerbare [MW]  Müll [MW]  Andere [MW]  
0                        0.0      100.0         22.0  
1                        0.0      100.0         22.0  
2                        0.0      100.0         22.0  
3                        0.0      100.0         22.0  
4                        0.0      100.0         22.0  
5                        0.0      100.0         22.0  
6                        0.0      100.0         22.0  
7                        0.0      100.0         22.0  
8                        0.0      100.0         22.0  
9                        0.0      100.0         22.0  </code></pre>
</div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-48-output-2.png" alt="In 12 subplots, the monthly annual profile of pumped storage in Austria in 2023 is shown. The x-axis shows the days of each month, the y-axis the power input/output. The power curve is very volatile. On many days, pumped storage delivers power close to the maximum of around 2500 MW, but only for a few hours. Negative power levels around 1000 MW are regularly reached, meaning the pumped storage pumps water back into the reservoirs. Power levels of zero or negative values tend to occur at night during winter months, and around noon during summer." width="710" height="1134" class="figure-img"></p>
<figcaption>Annual profile of pumped storage in Austria 2023</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Sample solution by Marc Sönnecken. For compatibility with this script, the file paths and object names have been adjusted, and the graphic width reduced.</p>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="inferential-data-analysis" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Inferential Data Analysis</h1>
<p>Inferential data analysis means drawing conclusions based on data. It differs from descriptive and exploratory data analysis in that data are not only observed and compared, but also used to generate new insights.</p>
<p>In the exploratory analysis of the generation data, it was observed that in 2023, full supply from renewable energies is already reached at certain points. From considering the doubled renewable electricity generation in 2023 (see <a href="#tip-doubling-RE" class="quarto-xref">Tipp&nbsp;<span>6.1</span></a>), it can be inferred that with the increasing expansion of renewable electricity production, periods of renewable overproduction will occur more frequently. The prospect of regular renewable production surpluses creates a need for electricity storage to make electricity from periods of overproduction usable during periods with positive residual load.</p>
<p>This section examines the resulting storage requirements.</p>
<div class="callout callout-style-simple callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warnung</span>Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The following calculations are performed using the so-called “copper plate model” based on the aggregate data on electricity generation and consumption published by the Federal Network Agency. In reality, the available capacities for electricity transmission play an important role in designing a power system. Here, they are only considered to the extent that the data reflect the actual realized electricity generation in the German electricity system. Curtailment of renewable electricity generation is also neglected. In the first quarter of 2023, this amounted to 5.29 percent of renewable generation (<a href="https://dserver.bundestag.de/btd/20/090/2009016.pdf">German Bundestag Drucksache 20/9016, p.&nbsp;2</a>).</p>
<p>Electricity trade with foreign countries is also ignored (see difference between grid load and electricity generation).</p>
</div>
</div>
<section id="background-renewable-energy-expansion-path" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="background-renewable-energy-expansion-path"><span class="header-section-number">7.1</span> Background: Renewable Energy Expansion Path</h2>
<p>In Germany, the expansion of renewable energies began in the 1990s. Since the early 2000s, renewable electricity generation has increased largely continuously.</p>
<div class="border">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="00-bilder/ren-strom-d-vq-ccbysa40.png" class="img-fluid figure-img" alt="The development of electricity generation from photovoltaics, biomass, offshore wind, onshore wind, and hydropower on an annual basis in Germany from 1990 to 2022 is shown. Until 1995, electricity generation is practically exclusively from hydropower at 20 TWh. This value remains almost unchanged until 2022 with minor fluctuations. From 1996 onwards, the addition of other forms of renewable electricity generation becomes visible. In 2001, due to the addition of onshore wind and biomass, electricity production reaches 40 TWh. Since then, approximately 10 TWh are added annually from renewable sources, on average and fairly evenly (considering weather-related fluctuations). From 2006, photovoltaics were added, and from 2014, offshore wind."></p>
<figcaption>Renewable electricity generation in Germany since 1990</figcaption>
</figure>
</div>
<p>Renewable electricity generation in Germany since 1990 by Volker Quaschning based on data from AG Energiebilanzen (<a href="https://ag-energiebilanzen.de/wp-content/uploads/2024/04/STRERZ_Abg_02_2024_korr.xlsx">Electricity generation by energy source (electricity mix) from 1990 to 2022 (in TWh) Germany total (XLSX)</a>) is licensed under <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> and available at <a href="https://www.volker-quaschning.de/datserv/ren-Strom-D/index.php" class="uri">https://www.volker-quaschning.de/datserv/ren-Strom-D/index.php</a>. 2023</p>
</div>
<p>&nbsp;</p>
<p>The Renewable Energy Sources Act (EEG) defines in Section 4 expansion paths for the installed capacity of solar energy, onshore wind, and biomass. The expansion path for offshore wind is regulated in Section 1 of the Offshore Wind Energy Act.</p>
<div class="callout callout-style-simple callout-warning callout-titled" title="Legal Basis for the Renewable Expansion Path">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warnung</span>Legal Basis for the Renewable Expansion Path
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="border quarto-layout-panel" data-layout="[[5, 90, 5], [1], [1], [5, 90, 5], [1]]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 5.0%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 90.0%;justify-content: flex-start;">
<p><strong>§ 4 Expansion Path</strong><br>
[…]<br>
1. an increase in the installed capacity of onshore wind turbines to<br>
a) 69 gigawatts by 2024,<br>
b) 84 gigawatts by 2026,<br>
c) 99 gigawatts by 2028,<br>
d) 115 gigawatts by 2030,<br>
e) 157 gigawatts by 2035, and<br>
f) 160 gigawatts by 2040<br>
[…]<br>
2. an increase in the installed capacity of offshore wind turbines according to the Offshore Wind Energy Act,<br>
3. an increase in the installed capacity of solar power plants to<br>
a) 88 gigawatts by 2024,<br>
b) 128 gigawatts by 2026,<br>
c) 172 gigawatts by 2028,<br>
d) 215 gigawatts by 2030,<br>
e) 309 gigawatts by 2035, and<br>
f) 400 gigawatts by 2040<br>
[…]<br>
4. an installed capacity of biomass plants of 8,400 megawatts by 2030.</p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 5.0%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>Renewable Energy Sources Act (EEG 2023) <a href="https://www.gesetze-im-internet.de/eeg_2014/__4.html">Federal Ministry of Justice</a></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 5.0%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 90.0%;justify-content: flex-start;">
<p><strong>§ 1 Purpose and Objective of the Act</strong><br>
[…]<br>
(2) The objective of this Act is to increase the installed capacity of offshore wind turbines connected to the grid to at least 30 gigawatts by 2030, at least 40 gigawatts by 2035, and at least 70 gigawatts by 2045.</p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 5.0%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>Offshore Wind Energy Development and Promotion Act (WindSeeG) <a href="https://www.gesetze-im-internet.de/windseeg/BJNR231000016.html">Federal Ministry of Justice</a></p>
</div>
</div>
</div>
</div>
</div>
</div>
<p>The federal government’s expansion targets specify installed capacities for 2030 and 2035 as:</p>
<ul>
<li><p>115 GW onshore wind by 2030, 157 GW by 2035,</p></li>
<li><p>30 GW offshore wind by 2030, 40 GW by 2035,</p></li>
<li><p>215 GW solar by 2030, 309 GW by 2035, and</p></li>
<li><p>8.4 GW biomass.</p></li>
</ul>
<p>This implies a planned increase in installed capacity compared to the 2023 installed capacity of:</p>
<div id="lst-zubaufaktoren" class="listing quarto-float quarto-figure quarto-figure-left anchored">
<figure class="quarto-float quarto-float-lst figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst quarto-uncaptioned" id="lst-zubaufaktoren-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Code-Block&nbsp;7.1
</figcaption>
<div aria-describedby="lst-zubaufaktoren-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="50c5a2ac" class="cell" data-execution_count="48">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate expansion factors for 2030 and 2035 based on installed capacity</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Onshore Wind 2030:</span><span class="ch">\t</span><span class="sc">{</span>( windonshore_growth_factor_2030 <span class="op">:=</span> <span class="dv">115</span> <span class="op">/</span> (installed_capacity[<span class="st">'Wind Onshore [MW]'</span>].<span class="bu">sum</span>() <span class="op">/</span> <span class="dv">1000</span>) )<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Offshore Wind 2030:</span><span class="ch">\t</span><span class="sc">{</span>( windoffshore_growth_factor_2030 <span class="op">:=</span> <span class="dv">30</span> <span class="op">/</span> (installed_capacity[<span class="st">'Wind Offshore [MW]'</span>].<span class="bu">sum</span>() <span class="op">/</span> <span class="dv">1000</span>) )<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Solar 2030:</span><span class="ch">\t\t\t</span><span class="sc">{</span>( solar_growth_factor_2030 <span class="op">:=</span> <span class="dv">215</span> <span class="op">/</span> (installed_capacity[<span class="st">'Photovoltaik [MW]'</span>].<span class="bu">sum</span>() <span class="op">/</span> <span class="dv">1000</span>) )<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Biomass 2030:</span><span class="ch">\t\t</span><span class="sc">{</span><span class="fl">8.4</span> <span class="op">/</span> (installed_capacity[<span class="st">'Biomasse [MW]'</span>].<span class="bu">sum</span>() <span class="op">/</span> <span class="dv">1000</span>)<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n\n</span><span class="ss">Onshore Wind 2035:</span><span class="ch">\t</span><span class="sc">{</span>( windonshore_growth_factor_2035 <span class="op">:=</span> <span class="dv">157</span> <span class="op">/</span> (installed_capacity[<span class="st">'Wind Onshore [MW]'</span>].<span class="bu">sum</span>() <span class="op">/</span> <span class="dv">1000</span>) )<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Offshore Wind 2035:</span><span class="ch">\t</span><span class="sc">{</span>( windoffshore_growth_factor_2035 <span class="op">:=</span> <span class="dv">40</span> <span class="op">/</span> (installed_capacity[<span class="st">'Wind Offshore [MW]'</span>].<span class="bu">sum</span>() <span class="op">/</span> <span class="dv">1000</span>) )<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Solar 2035:</span><span class="ch">\t\t\t</span><span class="sc">{</span>( solar_growth_factor_2035 <span class="op">:=</span> <span class="dv">309</span> <span class="op">/</span> (installed_capacity[<span class="st">'Photovoltaik [MW]'</span>].<span class="bu">sum</span>() <span class="op">/</span> <span class="dv">1000</span>) )<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Biomass 2035:</span><span class="ch">\t\t</span><span class="sc">{</span><span class="fl">8.4</span> <span class="op">/</span> (installed_capacity[<span class="st">'Biomasse [MW]'</span>].<span class="bu">sum</span>() <span class="op">/</span> <span class="dv">1000</span>)<span class="sc">:,.2f}</span><span class="ss">"</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Onshore Wind 2030:  2.00
Offshore Wind 2030: 3.69
Solar 2030:         3.41
Biomass 2030:       0.99


Onshore Wind 2035:  2.73
Offshore Wind 2035: 4.92
Solar 2035:         4.90
Biomass 2035:       0.99</code></pre>
</div>
</div>
</div>
</figure>
</div>
<p>By 2030, onshore wind power production is planned to be doubled, while offshore wind and photovoltaic production are planned to increase by a factor of 3.5. By 2035, onshore wind is expected to nearly triple, and offshore wind and photovoltaic production are expected to quintuple. Biomass expansion is not planned. The growth factors are stored in an object.</p>
<div class="callout callout-style-simple callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warnung</span>Power Grid Development Plan
</div>
</div>
<div class="callout-body-container callout-body">
<p>In addition to generation capacity, the electricity transmission grid is also to be expanded. These plans are documented in the Power Grid Development Plan, which is updated every two years by the four transmission system operators in coordination with the Federal Network Agency.</p>
<p>The current and previous grid development plans can be accessed at <a href="https://www.netzentwicklungsplan.de/" class="uri">https://www.netzentwicklungsplan.de/</a>.</p>
</div>
</div>
</section>
<section id="background-energy-storage" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="background-energy-storage"><span class="header-section-number">7.2</span> Background: Energy Storage</h2>
<p>Energy storage systems store electricity during periods of surplus and release it during periods of deficit. Different types of energy storage and their applications are presented in the following video. Storage types differ fundamentally in terms of capacity and charge/discharge power.</p>
<div class="border">
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/yiJ1vAAJnVA" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Energy Technology. 14 Energy Storage. 14.02 Key Figures by Henrik te Heesen is licensed under <a href="https://creativecommons.org/licenses/by-sa/3.0/deed.de">CC BY-SA 3.0</a> and available on <a href="https://www.youtube.com/watch?v=yiJ1vAAJnVA">YouTube</a>. 2020</p>
</div>
<div id="imp-keyFigures-energyStorage" class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition&nbsp;7.1: Selected Key Figures of Energy Storage Systems
</div>
</div>
<div class="callout-body-container callout-body">
<div class="border">
<ul>
<li><p>Nominal Storage Capacity: The total amount of energy that can be withdrawn from the storage system.</p></li>
<li><p>Usable Storage Capacity: The portion of nominal capacity that can be used without causing damage.</p></li>
<li><p>Depth of Discharge (DoD): Difference between the maximum and minimum allowed state of charge.</p></li>
<li><p>State of Charge (SoC): Ratio of currently stored energy to nominal capacity, usually expressed as a percentage.</p></li>
<li><p>Efficiency: Effectiveness of storage considering charging, discharging, and losses (such as self-discharge).</p></li>
</ul>
<p>Further key figures are introduced in the following video:</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/0-PRS2naETE" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Energy Technology. 14 Energy Storage. 14.03 Key Figures and Definitions by Henrik te Heesen is licensed under <a href="https://creativecommons.org/licenses/by-sa/3.0/deed.de">CC BY-SA 3.0</a> and available on <a href="https://www.youtube.com/watch?v=0-PRS2naETE">YouTube</a>. 2020</p>
</div>
</div>
</div>
</section>
<section id="calculating-storage-size" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="calculating-storage-size"><span class="header-section-number">7.3</span> Calculating Storage Size</h2>
<p>The following section develops the basic principles of storage design and the methods for calculating storage size. All considerations are based on the residual load curve. Values below zero correspond to a surplus of renewable generation, while values above zero correspond to a grid load that must be served by dispatchable power plants or storage. The residual load is determined as follows:</p>
<div id="c147eab7" class="cell" data-execution_count="49">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>renewables <span class="op">=</span> [<span class="st">'Biomasse [MWh]'</span>, <span class="st">'Wasserkraft [MWh]'</span>, <span class="st">'Wind Offshore [MWh]'</span>, <span class="st">'Wind Onshore [MWh]'</span>, <span class="st">'Photovoltaik [MWh]'</span>, <span class="st">'Sonstige Erneuerbare [MWh]'</span>]</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>residual_load <span class="op">=</span> pd.DataFrame()</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>residual_load[<span class="st">"Netzlast [MWh]"</span>] <span class="op">=</span> consumption[<span class="st">"Gesamt (Netzlast) [MWh]"</span>].copy()</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>residual_load[<span class="st">"Erneuerbare [MWh]"</span>] <span class="op">=</span> generation[renewables].<span class="bu">sum</span>(axis<span class="op">=</span><span class="st">"columns"</span>).copy()</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>residual_load[<span class="st">"Restlast [MWh]"</span>] <span class="op">=</span> residual_load[<span class="st">"Netzlast [MWh]"</span>] <span class="op">-</span> residual_load[<span class="st">"Erneuerbare [MWh]"</span>]</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>residual_load <span class="op">=</span> residual_load[<span class="st">"Restlast [MWh]"</span>]</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>To better understand the scale of the calculations, the storage size is put in relation to the existing pumped-storage capacity of 37.4 GWh.</p>
<div id="21badbab" class="cell" data-execution_count="50">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>pumped_storage_capacity_MWh <span class="op">=</span> <span class="fl">37.4</span> <span class="op">*</span> <span class="dv">1000</span></span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>&nbsp;</p>
<div id="tip-Testdaten" class="callout callout-style-default callout-tip callout-titled" title="Funktionsentwicklung mit Testdaten">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tipp&nbsp;7.1: Funktionsentwicklung mit Testdaten
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>The functions developed below generally offer an option to output calculation results, but due to the length of the data series, displaying the residual load is not meaningful. As a result, the data series itself as well as intermediate and final results of the calculations, including any existing errors, cannot be easily reviewed. Therefore, for function development, it is recommended to work with test data. This allows calculations to be performed more quickly, and intermediate results and final outputs can be displayed for verification if needed. The following functions were developed using randomly generated test data.</p>
<p>In the following code block, a residual load curve of ten random values is generated. By adjusting the values for <code>a</code> and <code>b</code>, the outcome can be controlled. The output records the sum of the data series. A negative value indicates that the simulated residual load curve shows a surplus production of renewable energy. A positive value indicates that the positive residual load along the simulated curve exceeds the renewable surplus production.</p>
<p>The code block also creates a static data series. This serves to store test data that led to errors. The <code>random_data</code> series is output as a list so that it can be copied and pasted into the static data series for further testing.</p>
<div id="4b0eb653" class="cell" data-execution_count="51">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random <span class="im">as</span> rd</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a list of 10 random integers between -20 and 20</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>random_data <span class="op">=</span> []</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    random_data.append(rd.randint(a<span class="op">=-</span><span class="dv">20</span>, b<span class="op">=</span><span class="dv">20</span>))</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the list to a pandas Series with float type</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>random_data <span class="op">=</span> pd.Series(random_data, dtype<span class="op">=</span><span class="st">'float'</span>)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"random_data: </span><span class="sc">{</span><span class="bu">list</span>(random_data)<span class="sc">}</span><span class="ch">\n</span><span class="ss">Sum of random_data: </span><span class="sc">{</span>random_data<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a static dataset as a pandas Series with float type</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>static_data <span class="op">=</span> pd.Series([<span class="dv">8</span>, <span class="op">-</span><span class="dv">14</span>, <span class="op">-</span><span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="op">-</span><span class="dv">6</span>, <span class="dv">5</span>, <span class="op">-</span><span class="dv">20</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">12</span>], dtype<span class="op">=</span><span class="st">'float'</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>random_data: [-3.0, -8.0, 7.0, -14.0, -6.0, -8.0, 9.0, -6.0, -9.0, -12.0]
Sum of random_data: -50.0
</code></pre>
</div>
</div>
</div>
</div>
</div>
<section id="surplus-or-deficit-of-renewable-energy" class="level3">
<h3 class="anchored" data-anchor-id="surplus-or-deficit-of-renewable-energy">Surplus or Deficit of Renewable Energy</h3>
<p>The required size of the electricity storage depends, on one hand, on the ratio of the amount of renewable surplus production to the residual load that must be served from the storage. On the other hand, the efficiency η (Greek letter Eta) of the storage during charging and discharging plays a role.</p>
<div class="quarto-layout-panel" data-layout="[50, 50]">
<div class="quarto-layout-row">
<div id="e78628d2" class="cell quarto-layout-cell" data-execution_count="52" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-53-output-1.png" alt="Two simplified residual load curves, each consisting of two bars, are shown over the course of a year. The x-axis represents the 365 days of the year, and the y-axis represents the residual load from minus 1 to 1. In the top plot, the annual course with a renewable energy deficit is displayed. In the first half of the year, the residual load is negative at -0.5, in the second half positive at 1. Each is represented by a single bar of the corresponding height. The first bar with negative values is colored and hatched diagonally upward to the left to indicate the storage phase. The second bar with positive values is hatched diagonally downward to the right up to half the height (0.5) to indicate the discharge phase, while the area from 0.5 to 1 is unfilled, representing residual load served by conventional power plants. In the bottom plot, the annual course with a renewable energy surplus is shown. In the first half of the year, the residual load is -1, in the second half 0.5. The first bar with negative values is unfilled and hatched diagonally upward to the left up to half the height (-0.5) to indicate the storage phase. The second bar with positive values (0.5) is colored to indicate required storage and hatched diagonally downward to indicate discharge." width="567" height="471" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<dl>
<dt>Renewable Electricity Production: Surplus or Deficit?</dt>
<dd>
If the sum of renewable surplus production is smaller than the residual load to be served from storage, the required storage capacity corresponds to the sum of the renewable surplus production.
</dd>
<dd>
If the sum of renewable surplus production is larger than the residual load to be served from storage, the required storage capacity corresponds to the sum of the residual load to be served.
</dd>
<dd>
Whether there is a surplus or a deficit of renewable electricity production can be determined from the sign of the summed residual load. A negative sign indicates a renewable electricity surplus, while a positive sign indicates a renewable electricity deficit.
</dd>
</dl>
</div>
</div>
<div class="quarto-layout-row">
<div id="9dc91db7" class="cell quarto-layout-cell" data-execution_count="53" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-54-output-1.png" alt="A chart with two bars shows a simplified annual residual load with charging and discharging efficiency. The x-axis represents the 365 days of the year, the y-axis the residual load from minus 1 to 1. In the first half of the year, the residual load is negative at minus 1, in the second half positive at 1. The first bar with negative values is colored up to minus 0.8 and hatched upward to indicate storage size and the charging phase. The area from minus 0.8 to minus 1 is dotted, representing charging losses at an efficiency of 0.8. The second bar with positive values is hatched downward up to 0.64 to indicate the discharging phase. The area from 0.64 to 0.8 is large-dotted, representing discharging losses at an efficiency of 0.8. The area from 0.8 to 1 is plain white and corresponds, like the discharging loss area, to residual load handled by peaking power plants." width="567" height="471" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<dl>
<dt>Efficiency</dt>
<dd>
The charging efficiency reduces the available surplus power. If the sum of renewable surplus production is smaller than the residual load to be met from the storage, the storage can be sized smaller by the charging efficiency.
</dd>
<dd>
The discharging efficiency (including storage losses) increases the load to be met by the storage. If the sum of renewable surplus production is greater than the residual load to be met from the storage, the storage must be sized larger by the discharging efficiency.
</dd>
</dl>
</div>
</div>
</div>
<section id="calculation" class="level4">
<h4 class="anchored" data-anchor-id="calculation">Calculation</h4>
<p>Whether phases of renewable overproduction or phases of positive residual load dominate over the course of a year can be determined using the following functions.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true" href="">without efficiency</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false" href="">with efficiency</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div id="492c6084" class="cell" data-execution_count="54">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Detect excess renewable energy</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Input: data = pd.Series(data, dtype='float')</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: sum is calculated over the pd.Series</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: returns the boolean value of data.sum() &lt; 0</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> check_renewable_excess(data):</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> data.<span class="bu">sum</span>() <span class="op">&lt;</span> <span class="dv">0</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>check_renewable_excess(residual_load)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>np.False_</code></pre>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div id="81913181" class="cell" data-execution_count="55">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine renewable energy surplus, given a charge and discharge efficiency</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Input: data = pd.Series(data, dtype='float'), charge_efficiency = 1, discharge_efficiency = 1</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: values less than 0 are multiplied by the charge efficiency</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: values greater than 0 are divided by the discharge efficiency</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: the sum is computed over the pd.Series</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: returns True if data_efficiency_adjusted.sum() &lt; 0, otherwise False</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> check_RE_surplus(data, charge_efficiency<span class="op">=</span><span class="dv">1</span>, discharge_efficiency<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    data_efficiency_adjusted <span class="op">=</span> data.copy()</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>    data_efficiency_adjusted[data_efficiency_adjusted <span class="op">&lt;</span> <span class="dv">0</span>] <span class="op">=</span> (</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>        data_efficiency_adjusted[data_efficiency_adjusted <span class="op">&lt;</span> <span class="dv">0</span>] <span class="op">*</span> charge_efficiency</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>    data_efficiency_adjusted[data_efficiency_adjusted <span class="op">&gt;</span> <span class="dv">0</span>] <span class="op">=</span> (</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>        data_efficiency_adjusted[data_efficiency_adjusted <span class="op">&gt;</span> <span class="dv">0</span>] <span class="op">/</span> discharge_efficiency</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data_efficiency_adjusted.<span class="bu">sum</span>() <span class="op">&lt;</span> <span class="dv">0</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>check_RE_surplus(residual_load, charge_efficiency<span class="op">=</span><span class="fl">0.9</span>, discharge_efficiency<span class="op">=</span><span class="fl">0.9</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>np.False_</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>As known from the marginal electricity analysis in section <a href="#sec-PumpedStorageContent" class="quarto-xref"><span>Kapitel 6.6</span></a>, there was no surplus of renewable electricity production in 2023.</p>
</section>
</section>
<section id="cyclicality" class="level3">
<h3 class="anchored" data-anchor-id="cyclicality">Cyclicality</h3>
<p>Over the course of a year, the sequence of periods with renewable surpluses and periods with positive residual load affects how large a storage system needs to be.</p>
<div class="quarto-layout-panel" data-layout="[50, 50]">
<div class="quarto-layout-row">
<div id="fa02b1dd" class="cell quarto-layout-cell" data-execution_count="56" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-57-output-1.png" alt="Two simplified residual load curves, each consisting of four bars, are shown for two consecutive years in two graphs. The x-axis represents the 730 days of the two consecutive years, the y-axis the residual load from -1 to 1. The upper graph shows the two-year residual load with a deficit of renewable surplus generation. In the first half-year, the positive residual load is 1, which cannot yet be covered by stored electricity. In the second half-year, the residual load is -0.5. This bar is colored and hatched upward, indicating the required storage capacity and the charging phase. The second year's pattern repeats. In the third half-year, the positive residual load is again 1. The third bar with positive values of 1 is hatched downward from 0.5 to 0, showing the discharge phase. The area from 0.5 to 1 is unfilled, corresponding to residual load served by dispatchable power plants. In the fourth half-year, the negative residual load is again -0.5, hatched upward to indicate recharge. The lower graph shows the two-year residual load with a surplus of renewable generation. In the first half-year, the positive residual load is 0.5, not yet covered by stored electricity. In the second half-year, the residual load is -1, hatched upward to indicate charging up to -0.5; the area from -0.5 to -1 is unmarked, representing unused renewable surplus. The second year repeats. In the third half-year, the positive residual load is 0.5, hatched downward to indicate discharge. In the fourth half-year, the residual load is -1, hatched upward to indicate charging, while the area from -0.5 to -1 remains unmarked." width="567" height="471" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<dl>
<dt>Order Dependence</dt>
<dd>
If only a single year is considered, the order of renewable over- and underproduction determines how much electricity can be stored. In the worst-case scenario, there is a positive residual load in the first half of the year (but the storage is still empty) and renewable overproduction occurs in the second half of the year (which would no longer be absorbed in the second half).
</dd>
<dd>
Order dependence can be resolved by considering two consecutive years. In the first year, the storage is connected to the grid empty. The second year begins with the storage filled by the surplus production from the previous year.
</dd>
</dl>
</div>
</div>
<div class="quarto-layout-row">
<div id="d8754ab9" class="cell quarto-layout-cell" data-execution_count="57" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-58-output-1.png" alt="Two simplified annual profiles of residual load are shown in two charts. The x-axis represents the 365 days of the year, and the y-axis shows the residual load from minus 1 to 1. The top chart depicts the annual profile of residual load for a full cycle of complete charging and discharging with two bars. In the first half of the year, the residual load is minus 1; the bar is colored and hatched upwards. The coloring indicates the required storage size, and the upward hatching indicates the charging phase. In the second half of the year, the residual load is 1. This bar is hatched downwards to the right to indicate the discharging phase. The bottom chart shows the annual profile of residual load for two full cycles with four bars. In the first quarter, the residual load is minus 1; the bar is colored and hatched upwards. The coloring indicates the required storage size, which is half of that in the top chart, and the upward hatching indicates the charging phase. In the second quarter, the residual load is 1, hatched downwards to the right to indicate discharging. The pattern of charging and discharging at 1 repeats in the second half of the year." width="567" height="471" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<dl>
<dt>Number of Full Cycles</dt>
<dd>
The required size of the energy storage depends on the distribution of the residual load and the number of full cycles achieved. A full cycle means that a storage system is completely charged and then fully discharged.
</dd>
<dd>
In the worst-case scenario, only a single charge/discharge cycle occurs. In this case, the required storage size equals the sum of the renewable surplus production.
</dd>
<dd>
The more frequently charging and discharging cycles alternate, the smaller the required storage size. This corresponds to the sum of the renewable surplus production divided by the number of full cycles.
</dd>
</dl>
</div>
</div>
<div class="quarto-layout-row">
<div id="006c6b19" class="cell quarto-layout-cell" data-execution_count="58" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-59-output-1.png" alt="Two simplified annual residual load profiles with partial cycles are shown in two plots. The x-axis represents the 365 days of the year, and the y-axis the residual load from -1 to 1. In the top plot, the annual residual load during a renewable energy deficit is shown with four bars. In the first quarter, the negative residual load is -0.5; the bar is colored and hatched upward, indicating the storage phase. In the second quarter, the positive residual load is 0.25, marking the start of partial discharge, so the bar is hatched downward. In the third quarter, the negative residual load is again -0.5, hatched to indicate the storage phase. The area from 0 to -0.25 is uncolored, showing partial storage where previously withdrawn electricity is replenished. The area from -0.25 to -0.5 is colored, adding additional electricity to storage. The total stored electricity is now 0.75. In the fourth quarter, the positive residual load is 1. The area from 0 to 0.75 is hatched downward, indicating storage discharge. The area from 0.75 to 1 is unmarked (white), representing residual load covered by conventional power plants. In the bottom plot, the annual residual load during a renewable energy surplus is shown with four bars. In the first quarter, the negative residual load is -1, hatched upward for storage. In the second quarter, the positive residual load is 0.25, marking the start of partial discharge with downward hatching. In the third quarter, the negative residual load is -1; up to -0.25 it is hatched upward to indicate storage replenishment, while -0.25 to -1 is unmarked, representing surplus electricity not stored. In the fourth quarter, the positive residual load is 1; the bar is colored for required storage size and hatched downward for discharge." width="567" height="471" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<dl>
<dt>Partial Cycles</dt>
<dd>
The distribution of occurring partial cycles also reduces the required storage capacity.
</dd>
<dd>
If the sum of renewable surplus production is smaller than the residual load that the storage needs to cover, the required storage capacity corresponds to the minimum of the cumulative sum of the residual load, provided it is never set above 0 (exceeding this point would indicate the moment when the storage is empty).
</dd>
<dd>
If the sum of renewable surplus production is greater than the residual load that the storage needs to cover, the required storage capacity corresponds to the maximum of the cumulative sum of the residual load, provided it is never set below 0 (falling below this point would indicate the moment when the storage is oversized).
</dd>
</dl>
</div>
</div>
</div>
<section id="calculation-1" class="level4">
<h4 class="anchored" data-anchor-id="calculation-1">Calculation</h4>
<p>The storage capacity is calculated from the annual profile of the residual load. To avoid dependency on the time at which the storage is connected to the grid, the dataset is iterated twice (resolving any order-dependency). The required storage capacity is calculated using the cumulative sum of the residual load. If the sum of renewable surplus production is smaller than the sum of residual load that the storage needs to cover, the cumulative sum is never set above 0. Exceeding this upper limit would be the moment when the storage is empty and positive residual load can no longer be served. Conversely, if the sum of renewable surplus production is greater than the sum of residual load to be covered, the cumulative sum is never set below 0. Falling below this limit would be the moment when the storage is oversized and energy is held that is never consumed by positive residual load throughout the year.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true" href="">without efficiency</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false" href="">with Efficiency</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div id="88057665" class="cell" data-execution_count="59">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate storage size</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Input: data = pd.Series(data, dtype='float'), output = False</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: call the function check_RE_surplus to distinguish between upper limit = 0 (storage empty) and lower limit = 0 (storage oversized)</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: data is concatenated twice into data_x2. For data_x2, the capped cumulative sum at 0 is calculated and storage size is determined.</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: if output = False, the storage size (float) is returned; if output = True, the sum of data and the storage size are printed</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_storage_capacity(data, output<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    data_x2 <span class="op">=</span> pd.concat([data, data])</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>    surplus <span class="op">=</span> check_RE_surplus(data)</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> surplus:</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># calculate capped cumulative sum</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>        capped_cumsum <span class="op">=</span> []</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>        total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> data_x2:</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>            total <span class="op">+=</span> i </span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>            <span class="co"># check lower limit</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> total <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>                total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>            capped_cumsum.append(total)</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>        storage_capacity <span class="op">=</span> <span class="bu">max</span>(capped_cumsum)</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># calculate capped cumulative sum</span></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>        capped_cumsum <span class="op">=</span> []</span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>        total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> data_x2:</span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a>            total <span class="op">+=</span> i</span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>            <span class="co"># check upper limit</span></span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> total <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a>                total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a>            capped_cumsum.append(total)</span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a>        storage_capacity <span class="op">=</span> <span class="bu">abs</span>(<span class="bu">min</span>(capped_cumsum))</span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> output:  <span class="co"># output = True</span></span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Sum of data: </span><span class="sc">{</span>data<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ch">\n</span><span class="ss">Storage size: </span><span class="sc">{</span>storage_capacity<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb56-49"><a href="#cb56-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb56-50"><a href="#cb56-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:  <span class="co"># output = False</span></span>
<span id="cb56-51"><a href="#cb56-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> storage_capacity</span>
<span id="cb56-52"><a href="#cb56-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-53"><a href="#cb56-53" aria-hidden="true" tabindex="-1"></a>storage_2023 <span class="op">=</span> calculate_storage_capacity(residual_load, output<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb56-54"><a href="#cb56-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-55"><a href="#cb56-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Required storage size 2023: </span><span class="sc">{</span>storage_2023<span class="sc">:,.1f}</span><span class="ss"> MWh</span><span class="ch">\n</span><span class="ss">This corresponds to </span><span class="sc">{</span>storage_2023 <span class="op">/</span> pumped_storage_capacity_MWh<span class="sc">:,.1f}</span><span class="ss"> pumped-storage equivalents."</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Required storage size 2023: 119,667.0 MWh
This corresponds to 3.2 pumped-storage equivalents.</code></pre>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div id="8daa840a" class="cell" data-execution_count="60">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate storage size</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Input: data = pd.Series(data, dtype='float'), charge_efficiency = 1, discharge_efficiency = 1, output = False</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: call the function check_RE_surplus to distinguish between upper limit = 0 (storage empty) and lower limit = 0 (storage oversized)</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: data is concatenated twice to data_x2. For data_x2, the capped cumulative sum at 0 is calculated and the storage size is determined.</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: if output = False, the storage size (float) is returned; if output = True, the sum of data and the storage size are printed</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_storage_capacity(data, charge_efficiency<span class="op">=</span><span class="dv">1</span>, discharge_efficiency<span class="op">=</span><span class="dv">1</span>, output<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    data_x2 <span class="op">=</span> pd.concat([data, data])</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>    surplus <span class="op">=</span> check_RE_surplus(data, charge_efficiency, discharge_efficiency)</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> surplus:</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate capped cumulative sum</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>        capped_cumsum <span class="op">=</span> []</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>        total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> data_x2:</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>                total <span class="op">+=</span> i <span class="op">*</span> charge_efficiency</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>                total <span class="op">+=</span> i <span class="op">/</span> discharge_efficiency</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Check lower limit</span></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> total <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>                total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>            capped_cumsum.append(total)</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>        storage_capacity <span class="op">=</span> <span class="bu">max</span>(capped_cumsum)</span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:  <span class="co"># Underproduction</span></span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate capped cumulative sum</span></span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a>        capped_cumsum <span class="op">=</span> []</span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a>        total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> data_x2:</span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true" tabindex="-1"></a>                total <span class="op">+=</span> i <span class="op">*</span> charge_efficiency</span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true" tabindex="-1"></a>                total <span class="op">+=</span> i <span class="op">/</span> discharge_efficiency</span>
<span id="cb58-44"><a href="#cb58-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-45"><a href="#cb58-45" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Check upper limit</span></span>
<span id="cb58-46"><a href="#cb58-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> total <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb58-47"><a href="#cb58-47" aria-hidden="true" tabindex="-1"></a>                total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb58-48"><a href="#cb58-48" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb58-49"><a href="#cb58-49" aria-hidden="true" tabindex="-1"></a>            capped_cumsum.append(total)</span>
<span id="cb58-50"><a href="#cb58-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-51"><a href="#cb58-51" aria-hidden="true" tabindex="-1"></a>        storage_capacity <span class="op">=</span> <span class="bu">abs</span>(<span class="bu">min</span>(capped_cumsum))</span>
<span id="cb58-52"><a href="#cb58-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-53"><a href="#cb58-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> output:  <span class="co"># output = True</span></span>
<span id="cb58-54"><a href="#cb58-54" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Sum of data: </span><span class="sc">{</span>data<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ch">\n</span><span class="ss">Storage size: </span><span class="sc">{</span>storage_capacity<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb58-55"><a href="#cb58-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-56"><a href="#cb58-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:  <span class="co"># output = False</span></span>
<span id="cb58-57"><a href="#cb58-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> storage_capacity</span>
<span id="cb58-58"><a href="#cb58-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-59"><a href="#cb58-59" aria-hidden="true" tabindex="-1"></a>storage_2023capacity <span class="op">=</span> calculate_storage_capacity(residual_load, charge_efficiency<span class="op">=</span><span class="fl">0.9</span>, discharge_efficiency<span class="op">=</span><span class="fl">0.9</span>, output<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb58-60"><a href="#cb58-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-61"><a href="#cb58-61" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Required storage size 2023: </span><span class="sc">{</span>storage_2023<span class="sc">:,.1f}</span><span class="ss"> MWh</span><span class="ch">\n</span><span class="ss">This corresponds to </span><span class="sc">{</span>storage_2023 <span class="op">/</span> pumped_storage_capacity_MWh<span class="sc">:,.1f}</span><span class="ss"> pumped-storage equivalents."</span>)   </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Required storage size 2023: 119,667.0 MWh
This corresponds to 3.2 pumped-storage equivalents.</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="annual-storage-profile" class="level4">
<h4 class="anchored" data-anchor-id="annual-storage-profile">Annual Storage Profile</h4>
<p>After determining the storage capacity, the annual storage profile for the first and second year can be calculated and visualized. The annual storage profile for the second year represents the stable equilibrium, which can be repeated indefinitely for a given residual load curve.</p>
<ul>
<li><p>Input: The function receives a residual load curve as input. Additionally, a storage capacity can be provided; otherwise, it is determined by calling the function <code>calculate_storage_capacity()</code>.</p></li>
<li><p>Processing: Starting with an empty storage, the residual load series is traversed element by element twice. Negative values are stored until the storage capacity is reached. Positive values are withdrawn from the storage until the storage level reaches zero. In the function extended with charge and discharge efficiencies, stored values are multiplied by the charge efficiency (0.9) and withdrawn values are divided by the discharge efficiency (0.9).</p></li>
<li><p>Output: If <code>output = False</code>, the function returns a tuple. Position 0 contains the storage capacity, position 1 the annual profile for year 1 as a pd.Series, and position 2 the annual profile for year 2 as a pd.Series. The annual profiles are subsequently visualized in a panel. If <code>output = True</code>, the cumulative sum of the residual load and the storage capacity, as well as the provided residual load curve, storage levels, and available capacity for year 1 and year 2, are printed with <code>print()</code>—this is typically useful only for test data.</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true" href="">without efficiency</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false" href="">Plot without Efficiency</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false" href="">Code for the plot without efficiency</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-4" role="tab" aria-controls="tabset-13-4" aria-selected="false" href="">With Efficiency</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-5" role="tab" aria-controls="tabset-13-5" aria-selected="false" href="">Plot with Efficiency</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-6" role="tab" aria-controls="tabset-13-6" aria-selected="false" href="">Code for the plot with efficiency</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div id="0a0a4683" class="cell" data-execution_count="61">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate annual storage profile</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Input: data = pd.Series(data, dtype='float'), storage_capacity=-1, output=False</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: If storage_capacity=-1, the storage size is determined with the functicapacity(data)</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: data is concatenated twice to data_x2.</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: Based on the storage capacity, the storage level and free capacity are calculated for all data values for year 1 and all following years.</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: If output=False, returns a tuple with storage_capacity (float), storage_level_year1 (pd.Series), storage_level_year2 (pd.Series)</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: If output=True, also returns cumulative residual load, storage capacity, residual load curve, storage levels, and free storage capacity for year 1 and year 2</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_annual_storage(data, storage_capacity<span class="op">=-</span><span class="dv">1</span>, output<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    data_x2 <span class="op">=</span> pd.concat([data, data])</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> storage_capacity <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>        storage_capacity <span class="op">=</span> calculate_storage_capacity(data) </span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate annual storage profile</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>    annual_storage <span class="op">=</span> []</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>    storage_level <span class="op">=</span> []</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>    free_capacity <span class="op">=</span> storage_capacity  <span class="co"># storage is empty</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> data_x2:</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (storage_capacity <span class="op">-</span> free_capacity) <span class="op">-</span> i <span class="op">&lt;</span> <span class="dv">0</span>:  <span class="co"># load without prior storage cannot be supplied</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>            free_capacity <span class="op">=</span> storage_capacity</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> free_capacity <span class="op">+</span> i <span class="op">&lt;</span> <span class="dv">0</span>:  <span class="co"># if storage is full, surplus must be discarded</span></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>            free_capacity <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:  <span class="co"># charging/discharging</span></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>            free_capacity <span class="op">+=</span> i</span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>        annual_storage.append(free_capacity)</span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>        storage_level.append(storage_capacity <span class="op">-</span> free_capacity)</span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> output:  <span class="co"># output=True</span></span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>        dataset <span class="op">=</span> pd.DataFrame({</span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Residual Load'</span>: data,</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Storage Level Year1'</span>: storage_level[:<span class="bu">len</span>(annual_storage)<span class="op">//</span><span class="dv">2</span>],</span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Free Capacity Year1'</span>: annual_storage[:<span class="bu">len</span>(annual_storage)<span class="op">//</span><span class="dv">2</span>],</span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Storage Level Following Years'</span>: storage_level[<span class="bu">len</span>(annual_storage)<span class="op">//</span><span class="dv">2</span>:],</span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Free Capacity Following Years'</span>: annual_storage[<span class="bu">len</span>(annual_storage)<span class="op">//</span><span class="dv">2</span>:]</span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Sum of data: </span><span class="sc">{</span>data<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ch">\n</span><span class="ss">Storage Capacity: </span><span class="sc">{</span>storage_capacity<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(dataset)</span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:  <span class="co"># output=False</span></span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> storage_capacity, pd.Series(storage_level[:<span class="bu">len</span>(annual_storage)<span class="op">//</span><span class="dv">2</span>]), pd.Series(storage_level[<span class="bu">len</span>(annual_storage)<span class="op">//</span><span class="dv">2</span>:])</span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a>storage_2023 <span class="op">=</span> calculate_annual_storage(residual_load, output<span class="op">=</span><span class="va">False</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div id="a83b1e18" class="cell" data-execution_count="62">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-63-output-1.png" alt="The graphic shows the residual load for the year 2023. This is mostly positive and only negative at a few points during the year. Around the Christmas holidays, there is a longer period of negative residual load. In addition, the annual cycle of the storage is shown, storing all renewable production surpluses and discharging again during positive residual load. The interpretation of the annual cycle follows in the further text." width="710" height="569" class="figure-img"></p>
<figcaption>Residual load 2023 and annual cycle of a storage with efficiency 1</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div id="74c2ba10" class="cell" data-execution_count="63">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>annual_storage_year1 <span class="op">=</span> storage_2023[<span class="dv">1</span>]</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>annual_storage_year2 <span class="op">=</span> storage_2023[<span class="dv">2</span>]</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create xticks</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>month_index <span class="op">=</span> generation[<span class="op">~</span>generation[<span class="st">"Datum von"</span>].dt.month.duplicated()].index</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>month_names <span class="op">=</span> generation[<span class="st">"Datum von"</span>].iloc[month_index].dt.strftime(<span class="st">"%B"</span>) </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create graphic with three subplots</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>font_size <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2, ax3) <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, figsize <span class="op">=</span> (<span class="fl">7.5</span>, <span class="dv">6</span>), height_ratios <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>], sharex <span class="op">=</span> <span class="va">True</span>, layout <span class="op">=</span> <span class="st">'tight'</span>)</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Residual load 2023 and annual cycle of a storage with efficiency 1'</span>)</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>plt.xticks(month_index, month_names, rotation <span class="op">=</span> <span class="dv">45</span>)<span class="op">;</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>plt.minorticks_off()</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>plt.setp([ax1, ax2, ax3], xlim <span class="op">=</span> (residual_load.index.<span class="bu">min</span>() <span class="op">-</span> <span class="bu">len</span>(residual_load.index) <span class="op">/</span> <span class="dv">100</span>, residual_load.index.<span class="bu">max</span>() <span class="op">*</span> <span class="fl">1.01</span>))</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>plt.setp([ax2, ax3], ylim <span class="op">=</span> (<span class="dv">0</span>, <span class="bu">max</span>(<span class="bu">max</span>(annual_storage_year1), <span class="bu">max</span>(annual_storage_year2)) <span class="op">*</span> <span class="fl">1.1</span>))</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a><span class="co">## plot residual load</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>ax1.plot(residual_load, label <span class="op">=</span> <span class="st">"Residual load"</span>)</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>ax1.grid()</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'MWh'</span>)</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>ax1.legend()</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a><span class="co">## plot annual_storage_year1</span></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>ax2.plot(annual_storage_year1, color <span class="op">=</span> <span class="st">'black'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>, label <span class="op">=</span> <span class="st">'Battery Year 1'</span>)</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>ax2.grid()</span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'MWh'</span>)</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>ax2.legend()</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a><span class="co">## plot annual_storage_year2</span></span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>ax3.plot(annual_storage_year2, color <span class="op">=</span> <span class="st">'black'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>, label <span class="op">=</span> <span class="st">'Battery Year 2'</span>)</span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>ax3.tick_params(axis <span class="op">=</span> <span class="st">'x'</span>, rotation <span class="op">=</span> <span class="dv">45</span>)</span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">'MWh'</span>)</span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a>ax3.grid()</span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a>ax3.legend()</span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-13-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-4-tab">
<div id="64ceb617" class="cell" data-execution_count="64">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate annual storage cycle</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Input: data = pd.Series(data, dtype = 'float'), storage_capacity = -1, charge_efficiency = 1, discharge_efficiency = 1, output = False</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: If storage_capacity = -1, the storage size is calculated with the functicapacity(data).</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: data is concatenated twice to data_x2.</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: Based on the storage size, the state of charge and free capacity are calculated for all values of data for Year1 and all following years.</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: If output is False, a tuple of storage_capacity (float), state of charge Year1 (pd.Series), state of charge Year2 (pd.Series) is returned.</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: If output is True, the cumulative sum of the residual load, the storage size, the residual load curve, the states of charge and free capacities for Year1 and Year2 are returned.</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_annual_storage(data, storage_capacity <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, charge_efficiency <span class="op">=</span> <span class="dv">1</span>, discharge_efficiency <span class="op">=</span> <span class="dv">1</span>, output <span class="op">=</span> <span class="va">False</span>):</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  data_x2 <span class="op">=</span> pd.concat([data, data])</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> storage_capacity <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>    storage_capacity <span class="op">=</span> calculate_storage_capacity(data, charge_efficiency, discharge_efficiency) </span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>  annual_storage <span class="op">=</span> []</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>  storage_state <span class="op">=</span> []</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>  free_capacity <span class="op">=</span> storage_capacity <span class="co"># storage is empty </span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> data_x2:</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">&gt;</span> <span class="dv">0</span>: <span class="co"># residual load</span></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>      <span class="co"># demand without corresponding previous charging cannot be fully supplied, storage then empty</span></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (storage_capacity <span class="op">-</span> free_capacity) <span class="op">-</span> i <span class="op">/</span> discharge_efficiency <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>        free_capacity <span class="op">=</span> storage_capacity</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span>: <span class="co"># discharging</span></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>        free_capacity <span class="op">+=</span> i <span class="op">/</span> discharge_efficiency <span class="co"># here too much can be discharged</span></span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> free_capacity <span class="op">&gt;</span> storage_capacity:</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>          free_capacity <span class="op">=</span> storage_capacity</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>: <span class="co"># i &lt;= 0 renewable surplus</span></span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>      <span class="co"># if storage is full, surplus must be discarded</span></span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> free_capacity <span class="op">+</span> i <span class="op">*</span> charge_efficiency <span class="op">&lt;</span> <span class="dv">0</span>: </span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>        free_capacity <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span>: <span class="co"># charging</span></span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>        free_capacity <span class="op">+=</span> i <span class="op">*</span> charge_efficiency</span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a>    annual_storage.append(free_capacity)</span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a>    storage_state.append(storage_capacity <span class="op">-</span> free_capacity)</span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> output: <span class="co"># output = True</span></span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a>    dataset <span class="op">=</span> pd.DataFrame({<span class="st">'Residual load'</span>: data, <span class="st">'State of charge Year1'</span>: storage_state[ : <span class="bu">len</span>(annual_storage) <span class="op">//</span> <span class="dv">2</span> ], <span class="st">'Free capacity Year1'</span>: annual_storage[ : <span class="bu">len</span>(annual_storage) <span class="op">//</span> <span class="dv">2</span> ], <span class="st">'State of charge following years'</span>: storage_state[ <span class="bu">len</span>(annual_storage) <span class="op">//</span> <span class="dv">2</span> : ], <span class="st">'Free capacity following years'</span>: annual_storage[ <span class="bu">len</span>(annual_storage) <span class="op">//</span> <span class="dv">2</span> : ]})</span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Sum data: </span><span class="sc">{</span>data<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ch">\n</span><span class="ss">Storage size: </span><span class="sc">{</span>storage_capacity<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(dataset)</span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>: <span class="co"># output = False</span></span>
<span id="cb62-52"><a href="#cb62-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> storage_capacity, pd.Series(storage_state[ : <span class="bu">len</span>(annual_storage) <span class="op">//</span> <span class="dv">2</span> ]), pd.Series(storage_state[ <span class="bu">len</span>(annual_storage) <span class="op">//</span> <span class="dv">2</span> : ])</span>
<span id="cb62-53"><a href="#cb62-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-54"><a href="#cb62-54" aria-hidden="true" tabindex="-1"></a>storage_2023_eff_90_90 <span class="op">=</span> calculate_annual_storage(residual_load, charge_efficiency <span class="op">=</span> <span class="fl">0.9</span>, discharge_efficiency <span class="op">=</span> <span class="fl">0.9</span>, output <span class="op">=</span> <span class="va">False</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-13-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-5-tab">
<div id="0ddcd643" class="cell" data-execution_count="65">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-66-output-1.png" alt="The graphic shows the residual load for the year 2023. This is mostly positive and only negative at a few points during the year. Around the Christmas holidays, there is a longer period of negative residual load. In addition, the annual cycle of the storage with a charging and discharging efficiency of 0.9 is shown, storing all renewable production surpluses and discharging again during positive residual load. The interpretation of the annual cycle follows in the further text." width="744" height="569" class="figure-img"></p>
<figcaption>Residual load 2023 and annual cycle of a storage with charge and discharge efficiency 0.9</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-6-tab">
<div id="90c1131f" class="cell" data-execution_count="66">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>annual_storage_year1 <span class="op">=</span> storage_2023_eff_90_90[<span class="dv">1</span>]</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>annual_storage_year2 <span class="op">=</span> storage_2023_eff_90_90[<span class="dv">2</span>]</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create xticks</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>month_index <span class="op">=</span> generation[<span class="op">~</span>generation[<span class="st">"Datum von"</span>].dt.month.duplicated()].index</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>month_names <span class="op">=</span> generation[<span class="st">"Datum von"</span>].iloc[month_index].dt.strftime(<span class="st">"%B"</span>) </span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create graphic with three subplots</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>font_size <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2, ax3) <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, figsize <span class="op">=</span> (<span class="fl">7.5</span>, <span class="dv">6</span>), height_ratios <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>], sharex <span class="op">=</span> <span class="va">True</span>, layout <span class="op">=</span> <span class="st">'tight'</span>)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Residual load 2023 and annual cycle of a storage with charge and discharge efficiency 0.9'</span>)</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>plt.xticks(month_index, month_names, rotation <span class="op">=</span> <span class="dv">45</span>)<span class="op">;</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>plt.minorticks_off()</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>plt.setp([ax1, ax2, ax3], xlim <span class="op">=</span> (residual_load.index.<span class="bu">min</span>() <span class="op">-</span> <span class="bu">len</span>(residual_load.index) <span class="op">/</span> <span class="dv">100</span>, residual_load.index.<span class="bu">max</span>() <span class="op">*</span> <span class="fl">1.01</span>))</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>plt.setp([ax2, ax3], ylim <span class="op">=</span> (<span class="dv">0</span>, <span class="bu">max</span>(<span class="bu">max</span>(annual_storage_year1), <span class="bu">max</span>(annual_storage_year2)) <span class="op">*</span> <span class="fl">1.1</span>))</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a><span class="co">## plot residual load</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>ax1.plot(residual_load, label <span class="op">=</span> <span class="st">"Residual load"</span>)</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>ax1.grid()</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'MWh'</span>)</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>ax1.legend()</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a><span class="co">## plot annual_storage_year1</span></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>ax2.plot(annual_storage_year1, color <span class="op">=</span> <span class="st">'black'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>, label <span class="op">=</span> <span class="st">'Battery Year 1'</span>)</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>ax2.grid()</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'MWh'</span>)</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>ax2.legend()</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a><span class="co">## plot annual_storage_year2</span></span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>ax3.plot(annual_storage_year2, color <span class="op">=</span> <span class="st">'black'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>, label <span class="op">=</span> <span class="st">'Battery Year 2'</span>)</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>ax3.tick_params(axis <span class="op">=</span> <span class="st">'x'</span>, rotation <span class="op">=</span> <span class="dv">45</span>)</span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">'MWh'</span>)</span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>ax3.grid()</span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>ax3.legend()</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
<p>The required storage capacity results from the renewable generation surpluses during the Christmas holidays. These capacities are hardly used during the rest of the year, so the storage remains empty most of the time. The annual profile for the first and second year is visually identical. This can easily be checked with <code>pd.Series1.equals(pd.Series2)</code>. If charging and discharging efficiencies are considered, the charged and discharged energy – and thus the required storage capacity – are reduced.</p>
</section>
<section id="calculate-number-of-cycles" class="level4">
<h4 class="anchored" data-anchor-id="calculate-number-of-cycles">Calculate number of cycles</h4>
<p>Based on the storage size and the annual profile of the storage, the number of cycles can be calculated for the first year and for all subsequent years. One cycle corresponds to a complete charge and discharge of the storage or an equivalent number of partial charge cycles. The number of cycles therefore results from the sum of the charged and discharged energy in the annual profile of the storage, divided by the storage size and by 2.</p>
<ul>
<li><p><strong>Input:</strong> The function can be provided with a tuple consisting of a storage size at position 0 and storage annual profiles for year 1 and year 2 at positions 1 and 2. Otherwise, these are determined by calling the function <code>calculate_storage_annual_profile</code> (without or with charging and discharging efficiency).</p></li>
<li><p><strong>Processing:</strong> To determine the charged and discharged energy, the method <code>pd.Series.diff()</code> is used for the storage annual profiles to compute the element-wise difference of each value to its predecessor (sliding difference). For example, for the sequence <code>1, 4, -6, 2</code>, the element-wise difference is <code>NaN, 3, -10, 8</code>. Since the first value has no predecessor, the difference is NaN. Therefore, a zero is prepended to the annual profile in year 1 (because the storage starts empty when connected to the grid), and for year 2 the last value from year 1 is prepended (because the storage starts into the second year with that charge level). The sequence for year 2 would then look like this: <code>2, 1, 4, -6, 2</code>. The element-wise difference would be: <code>NaN, -1, 3, -10, 8</code>. Afterwards, the values are converted to absolute values and summed. The instruction is thus: <code>pd.Series.diff().abs().sum()</code>. To calculate the number of cycles, the sum of the charged and discharged energy is divided by the storage size and by 2.</p></li>
<li><p><strong>Output:</strong> If <code>output = False</code>, the function returns a tuple with the number of cycles for year 1 and year 2. If <code>output = True</code>, the output is printed using <code>print()</code>.</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true" href="">without efficiency</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false" href="">with Efficiency</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div id="6203430f" class="cell" data-execution_count="67">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate number of cycles</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Input: data = pd.Series(data, dtype='float'), output = False</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Input: If the input is a tuple {'storage_capacity': float, 'storage_profile_year1': pd.Series, 'storage_profile_year2': pd.Series}, the number of cycles is calculated directly.</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Input: If the input is data = pd.Series(data, dtype='float'), then storage_profile_calculate(data, storage_capacity = -1, output = False) is called.</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: Element-wise, for year 1 and year 2, the difference between consecutive values is computed, absolute values are taken, and summed.</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: For sliding difference calculation, a zero must be prepended to the profile in year 1, and the last value from year 1 must be prepended to the profile in year 2.</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: The sum of storage charging and discharging is divided by the storage capacity and by 2.</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: Number of cycles for year 1 and year 2 – if output = False, returned as a tuple; if output = True, printed.</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cycles(data, output <span class="op">=</span> <span class="va">False</span>):</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="bu">type</span>(data) <span class="kw">is</span> <span class="bu">tuple</span>: <span class="co"># storage capacity and profiles were provided</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>    storage_capacity <span class="op">=</span> data[<span class="dv">0</span>]</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>    storage_profile_year1 <span class="op">=</span> data[<span class="dv">1</span>]</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>    storage_profile_year2 <span class="op">=</span> data[<span class="dv">2</span>]</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>: <span class="co"># residual load was provided</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> storage_profile_calculate(data, storage_capacity <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, output <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>    storage_capacity <span class="op">=</span> result[<span class="dv">0</span>]</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>    storage_profile_year1 <span class="op">=</span> result[<span class="dv">1</span>]</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>    storage_profile_year2 <span class="op">=</span> result[<span class="dv">2</span>]</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepend a zero to year 1 profile, prepend the last value of year 1 to year 2 profile</span></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>  storage_profile_year1 <span class="op">=</span> pd.concat([pd.Series(<span class="dv">0</span>), storage_profile_year1])</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>  storage_profile_year2 <span class="op">=</span> pd.concat([storage_profile_year1[<span class="op">-</span><span class="dv">1</span>:], storage_profile_year2])</span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate number of cycles</span></span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>  cycles_year1 <span class="op">=</span> storage_profile_year1.diff().<span class="bu">abs</span>().<span class="bu">sum</span>() <span class="op">/</span> (storage_capacity <span class="op">*</span> <span class="dv">2</span>) <span class="co"># one cycle = full charge and discharge --&gt; divide by 2</span></span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>  cycles_year2 <span class="op">=</span> storage_profile_year2.diff().<span class="bu">abs</span>().<span class="bu">sum</span>() <span class="op">/</span> (storage_capacity <span class="op">*</span> <span class="dv">2</span>) <span class="co"># one cycle = full charge and discharge --&gt; divide by 2</span></span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> output:</span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Number of cycles year 1: </span><span class="sc">{</span>cycles_year1<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>          <span class="ss">f"Number of cycles year 2: </span><span class="sc">{</span>cycles_year2<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycles_year1, cycles_year2</span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a>calculate_cycles(storage_2023, output <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of cycles year 1: 8.38
Number of cycles year 2: 8.38</code></pre>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div id="7c0cb319" class="cell" data-execution_count="68">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate number of cycles with efficiency</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Input: data = pd.Series(data, dtype = 'float'), charge_efficiency = 1, discharge_efficiency = 1, output = False</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Input: If the input is a tuple {'storage_capacity': float, 'storage_profile_year1': pd.Series, 'storage_profile_year2': pd.Series}, the number of cycles is calculated directly.</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Input: If the input is data = pd.Series(data, dtype = 'float'), then calculate_annual_storage(data, storage_capacity = -1, charge_efficiency = 1, discharge_efficiency = 1, output = False) is called.</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: For year 1 and year 2, the element-wise difference of consecutive values is computed, taken as absolute, and summed.</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: For the sliding difference calculation, prepend a zero to the storage profile in year 1, and prepend the last value from year 1 to the storage profile of year 2.</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: The sum of storage charging and discharging is divided by the storage capacity and then by 2.</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: Number of cycles for year 1 and year 2 – if output = False as return value (tuple), if output = True via print()</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cycles(data, charge_efficiency <span class="op">=</span> <span class="dv">1</span>, discharge_efficiency <span class="op">=</span> <span class="dv">1</span>, output <span class="op">=</span> <span class="va">False</span>):</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="bu">type</span>(data) <span class="kw">is</span> <span class="bu">tuple</span>: <span class="co"># storage capacity and storage profiles were passed</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>    storage_capacity <span class="op">=</span> data[<span class="dv">0</span>]</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>    storage_profile_year1 <span class="op">=</span> data[<span class="dv">1</span>]</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>    storage_profile_year2 <span class="op">=</span> data[<span class="dv">2</span>]</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>: <span class="co"># residual load was passed</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> calculate_annual_storage(data, storage_capacity <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, charge_efficiency <span class="op">=</span> charge_efficiency, discharge_efficiency <span class="op">=</span> discharge_efficiency, output <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>    storage_capacity <span class="op">=</span> result[<span class="dv">0</span>]</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>    storage_profile_year1 <span class="op">=</span> result[<span class="dv">1</span>]</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>    storage_profile_year2 <span class="op">=</span> result[<span class="dv">2</span>]</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prepend zero to storage profile year 1, prepend last value from year 1 to storage profile year 2</span></span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>  storage_profile_year1 <span class="op">=</span> pd.concat([pd.Series(<span class="dv">0</span>), storage_profile_year1])</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>  storage_profile_year2 <span class="op">=</span> pd.concat([storage_profile_year1[ <span class="op">-</span> <span class="dv">1</span>: ], storage_profile_year2])</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate number of cycles  </span></span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>  cycles_year1 <span class="op">=</span> storage_profile_year1.diff().<span class="bu">abs</span>().<span class="bu">sum</span>() <span class="op">/</span> (storage_capacity <span class="op">*</span> <span class="dv">2</span>) <span class="co"># one cycle = full charge and discharge --&gt; divide by 2</span></span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>  cycles_year2 <span class="op">=</span> storage_profile_year2.diff().<span class="bu">abs</span>().<span class="bu">sum</span>() <span class="op">/</span> (storage_capacity <span class="op">*</span> <span class="dv">2</span>) <span class="co"># one cycle = full charge and discharge --&gt; divide by 2</span></span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> output:</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Number of cycles year 1: </span><span class="sc">{</span>cycles_year1<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>          <span class="ss">f"Number of cycles year 2: </span><span class="sc">{</span>cycles_year2<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycles_year1, cycles_year2</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>calculate_cycles(residual_load, charge_efficiency <span class="op">=</span> <span class="fl">0.9</span>, discharge_efficiency <span class="op">=</span> <span class="fl">0.9</span>, output <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of cycles year 1: 8.79
Number of cycles year 2: 8.79</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Due to the low renewable generation surpluses in 2023, the number of cycles in Year 1 and Year 2 is identical. When efficiency is considered, the number of cycles increases because the storage size is smaller.</p>
</section>
</section>
<section id="capping" class="level3">
<h3 class="anchored" data-anchor-id="capping">Capping</h3>
<div class="quarto-layout-panel" data-layout="[50, 50]">
<div class="quarto-layout-row">
<div id="bc864474" class="cell quarto-layout-cell" data-execution_count="69" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-70-output-1.png" alt="In two graphics, two simplified residual load curves consisting of four bars each are shown over the course of the year. The x-axis shows the 365 days of the year, the y-axis shows the residual load from minus 1 to 1. In the upper graphic, the yearly course of storage without capping of generation peaks is shown. In the first quarter of the year, the residual load is negative at minus 1. The first bar is colored and shaded with an upward-sloping hatch. The coloring indicates the required storage size, the upward hatching the charging phase. In the second quarter, the residual load is positive at 1, and the discharging is indicated by a downward hatching. In the third and fourth quarters, phases of charging and discharging occur at minus and plus 0.5, respectively, and are shaded accordingly. In this way, 1.5 charging and discharging cycles are realized. In the lower graphic, the same yearly course is shown, but the storage size is limited to 0.5. In the first quarter with a residual load of -1, only -0.5 is stored. This is represented by coloring and upward hatching of the area between 0 and 0.5. The area between -0.5 and -1 is left white and unmarked. This surplus electricity is not stored. Similarly, in the second quarter, the residual load of 1 is only half covered by the storage. The residual load in the range from 0.5 to 1 must be supplied by load-following power plants. The subsequent charging and discharging phases in the third and fourth quarters correspond to residual loads of minus and plus 0.5. The storage limited to 0.5 thus achieves 2 charging and discharging cycles." width="567" height="471" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<dl>
<dt>Capping of Generation Peaks</dt>
<dd>
Capping of generation peaks is a way to reduce the required storage size. Limiting the charging leads to better utilization of storage capacity and a higher number of cycles.
</dd>
<dd>
In the upper example, the storage size is dimensioned according to the maximum renewable surplus production. The storage thus reaches 1.5 cycles.
</dd>
<dd>
In the lower example, the storage is dimensioned smaller. The storage reaches 2 cycles.
</dd>
</dl>
</div>
</div>
</div>
<section id="calculation-2" class="level4">
<h4 class="anchored" data-anchor-id="calculation-2">Calculation</h4>
<p>Based on the annual profile of the storage, the effect of capping generation peaks on the stored electricity amount and the achieved number of storage cycles can be calculated. For this purpose, the annual profile of the storage is computed for various reduced storage sizes, along with the achieved cycle number and the amount of electricity not stored.</p>
<ul>
<li><p>Input: The function is given a residual load data series as a <code>pd.Series</code> and optionally a list of reduced storage sizes, expressed as relative fractions of 1. If no list is provided, the calculation is performed for the relative storage sizes [0.9, 0.8, 0.7, 0.6, 0.5].</p></li>
<li><p>Processing: For the residual load, the uncapped storage size and annual profiles in year 1 and year 2 are calculated by calling the function <code>calculate_storage_annual_profile</code>. Then the achieved cycle number is determined by calling the function <code>calculate_cycles</code>. Based on the annual profiles, the stored electricity amount is calculated. For this, the method <code>pd.Series.diff()</code> is used to compute the elementwise difference between each value and its predecessor (sliding difference). As with the cycle calculation, a zero is prepended to the annual profile in year 1, and the last value of year 1 is prepended to year 2. The stored electricity amount is the sum of all positive values in this series. Negative values indicate a reduction of the charge between two points in time, i.e.&nbsp;discharging phases. Therefore, negative values are set to zero with the <code>.clip</code> method. The instruction is: <code>pd.Series.diff().clip(lower = 0).sum()</code>.<br>
These steps are repeated for all elements in the variable <code>new_storage_capacitys</code>. For this, the uncapped storage size is multiplied by one of the relative storage sizes, and the achieved cycle number as well as the stored electricity amount are calculated. From the difference of the stored electricity amount for each new storage size compared to the baseline year, the capped electricity amount is determined.</p></li>
<li><p>Output: If <code>output = False</code>, a DataFrame with three columns is returned. The column with index 0 contains the relative storage size, columns 1 and 2 contain the capped electricity amounts in year 1 and year 2. If <code>output = True</code>, this DataFrame is printed with <code>print()</code>. Additionally, a five-column DataFrame with the intermediate results (including the baseline year in row 0) is printed. This contains in the column with index 0 the absolute storage size, and in the following columns the stored electricity amount in year 1 (column with index 1), the cycle number in year 1 (column with index 2), the stored electricity amount in year 2 (column with index 3), and the cycle number in year 2 (column with index 4).</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true" href="">without efficiency</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false" href="">with Efficiency</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div id="d4ca189d" class="cell" data-execution_count="70">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Curtailment calculation: How much renewable energy (RE) is discarded when storage size is limited?</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Input: Residual load curve data = pd.Series(data, dtype='float', new_storage_capacitys = [0.9, 0.8, 0.7, 0.6, 0.5], output = False)</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: For data, the function calculate_annual_storage() determines the storage size and the storage profiles for Year 1 and Year 2 without additional curtailment</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: For data, the function calculate_cycles() determines the number of cycles in Year 1 and Year 2 without additional curtailment</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: Based on the storage profiles, the stored electricity amount without additional curtailment is determined</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: The processing steps are repeated for all elements provided in the variable new_storage_capacitys</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: The storage size of the base residual load curve data is multiplied by the values provided in new_storage_capacitys</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: From the difference between the stored electricity amounts for each new storage size and the base year, the curtailed electricity amount is determined</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: If output = False, a DataFrame with three columns is returned. Column with index 0 contains the relative storage size, Columns 1 and 2 contain the curtailed electricity amounts in Year 1 and Year 2.</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: If output = True, the three-column DataFrame is printed using print().</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: Additionally, a five-column DataFrame with intermediate results (including base year) is printed.</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: (Index information): 0 = absolute storage size, 1 = stored electricity Year 1, 2 = cycle number Year 1, 3 = stored electricity Year 2, 4 = cycle number Year 2</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_curtailment_effect(data, new_storage_capacitys <span class="op">=</span> [<span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.6</span>, <span class="fl">0.5</span>], output <span class="op">=</span> <span class="va">False</span>):</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determine base year storage size</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>  result <span class="op">=</span> calculate_annual_storage(data, storage_capacity <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, output <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>  storage_capacity0 <span class="op">=</span> result[<span class="dv">0</span>]</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>  storage_profile_year1 <span class="op">=</span> result[<span class="dv">1</span>]</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>  storage_profile_year2 <span class="op">=</span> result[<span class="dv">2</span>]</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determine number of cycles in base year, pass tuple</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>  cycles <span class="op">=</span> calculate_cycles(result, output <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>  cycles_year1 <span class="op">=</span> cycles[<span class="dv">0</span>]</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>  cycles_year2 <span class="op">=</span> cycles[<span class="dv">1</span>]</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a zero in front of storage profile Year 1, append last value of Year 1 to Year 2</span></span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>  storage_profile_year1 <span class="op">=</span> pd.concat([pd.Series([<span class="dv">0</span>]), storage_profile_year1])</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>  storage_profile_year2 <span class="op">=</span> pd.concat([storage_profile_year1[<span class="op">-</span><span class="dv">1</span>:], storage_profile_year2])</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determine stored electricity in base year</span></span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>  storage_amount_year1 <span class="op">=</span> storage_profile_year1.diff().clip(lower <span class="op">=</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>  storage_amount_year2 <span class="op">=</span> storage_profile_year2.diff().clip(lower <span class="op">=</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save results in DataFrame</span></span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>  dataframe <span class="op">=</span> pd.DataFrame({<span class="st">'Storage size'</span>: [storage_capacity0], <span class="st">'Storage amount Year1'</span>: [storage_amount_year1], <span class="st">'Cycles Year1'</span>: cycles_year1, <span class="st">'Storage amount Year2'</span>: [storage_amount_year2], <span class="st">'Cycles Year2'</span>: cycles_year2})</span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determine stored electricity with alternative storage sizes</span></span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a>  count <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(new_storage_capacitys)):</span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a>    storage_capacity_new <span class="op">=</span> storage_capacity0 <span class="op">*</span> new_storage_capacitys[i]</span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> calculate_annual_storage(data, storage_capacity <span class="op">=</span> storage_capacity_new, output <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a>    storage_profile_year1 <span class="op">=</span> result[<span class="dv">1</span>]</span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a>    storage_profile_year2 <span class="op">=</span> result[<span class="dv">2</span>]</span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine number of cycles in base year, pass tuple</span></span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a>    cycles <span class="op">=</span> calculate_cycles(result, output <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a>    cycles_year1 <span class="op">=</span> cycles[<span class="dv">0</span>]</span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a>    cycles_year2 <span class="op">=</span> cycles[<span class="dv">1</span>]</span>
<span id="cb68-53"><a href="#cb68-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-54"><a href="#cb68-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add a zero in front of storage profile Year 1, append last value of Year 1 to Year 2</span></span>
<span id="cb68-55"><a href="#cb68-55" aria-hidden="true" tabindex="-1"></a>    storage_profile_year1 <span class="op">=</span> pd.concat([pd.Series([<span class="dv">0</span>]), storage_profile_year1])</span>
<span id="cb68-56"><a href="#cb68-56" aria-hidden="true" tabindex="-1"></a>    storage_profile_year2 <span class="op">=</span> pd.concat([storage_profile_year1[<span class="op">-</span><span class="dv">1</span>:], storage_profile_year2])</span>
<span id="cb68-57"><a href="#cb68-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-58"><a href="#cb68-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine stored electricity with new storage size</span></span>
<span id="cb68-59"><a href="#cb68-59" aria-hidden="true" tabindex="-1"></a>    storage_amount_year1 <span class="op">=</span> storage_profile_year1.diff().clip(lower <span class="op">=</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span>
<span id="cb68-60"><a href="#cb68-60" aria-hidden="true" tabindex="-1"></a>    storage_amount_year2 <span class="op">=</span> storage_profile_year2.diff().clip(lower <span class="op">=</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span>
<span id="cb68-61"><a href="#cb68-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-62"><a href="#cb68-62" aria-hidden="true" tabindex="-1"></a>    new_row <span class="op">=</span> [storage_capacity_new, storage_amount_year1, cycles_year1, storage_amount_year2, cycles_year2]</span>
<span id="cb68-63"><a href="#cb68-63" aria-hidden="true" tabindex="-1"></a>    dataframe.loc[count] <span class="op">=</span> new_row</span>
<span id="cb68-64"><a href="#cb68-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-65"><a href="#cb68-65" aria-hidden="true" tabindex="-1"></a>    count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb68-66"><a href="#cb68-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-67"><a href="#cb68-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate curtailed amount data.sub(data[0]).drop(0)</span></span>
<span id="cb68-68"><a href="#cb68-68" aria-hidden="true" tabindex="-1"></a>  curtailed_storage_year1 <span class="op">=</span> dataframe[<span class="st">'Storage amount Year1'</span>].sub(dataframe[<span class="st">'Storage amount Year1'</span>][<span class="dv">0</span>]).<span class="bu">abs</span>().drop(<span class="dv">0</span>).reset_index(drop <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb68-69"><a href="#cb68-69" aria-hidden="true" tabindex="-1"></a>  curtailed_storage_year2 <span class="op">=</span> dataframe[<span class="st">'Storage amount Year2'</span>].sub(dataframe[<span class="st">'Storage amount Year2'</span>][<span class="dv">0</span>]).<span class="bu">abs</span>().drop(<span class="dv">0</span>).reset_index(drop <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb68-70"><a href="#cb68-70" aria-hidden="true" tabindex="-1"></a>  dataset <span class="op">=</span> pd.DataFrame({<span class="st">'Relative storage size'</span>: pd.Series(new_storage_capacitys), <span class="st">'Curtailed storage Year1'</span>: curtailed_storage_year1, <span class="st">'Curtailed storage Year2'</span>: curtailed_storage_year2})</span>
<span id="cb68-71"><a href="#cb68-71" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-72"><a href="#cb68-72" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> output:</span>
<span id="cb68-73"><a href="#cb68-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-74"><a href="#cb68-74" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(dataframe)</span>
<span id="cb68-75"><a href="#cb68-75" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb68-76"><a href="#cb68-76" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(dataset)</span>
<span id="cb68-77"><a href="#cb68-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-78"><a href="#cb68-78" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb68-79"><a href="#cb68-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dataset</span>
<span id="cb68-80"><a href="#cb68-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-81"><a href="#cb68-81" aria-hidden="true" tabindex="-1"></a>calculate_curtailment_effect(residual_load, output <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Storage size  Storage amount Year1  Cycles Year1  Storage amount Year2  \
0      119667.0              1.00e+06          8.38              1.00e+06   
1      107700.3              9.91e+05          9.20              9.91e+05   
2       95733.6              9.79e+05         10.23              9.79e+05   
3       83766.9              9.63e+05         11.49              9.63e+05   
4       71800.2              9.39e+05         13.07              9.39e+05   
5       59833.5              8.99e+05         15.03              8.99e+05   

   Cycles Year2  
0          8.38  
1          9.20  
2         10.23  
3         11.49  
4         13.07  
5         15.03  


   Relative storage size  Curtailed storage Year1  Curtailed storage Year2
0                    0.9                  11966.7                  11966.7
1                    0.8                  23933.4                  23933.4
2                    0.7                  40443.7                  40443.7
3                    0.6                  64377.1                  64377.1
4                    0.5                 103619.5                 103619.5</code></pre>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div id="2a4ba431" class="cell" data-execution_count="71">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate curtailment: How much renewable energy is discarded when storage size is limited?</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Input: Residual load curve data = pd.Series(data, dtype = 'float', charge_efficiency = 1, discharge_efficiency = 1, new_storage_capacitys = [0.9, 0.8, 0.7, 0.6, 0.5], output = False)</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: For data, the function calculate_annual_storage() determines the storage size and the annual profiles for Year 1 and Year 2 without additional curtailment</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: For data, the function calculate_cycles() determines the number of cycles in Year 1 and Year 2 without additional curtailment</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: Based on the annual profiles, the stored electricity amount without additional curtailment is determined</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: These steps are repeated for all elements passed in the variable new_storage_capacitys</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: The storage size of the base residual load curve data is multiplied by the values passed in new_storage_capacitys</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: From the difference between stored electricity for each new storage size and the base year, the curtailed electricity is determined</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: If output = False a DataFrame with three columns is returned. Column 0 contains the relative storage size, columns 1 and 2 contain the curtailed electricity in Year 1 and Year 2.</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: If output = True the three-column DataFrame is printed with print().</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: Additionally, a five-column DataFrame with intermediate results (including the base year) is printed with print().</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: (Index references): 0 = absolute storage size, 1 = stored electricity Year 1, 2 = cycles Year 1, 3 = stored electricity Year 2, 4 = cycles Year 2</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_curtailment_effect(data, charge_efficiency <span class="op">=</span> <span class="dv">1</span>, discharge_efficiency <span class="op">=</span> <span class="dv">1</span>, new_storage_capacitys <span class="op">=</span> [<span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.6</span>, <span class="fl">0.5</span>], output <span class="op">=</span> <span class="va">False</span>):</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determine storage size in the base year</span></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>  result <span class="op">=</span> calculate_annual_storage(data, storage_capacity <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, charge_efficiency <span class="op">=</span> charge_efficiency, discharge_efficiency <span class="op">=</span> discharge_efficiency, output <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>  base_storage_capacity <span class="op">=</span> result[<span class="dv">0</span>]</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>  storage_profile_year1 <span class="op">=</span> result[<span class="dv">1</span>]</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>  storage_profile_year2 <span class="op">=</span> result[<span class="dv">2</span>]</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determine number of cycles in the base year, pass tuple</span></span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>  cycles <span class="op">=</span> calculate_cycles(result, charge_efficiency <span class="op">=</span> charge_efficiency, discharge_efficiency <span class="op">=</span> discharge_efficiency, output <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>  cycles_year1 <span class="op">=</span> cycles[<span class="dv">0</span>]</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>  cycles_year2 <span class="op">=</span> cycles[<span class="dv">1</span>]</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepend zero to annual profile Year 1, add last value of Year 1 to start of Year 2</span></span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>  storage_profile_year1 <span class="op">=</span> pd.concat([pd.Series([<span class="dv">0</span>]), storage_profile_year1])</span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>  storage_profile_year2 <span class="op">=</span> pd.concat([storage_profile_year1[ <span class="op">-</span> <span class="dv">1</span>: ], storage_profile_year2])</span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determine stored electricity in the base year</span></span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>  storage_year1 <span class="op">=</span> storage_profile_year1.diff().clip(lower <span class="op">=</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>  storage_year2 <span class="op">=</span> storage_profile_year2.diff().clip(lower <span class="op">=</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save results in DataFrame</span></span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a>  dataframe <span class="op">=</span> pd.DataFrame({<span class="st">'Storage size'</span>: [base_storage_capacity], <span class="st">'Storage Year1'</span>: [storage_year1], <span class="st">'Cycles Year1'</span>: cycles_year1, <span class="st">'Storage Year2'</span>: [storage_year2], <span class="st">'Cycles Year2'</span>: cycles_year2})</span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determine stored electricity for alternative storage sizes</span></span>
<span id="cb70-39"><a href="#cb70-39" aria-hidden="true" tabindex="-1"></a>  count <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb70-40"><a href="#cb70-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-41"><a href="#cb70-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(new_storage_capacitys)):</span>
<span id="cb70-42"><a href="#cb70-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-43"><a href="#cb70-43" aria-hidden="true" tabindex="-1"></a>    new_storage_capacity <span class="op">=</span> base_storage_capacity <span class="op">*</span> new_storage_capacitys[i]</span>
<span id="cb70-44"><a href="#cb70-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb70-45"><a href="#cb70-45" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> calculate_annual_storage(data, storage_capacity <span class="op">=</span> new_storage_capacity, charge_efficiency <span class="op">=</span> charge_efficiency, discharge_efficiency <span class="op">=</span> discharge_efficiency, output <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb70-46"><a href="#cb70-46" aria-hidden="true" tabindex="-1"></a>    storage_profile_year1 <span class="op">=</span> result[<span class="dv">1</span>]</span>
<span id="cb70-47"><a href="#cb70-47" aria-hidden="true" tabindex="-1"></a>    storage_profile_year2 <span class="op">=</span> result[<span class="dv">2</span>]</span>
<span id="cb70-48"><a href="#cb70-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-49"><a href="#cb70-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine number of cycles for new storage size</span></span>
<span id="cb70-50"><a href="#cb70-50" aria-hidden="true" tabindex="-1"></a>    cycles <span class="op">=</span> calculate_cycles(result, charge_efficiency <span class="op">=</span> charge_efficiency, discharge_efficiency <span class="op">=</span> discharge_efficiency, output <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb70-51"><a href="#cb70-51" aria-hidden="true" tabindex="-1"></a>    cycles_year1 <span class="op">=</span> cycles[<span class="dv">0</span>]</span>
<span id="cb70-52"><a href="#cb70-52" aria-hidden="true" tabindex="-1"></a>    cycles_year2 <span class="op">=</span> cycles[<span class="dv">1</span>]</span>
<span id="cb70-53"><a href="#cb70-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-54"><a href="#cb70-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prepend zero to annual profile Year 1, add last value of Year 1 to start of Year 2</span></span>
<span id="cb70-55"><a href="#cb70-55" aria-hidden="true" tabindex="-1"></a>    storage_profile_year1 <span class="op">=</span> pd.concat([pd.Series([<span class="dv">0</span>]), storage_profile_year1])</span>
<span id="cb70-56"><a href="#cb70-56" aria-hidden="true" tabindex="-1"></a>    storage_profile_year2 <span class="op">=</span> pd.concat([storage_profile_year1[ <span class="op">-</span> <span class="dv">1</span>: ], storage_profile_year2])</span>
<span id="cb70-57"><a href="#cb70-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-58"><a href="#cb70-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine stored electricity for new storage size</span></span>
<span id="cb70-59"><a href="#cb70-59" aria-hidden="true" tabindex="-1"></a>    storage_year1 <span class="op">=</span> storage_profile_year1.diff().clip(lower <span class="op">=</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span>
<span id="cb70-60"><a href="#cb70-60" aria-hidden="true" tabindex="-1"></a>    storage_year2 <span class="op">=</span> storage_profile_year2.diff().clip(lower <span class="op">=</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span>
<span id="cb70-61"><a href="#cb70-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-62"><a href="#cb70-62" aria-hidden="true" tabindex="-1"></a>    new_row <span class="op">=</span> [new_storage_capacity, storage_year1, cycles_year1, storage_year2, cycles_year2]</span>
<span id="cb70-63"><a href="#cb70-63" aria-hidden="true" tabindex="-1"></a>    dataframe.loc[count] <span class="op">=</span> new_row</span>
<span id="cb70-64"><a href="#cb70-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-65"><a href="#cb70-65" aria-hidden="true" tabindex="-1"></a>    count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb70-66"><a href="#cb70-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-67"><a href="#cb70-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate curtailed amounts data.sub(data[0]).drop(0)</span></span>
<span id="cb70-68"><a href="#cb70-68" aria-hidden="true" tabindex="-1"></a>  curtailed_storage_year1 <span class="op">=</span> dataframe[<span class="st">'Storage Year1'</span>].sub(dataframe[<span class="st">'Storage Year1'</span>][<span class="dv">0</span>]).<span class="bu">abs</span>().drop(<span class="dv">0</span>).reset_index(drop <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb70-69"><a href="#cb70-69" aria-hidden="true" tabindex="-1"></a>  curtailed_storage_year2 <span class="op">=</span> dataframe[<span class="st">'Storage Year2'</span>].sub(dataframe[<span class="st">'Storage Year2'</span>][<span class="dv">0</span>]).<span class="bu">abs</span>().drop(<span class="dv">0</span>).reset_index(drop <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb70-70"><a href="#cb70-70" aria-hidden="true" tabindex="-1"></a>  dataset <span class="op">=</span> pd.DataFrame({<span class="st">'Relative storage size'</span>: pd.Series(new_storage_capacitys), <span class="st">'Curtailed storage Year1'</span>: curtailed_storage_year1, <span class="st">'Curtailed storage Year2'</span>: curtailed_storage_year2})</span>
<span id="cb70-71"><a href="#cb70-71" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-72"><a href="#cb70-72" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> output:</span>
<span id="cb70-73"><a href="#cb70-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-74"><a href="#cb70-74" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(dataframe)</span>
<span id="cb70-75"><a href="#cb70-75" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb70-76"><a href="#cb70-76" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(dataset)</span>
<span id="cb70-77"><a href="#cb70-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-78"><a href="#cb70-78" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb70-79"><a href="#cb70-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dataset</span>
<span id="cb70-80"><a href="#cb70-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-81"><a href="#cb70-81" aria-hidden="true" tabindex="-1"></a>calculate_curtailment_effect(residual_load, charge_efficiency <span class="op">=</span> <span class="fl">0.9</span>, discharge_efficiency <span class="op">=</span> <span class="fl">0.9</span>, output <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Storage size  Storage Year1  Cycles Year1  Storage Year2  Cycles Year2
0     102674.54      902678.40          8.79      902678.40          8.79
1      92407.08      892410.95          9.66      892410.95          9.66
2      82139.63      882143.49         10.74      882143.49         10.74
3      71872.18      864601.21         12.03      864601.21         12.03
4      61604.72      844066.30         13.70      844066.30         13.70
5      51337.27      799701.77         15.58      799701.77         15.58


   Relative storage size  Curtailed storage Year1  Curtailed storage Year2
0                    0.9                 10267.45                 10267.45
1                    0.8                 20534.91                 20534.91
2                    0.7                 38077.19                 38077.19
3                    0.6                 58612.10                 58612.10
4                    0.5                102976.63                102976.63</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="determine-share-of-renewable-electricity-generation" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="determine-share-of-renewable-electricity-generation"><span class="header-section-number">7.4</span> Determine Share of Renewable Electricity Generation</h2>
<p>By integrating an electricity storage system into the power grid, excess renewable generation can be shifted to periods with a positive residual load that would otherwise need to be met by conventional power plants. This reduces the share of conventional electricity generation and increases the share of renewable electricity generation.</p>
<div class="quarto-layout-panel" data-layout="[50, 50]">
<div class="quarto-layout-row">
<div id="2c63093d" class="cell quarto-layout-cell" data-execution_count="72" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-73-output-1.png" alt="Two charts show a simplified residual load curve over the year consisting of two bars. The x-axis represents the 365 days of the year, and the y-axis shows the residual load from minus 1 to 1. In the first half of the year, the residual load is negative at minus 0.5; in the second half of the year, it is positive at 1. This is represented by one bar for each value. The first bar with negative values is colored and hatched from bottom left to top right, indicating the required storage capacity and the charging phase. The second bar with positive values is hatched from top left to bottom right up to 0.5, representing the discharging phase, while the area from 0.5 to 1 is left unfilled, corresponding to the residual load served by conventional power plants." width="573" height="452" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<dl>
<dt>Determine Share of Renewable Electricity Production</dt>
<dd>
Storing electricity reduces the positive residual load.
</dd>
<dd>
If the stored electricity is subtracted from the positive residual load (either cumulatively or annually), the share of load that must be covered conventionally corresponds to the quotient of summed positive residual load and summed grid load, or the quotient of summed positive residual load and total electricity generation.
</dd>
<dd>
The share of renewable electricity production is 1 minus the share of load that must be covered conventionally.
</dd>
</dl>
</div>
</div>
</div>
<p>The share of renewable electricity production can therefore be calculated as follows:</p>
<div id="82d51c40" class="cell" data-execution_count="73">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>residual_load.clip(lower <span class="op">=</span> <span class="dv">0</span>).<span class="bu">sum</span>() <span class="op">/</span> consumption[<span class="st">'Gesamt (Netzlast) [MWh]'</span>].<span class="bu">sum</span>()</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sum of positive residual load [MWh]: </span><span class="sc">{</span>residual_load<span class="sc">.</span>clip(lower <span class="op">=</span> <span class="dv">0</span>)<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Sum of grid load: </span><span class="sc">{</span>consumption[<span class="st">'Gesamt (Netzlast) [MWh]'</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Quotient positive residual load / grid load: </span><span class="sc">{</span>residual_load<span class="sc">.</span>clip(lower <span class="op">=</span> <span class="dv">0</span>)<span class="sc">.</span><span class="bu">sum</span>() <span class="op">/</span> consumption[<span class="st">'Gesamt (Netzlast) [MWh]'</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Share of renewable generation: </span><span class="sc">{</span> ( renewable_share <span class="op">:=</span> <span class="dv">1</span> <span class="op">-</span> (residual_load.clip(lower <span class="op">=</span> <span class="dv">0</span>).<span class="bu">sum</span>() <span class="op">/</span> consumption[<span class="st">'Gesamt (Netzlast) [MWh]'</span>].<span class="bu">sum</span>()) ) <span class="sc">:,.2f}</span><span class="ch">\n\n</span><span class="ss">"</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Sum of generation: </span><span class="sc">{</span>generation<span class="sc">.</span><span class="bu">sum</span>(numeric_only <span class="op">=</span> <span class="va">True</span>)<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Quotient positive residual load / generation: </span><span class="sc">{</span>residual_load<span class="sc">.</span>clip(lower <span class="op">=</span> <span class="dv">0</span>)<span class="sc">.</span><span class="bu">sum</span>() <span class="op">/</span> generation<span class="sc">.</span><span class="bu">sum</span>(numeric_only <span class="op">=</span> <span class="va">True</span>)<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Share of renewable generation: </span><span class="sc">{</span><span class="dv">1</span> <span class="op">-</span> (residual_load.clip(lower <span class="op">=</span> <span class="dv">0</span>).<span class="bu">sum</span>() <span class="op">/</span> generation.<span class="bu">sum</span>(numeric_only <span class="op">=</span> <span class="va">True</span>).<span class="bu">sum</span>())<span class="sc">:,.2f}</span><span class="ss">"</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sum of positive residual load [MWh]: 207842228.25
Sum of grid load: 458271100.75
Quotient positive residual load / grid load: 0.45
Share of renewable generation: 0.55

Sum of generation: 448650448.25
Quotient positive residual load / generation: 0.46
Share of renewable generation: 0.54</code></pre>
</div>
</div>
<p>The grid load from the dataset <code>consumption</code> deviates slightly at 458 TWh from the summed electricity generation in the dataset <code>generation</code> at 448 TWh. As a result, the calculated shares differ slightly.</p>
<section id="calculation-3" class="level4">
<h4 class="anchored" data-anchor-id="calculation-3">Calculation</h4>
<p>The basis for calculating the share of renewable electricity generation after discharging renewable surplus production is the annual cycle of the storage. Discharging electricity means a reduction of the state of charge between two points in time. The discharged electricity reduces the positive residual load at that time. Consequently, the ratio of positive residual load to grid load decreases, and the share of renewable electricity generation increases. This is implemented in the following function.</p>
<ul>
<li><p>Input: The function receives a residual load data series. Optionally, a grid load data series can also be provided. Additionally, an optional list of reduced storage sizes, expressed as relative fractions of 1, can be supplied. If no list is provided, the calculation is performed for the relative storage sizes [0.9, 0.8, 0.7, 0.6, 0.5].</p></li>
<li><p>Processing: By calling the function <code>calculate_annual_storage()</code>, the annual cycles of the electricity storage with relative size 1 are calculated for the residual load data series. Using these annual cycles, the discharged electricity amount in the annual cycle is determined with the method <code>pd.Series.diff().clip(upper = 0)</code>. For this sliding difference calculation, a zero is prepended to the annual cycle in year 1, and the last value from year 1 is prepended to the annual cycle in year 2. The first value in the annual cycle of the discharged electricity amount is NaN, so this value is dropped and the index is reset. The complete command is: <code>pd.Series.diff().clip(upper = 0)[1:].reset_index(drop = True)</code>. The annual cycle of the discharged electricity amount is subtracted from the residual load curve, thereby determining the residual load curve after discharging. Since discharging in the annual cycle is represented by negative values, the difference is calculated by addition.<br>
If a grid load data series is provided, the realized share of renewable generation is calculated based on the residual load curve after discharging: 1 - (sum of positive residual load / sum of grid load). The calculations are repeated for smaller-sized storages.</p></li>
<li><p>Output: If <code>output = False</code>, the residual load curves after discharging are returned as a DataFrame. The DataFrame consists of one column for the relative storage size 1 as well as for all supplied relatively reduced storage sizes. The residual load curves in year 1 and year 2 are stored in row 0 and row 1, respectively. If <code>output = True</code>, the summed grid load, the summed positive &amp; negative residual load, the share of renewable generation without storage, and the realized share of renewable generation with the storage size in the base year and for all provided storage sizes are printed for year 1 and year 2 using <code>print()</code>.</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true" href="">without efficiency</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false" href="">with Efficiency</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div id="695a036c" class="cell" data-execution_count="74">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate share of renewable energy (RE)</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Input: data = pd.Series(data, dtype='float'), grid_load = -1, new_storage_capacitys = [0.9, 0.8, 0.7, 0.6, 0.5], output = False</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: Call function calculate_annual_storage(data) to determine storage size and annual storage profile for Year 1 and Year 2</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: From the annual storage profile, determine the discharged electricity, subtract it from residual load --&gt; new residual load curve after discharge</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: If grid_load = pd.Series(grid_load, dtype='float') is provided, determine share of renewable energy based on residual load after discharge</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: Repeat calculations for smaller storage sizes, default = [0.9, 0.8, 0.7, 0.6, 0.5]</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: output = False: Return DataFrame of residual load curves after discharge. Column 0 = storage size 1, subsequent columns = new storage sizes. Row 0 = residual load Year 1, Row 1 = residual load Year 2</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: output = True: Print total grid load, positive/negative residual load, RE share without storage, and realized RE share for base year storage size and new_storage_capacitys for Year 1 and Year 2</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_re_share(data, grid_load<span class="op">=-</span><span class="dv">1</span>, new_storage_capacitys<span class="op">=</span>[<span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.6</span>, <span class="fl">0.5</span>], output<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine annual profile for base year</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> calculate_annual_storage(data, storage_capacity<span class="op">=-</span><span class="dv">1</span>, output<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>    base_storage_capacity <span class="op">=</span> result[<span class="dv">0</span>]</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>    annual_storage_year1 <span class="op">=</span> result[<span class="dv">1</span>]</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>    annual_storage_year2 <span class="op">=</span> result[<span class="dv">2</span>]</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prepend zero to Year 1 profile, use last value of Year 1 for Year 2</span></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>    annual_storage_year1 <span class="op">=</span> pd.concat([pd.Series([<span class="dv">0</span>]), annual_storage_year1])</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>    annual_storage_year2 <span class="op">=</span> pd.concat([annual_storage_year1[<span class="op">-</span><span class="dv">1</span>:], annual_storage_year2])</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate discharged electricity, drop first NaN</span></span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>    discharged_year1 <span class="op">=</span> annual_storage_year1.diff().clip(upper<span class="op">=</span><span class="dv">0</span>)[<span class="dv">1</span>:].reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>    discharged_year2 <span class="op">=</span> annual_storage_year2.diff().clip(upper<span class="op">=</span><span class="dv">0</span>)[<span class="dv">1</span>:].reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate residual load after discharge (discharged values are negative)</span></span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>    residual_load_year1 <span class="op">=</span> data <span class="op">+</span> discharged_year1</span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a>    residual_load_year2 <span class="op">=</span> data <span class="op">+</span> discharged_year2</span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store residual load in DataFrame</span></span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a>    residual_after_discharge <span class="op">=</span> pd.DataFrame({<span class="st">'Storage size 1'</span>: [<span class="bu">list</span>(residual_load_year1), <span class="bu">list</span>(residual_load_year2)]})</span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(grid_load, <span class="bu">int</span>):  <span class="co"># RE share cannot be calculated</span></span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> output:</span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Grid load was not provided. RE share cannot be calculated."</span>)</span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a>        output <span class="op">=</span> <span class="va">False</span></span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:  <span class="co"># Calculate RE share</span></span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># RE share = 1 - sum of positive residual load / total grid load</span></span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a>        <span class="co">## Year 1</span></span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a>        re_share_year1 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (residual_load_year1.clip(lower<span class="op">=</span><span class="dv">0</span>).<span class="bu">sum</span>() <span class="op">/</span> grid_load.<span class="bu">sum</span>())</span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a>        <span class="co">## Year 2</span></span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a>        re_share_year2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (residual_load_year2.clip(lower<span class="op">=</span><span class="dv">0</span>).<span class="bu">sum</span>() <span class="op">/</span> grid_load.<span class="bu">sum</span>())</span>
<span id="cb74-43"><a href="#cb74-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-44"><a href="#cb74-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Store RE share in DataFrame</span></span>
<span id="cb74-45"><a href="#cb74-45" aria-hidden="true" tabindex="-1"></a>        re_share_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb74-46"><a href="#cb74-46" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Relative storage size'</span>: pd.concat([pd.Series([<span class="dv">1</span>]), pd.Series(new_storage_capacitys)], ignore_index<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb74-47"><a href="#cb74-47" aria-hidden="true" tabindex="-1"></a>            <span class="st">'RE share Year1'</span>: pd.Series([re_share_year1]),</span>
<span id="cb74-48"><a href="#cb74-48" aria-hidden="true" tabindex="-1"></a>            <span class="st">'RE share Year2'</span>: pd.Series([re_share_year2])</span>
<span id="cb74-49"><a href="#cb74-49" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb74-50"><a href="#cb74-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-51"><a href="#cb74-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate discharged electricity and RE share for alternative storage sizes</span></span>
<span id="cb74-52"><a href="#cb74-52" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb74-53"><a href="#cb74-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(new_storage_capacitys)):</span>
<span id="cb74-54"><a href="#cb74-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-55"><a href="#cb74-55" aria-hidden="true" tabindex="-1"></a>        new_storage <span class="op">=</span> base_storage_capacity <span class="op">*</span> new_storage_capacitys[i]</span>
<span id="cb74-56"><a href="#cb74-56" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> calculate_annual_storage(data, storage_capacity<span class="op">=</span>new_storage, output<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb74-57"><a href="#cb74-57" aria-hidden="true" tabindex="-1"></a>        annual_storage_year1 <span class="op">=</span> result[<span class="dv">1</span>]</span>
<span id="cb74-58"><a href="#cb74-58" aria-hidden="true" tabindex="-1"></a>        annual_storage_year2 <span class="op">=</span> result[<span class="dv">2</span>]</span>
<span id="cb74-59"><a href="#cb74-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-60"><a href="#cb74-60" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Prepend zero to Year 1 profile, use last value of Year 1 for Year 2</span></span>
<span id="cb74-61"><a href="#cb74-61" aria-hidden="true" tabindex="-1"></a>        annual_storage_year1 <span class="op">=</span> pd.concat([pd.Series([<span class="dv">0</span>]), annual_storage_year1])</span>
<span id="cb74-62"><a href="#cb74-62" aria-hidden="true" tabindex="-1"></a>        annual_storage_year2 <span class="op">=</span> pd.concat([annual_storage_year1[<span class="op">-</span><span class="dv">1</span>:], annual_storage_year2])</span>
<span id="cb74-63"><a href="#cb74-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-64"><a href="#cb74-64" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate discharged electricity</span></span>
<span id="cb74-65"><a href="#cb74-65" aria-hidden="true" tabindex="-1"></a>        discharged_year1 <span class="op">=</span> annual_storage_year1.diff().clip(upper<span class="op">=</span><span class="dv">0</span>)[<span class="dv">1</span>:].reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb74-66"><a href="#cb74-66" aria-hidden="true" tabindex="-1"></a>        discharged_year2 <span class="op">=</span> annual_storage_year2.diff().clip(upper<span class="op">=</span><span class="dv">0</span>)[<span class="dv">1</span>:].reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb74-67"><a href="#cb74-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-68"><a href="#cb74-68" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Residual load after discharge</span></span>
<span id="cb74-69"><a href="#cb74-69" aria-hidden="true" tabindex="-1"></a>        residual_load_year1 <span class="op">=</span> data <span class="op">+</span> discharged_year1</span>
<span id="cb74-70"><a href="#cb74-70" aria-hidden="true" tabindex="-1"></a>        residual_load_year2 <span class="op">=</span> data <span class="op">+</span> discharged_year2</span>
<span id="cb74-71"><a href="#cb74-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-72"><a href="#cb74-72" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add column to residual_after_discharge DataFrame</span></span>
<span id="cb74-73"><a href="#cb74-73" aria-hidden="true" tabindex="-1"></a>        residual_after_discharge[<span class="st">'Storage size '</span> <span class="op">+</span> <span class="bu">str</span>(new_storage)] <span class="op">=</span> [<span class="bu">list</span>(residual_load_year1), <span class="bu">list</span>(residual_load_year2)]</span>
<span id="cb74-74"><a href="#cb74-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-75"><a href="#cb74-75" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate RE share</span></span>
<span id="cb74-76"><a href="#cb74-76" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(grid_load, <span class="bu">int</span>):</span>
<span id="cb74-77"><a href="#cb74-77" aria-hidden="true" tabindex="-1"></a>            re_share_year1 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (residual_load_year1.clip(lower<span class="op">=</span><span class="dv">0</span>).<span class="bu">sum</span>() <span class="op">/</span> grid_load.<span class="bu">sum</span>())</span>
<span id="cb74-78"><a href="#cb74-78" aria-hidden="true" tabindex="-1"></a>            re_share_year2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (residual_load_year2.clip(lower<span class="op">=</span><span class="dv">0</span>).<span class="bu">sum</span>() <span class="op">/</span> grid_load.<span class="bu">sum</span>())</span>
<span id="cb74-79"><a href="#cb74-79" aria-hidden="true" tabindex="-1"></a>            re_share_df.loc[count, <span class="st">'RE share Year1'</span>] <span class="op">=</span> re_share_year1</span>
<span id="cb74-80"><a href="#cb74-80" aria-hidden="true" tabindex="-1"></a>            re_share_df.loc[count, <span class="st">'RE share Year2'</span>] <span class="op">=</span> re_share_year2</span>
<span id="cb74-81"><a href="#cb74-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-82"><a href="#cb74-82" aria-hidden="true" tabindex="-1"></a>        count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb74-83"><a href="#cb74-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-84"><a href="#cb74-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> output:  <span class="co"># Print RE share</span></span>
<span id="cb74-85"><a href="#cb74-85" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Total grid load: </span><span class="sc">{</span>grid_load<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">Total positive residual load: </span><span class="sc">{</span>data<span class="sc">.</span>clip(lower<span class="op">=</span><span class="dv">0</span>)<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:,.2f}</span><span class="ch">\t</span><span class="ss">Total negative residual load: </span><span class="sc">{</span>data<span class="sc">.</span>clip(upper<span class="op">=</span><span class="dv">0</span>)<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">Storage size 1: </span><span class="sc">{</span>base_storage_capacity<span class="sc">:,.2f}</span><span class="ch">\t</span><span class="ss">RE share without storage: </span><span class="sc">{</span><span class="dv">1</span> <span class="op">-</span> (data.clip(lower<span class="op">=</span><span class="dv">0</span>).<span class="bu">sum</span>() <span class="op">/</span> grid_load.<span class="bu">sum</span>()) <span class="cf">if</span> <span class="bu">len</span>(grid_load) <span class="op">&gt;</span> <span class="dv">1</span> <span class="cf">else</span> <span class="st">'--'</span><span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb74-86"><a href="#cb74-86" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(re_share_df)</span>
<span id="cb74-87"><a href="#cb74-87" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:  <span class="co"># Return residual load curves</span></span>
<span id="cb74-88"><a href="#cb74-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> residual_after_discharge</span>
<span id="cb74-89"><a href="#cb74-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-90"><a href="#cb74-90" aria-hidden="true" tabindex="-1"></a>calculate_re_share(residual_load, grid_load<span class="op">=</span>consumption[<span class="st">'Gesamt (Netzlast) [MWh]'</span>], new_storage_capacitys<span class="op">=</span>[<span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.6</span>, <span class="fl">0.5</span>], output<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total grid load: 458,271,100.75
Total positive residual load: 207,842,228.25    Total negative residual load: -1,002,976.00
Storage size 1: 119,667.00  RE share without storage: 0.55

   Relative storage size  RE share Year1  RE share Year2
0                    1.0            0.55            0.55
1                    0.9            0.55            0.55
2                    0.8            0.55            0.55
3                    0.7            0.55            0.55
4                    0.6            0.55            0.55
5                    0.5            0.55            0.55</code></pre>
</div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div id="70fdc08d" class="cell" data-execution_count="75">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate renewable energy share</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Input: data = pd.Series(data, dtype='float'), grid_load = -1, charge_efficiency = 1, discharge_efficiency = 1, new_storage_capacitys = [0.9, 0.8, 0.7, 0.6, 0.5], output = False</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: Call the function calculate_annual_storage(data) to determine storage size and annual profile of storage in year 1 and year 2</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: Determine the discharged electricity in the annual storage profile, subtract it from the residual load --&gt; new residual load curve after discharge</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: If grid_load = pd.Series(grid_load, dtype='float') is provided, determine the renewable energy share based on the residual load curve after discharge</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="co">## Processing: Repeat calculations for smaller sized storages, default = [0.9, 0.8, 0.7, 0.6, 0.5]</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: output = False: Return a DataFrame of residual load curve(s) after discharge. Column 0 corresponds to storage size = 1, subsequent columns correspond to new storage sizes. Row 0 contains residual load curve for year 1, row 1 for year 2</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="co">## Output: output = True: Print sum of grid load, positive/negative residual load, renewable energy share without storage, and realized renewable energy share for base year storage size and new_storage_capacitys for year 1 and year 2</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_renewable_share(data, grid_load<span class="op">=-</span><span class="dv">1</span>, charge_efficiency<span class="op">=</span><span class="dv">1</span>, discharge_efficiency<span class="op">=</span><span class="dv">1</span>, new_storage_capacitys<span class="op">=</span>[<span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.6</span>, <span class="fl">0.5</span>], output<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine annual profile for base year</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> calculate_annual_storage(data, storage_capacity<span class="op">=-</span><span class="dv">1</span>, charge_efficiency<span class="op">=</span>charge_efficiency, discharge_efficiency<span class="op">=</span>discharge_efficiency, output<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>    base_storage_capacity <span class="op">=</span> result[<span class="dv">0</span>]</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>    storage_profile_year1 <span class="op">=</span> result[<span class="dv">1</span>]</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>    storage_profile_year2 <span class="op">=</span> result[<span class="dv">2</span>]</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prepend zero to year 1, year 2 starts with last value of year 1</span></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>    storage_profile_year1 <span class="op">=</span> pd.concat([pd.Series([<span class="dv">0</span>]), storage_profile_year1])</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>    storage_profile_year2 <span class="op">=</span> pd.concat([storage_profile_year1[<span class="op">-</span><span class="dv">1</span>:], storage_profile_year2])</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Discharged electricity profile, first value is NaN and omitted</span></span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>    discharge_year1 <span class="op">=</span> storage_profile_year1.diff().clip(upper<span class="op">=</span><span class="dv">0</span>)[<span class="dv">1</span>:].reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>    discharge_year2 <span class="op">=</span> storage_profile_year2.diff().clip(upper<span class="op">=</span><span class="dv">0</span>)[<span class="dv">1</span>:].reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate residual load after discharge</span></span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a>    residual_load_year1 <span class="op">=</span> data <span class="op">+</span> discharge_year1</span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a>    residual_load_year2 <span class="op">=</span> data <span class="op">+</span> discharge_year2</span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store residual load in DataFrame</span></span>
<span id="cb76-31"><a href="#cb76-31" aria-hidden="true" tabindex="-1"></a>    residual_load_after_discharge <span class="op">=</span> pd.DataFrame({<span class="st">'Storage size 1'</span>: [<span class="bu">list</span>(residual_load_year1), <span class="bu">list</span>(residual_load_year2)]})</span>
<span id="cb76-32"><a href="#cb76-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-33"><a href="#cb76-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(grid_load) <span class="kw">is</span> <span class="bu">int</span>:  <span class="co"># Renewable share cannot be calculated</span></span>
<span id="cb76-34"><a href="#cb76-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> output:</span>
<span id="cb76-35"><a href="#cb76-35" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Grid load not provided. Renewable energy share cannot be calculated."</span>)</span>
<span id="cb76-36"><a href="#cb76-36" aria-hidden="true" tabindex="-1"></a>        output <span class="op">=</span> <span class="va">False</span></span>
<span id="cb76-37"><a href="#cb76-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb76-38"><a href="#cb76-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:  <span class="co"># Calculate renewable share</span></span>
<span id="cb76-39"><a href="#cb76-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb76-40"><a href="#cb76-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Renewable share = 1 - sum of positive residual load / sum of grid load</span></span>
<span id="cb76-41"><a href="#cb76-41" aria-hidden="true" tabindex="-1"></a>        <span class="co">## Year 1</span></span>
<span id="cb76-42"><a href="#cb76-42" aria-hidden="true" tabindex="-1"></a>        renewable_share_year1 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (residual_load_year1.clip(lower<span class="op">=</span><span class="dv">0</span>).<span class="bu">sum</span>() <span class="op">/</span> grid_load.<span class="bu">sum</span>())</span>
<span id="cb76-43"><a href="#cb76-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-44"><a href="#cb76-44" aria-hidden="true" tabindex="-1"></a>        <span class="co">## Year 2</span></span>
<span id="cb76-45"><a href="#cb76-45" aria-hidden="true" tabindex="-1"></a>        renewable_share_year2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (residual_load_year2.clip(lower<span class="op">=</span><span class="dv">0</span>).<span class="bu">sum</span>() <span class="op">/</span> grid_load.<span class="bu">sum</span>())</span>
<span id="cb76-46"><a href="#cb76-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-47"><a href="#cb76-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Store renewable share in DataFrame</span></span>
<span id="cb76-48"><a href="#cb76-48" aria-hidden="true" tabindex="-1"></a>        renewable_share_df <span class="op">=</span> pd.DataFrame({<span class="st">'relative_storage_capacity'</span>: pd.concat([pd.Series([<span class="dv">1</span>]), pd.Series(new_storage_capacitys)], ignore_index<span class="op">=</span><span class="va">True</span>), <span class="st">'Renewable share Year1'</span>: pd.Series([renewable_share_year1]), <span class="st">'Renewable share Year2'</span>: pd.Series([renewable_share_year2])})</span>
<span id="cb76-49"><a href="#cb76-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-50"><a href="#cb76-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate discharged electricity and renewable share for alternative storage sizes</span></span>
<span id="cb76-51"><a href="#cb76-51" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb76-52"><a href="#cb76-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-53"><a href="#cb76-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(new_storage_capacitys)):</span>
<span id="cb76-54"><a href="#cb76-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-55"><a href="#cb76-55" aria-hidden="true" tabindex="-1"></a>        new_storage_capacity <span class="op">=</span> base_storage_capacity <span class="op">*</span> new_storage_capacitys[i]</span>
<span id="cb76-56"><a href="#cb76-56" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb76-57"><a href="#cb76-57" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> calculate_annual_storage(data, storage_capacity<span class="op">=</span>new_storage_capacity, charge_efficiency<span class="op">=</span>charge_efficiency, discharge_efficiency<span class="op">=</span>discharge_efficiency, output<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb76-58"><a href="#cb76-58" aria-hidden="true" tabindex="-1"></a>        storage_profile_year1 <span class="op">=</span> result[<span class="dv">1</span>]</span>
<span id="cb76-59"><a href="#cb76-59" aria-hidden="true" tabindex="-1"></a>        storage_profile_year2 <span class="op">=</span> result[<span class="dv">2</span>]</span>
<span id="cb76-60"><a href="#cb76-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-61"><a href="#cb76-61" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Prepend zero to year 1, year 2 starts with last value of year 1</span></span>
<span id="cb76-62"><a href="#cb76-62" aria-hidden="true" tabindex="-1"></a>        storage_profile_year1 <span class="op">=</span> pd.concat([pd.Series([<span class="dv">0</span>]), storage_profile_year1])</span>
<span id="cb76-63"><a href="#cb76-63" aria-hidden="true" tabindex="-1"></a>        storage_profile_year2 <span class="op">=</span> pd.concat([storage_profile_year1[<span class="op">-</span><span class="dv">1</span>:], storage_profile_year2])</span>
<span id="cb76-64"><a href="#cb76-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-65"><a href="#cb76-65" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Discharged electricity profile</span></span>
<span id="cb76-66"><a href="#cb76-66" aria-hidden="true" tabindex="-1"></a>        discharge_year1 <span class="op">=</span> storage_profile_year1.diff().clip(upper<span class="op">=</span><span class="dv">0</span>)[<span class="dv">1</span>:].reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb76-67"><a href="#cb76-67" aria-hidden="true" tabindex="-1"></a>        discharge_year2 <span class="op">=</span> storage_profile_year2.diff().clip(upper<span class="op">=</span><span class="dv">0</span>)[<span class="dv">1</span>:].reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb76-68"><a href="#cb76-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-69"><a href="#cb76-69" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate residual load after discharge</span></span>
<span id="cb76-70"><a href="#cb76-70" aria-hidden="true" tabindex="-1"></a>        residual_load_year1 <span class="op">=</span> data <span class="op">+</span> discharge_year1</span>
<span id="cb76-71"><a href="#cb76-71" aria-hidden="true" tabindex="-1"></a>        residual_load_year2 <span class="op">=</span> data <span class="op">+</span> discharge_year2</span>
<span id="cb76-72"><a href="#cb76-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-73"><a href="#cb76-73" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add column to residual load DataFrame</span></span>
<span id="cb76-74"><a href="#cb76-74" aria-hidden="true" tabindex="-1"></a>        residual_load_after_discharge[<span class="st">'Storage size '</span> <span class="op">+</span> <span class="bu">str</span>(new_storage_capacity)] <span class="op">=</span> [<span class="bu">list</span>(residual_load_year1), <span class="bu">list</span>(residual_load_year2)]</span>
<span id="cb76-75"><a href="#cb76-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-76"><a href="#cb76-76" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate renewable share</span></span>
<span id="cb76-77"><a href="#cb76-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">type</span>(grid_load) <span class="kw">is</span> <span class="kw">not</span> <span class="bu">int</span>:</span>
<span id="cb76-78"><a href="#cb76-78" aria-hidden="true" tabindex="-1"></a>            renewable_share_year1 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (residual_load_year1.clip(lower<span class="op">=</span><span class="dv">0</span>).<span class="bu">sum</span>() <span class="op">/</span> grid_load.<span class="bu">sum</span>())</span>
<span id="cb76-79"><a href="#cb76-79" aria-hidden="true" tabindex="-1"></a>            renewable_share_year2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (residual_load_year2.clip(lower<span class="op">=</span><span class="dv">0</span>).<span class="bu">sum</span>() <span class="op">/</span> grid_load.<span class="bu">sum</span>())</span>
<span id="cb76-80"><a href="#cb76-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-81"><a href="#cb76-81" aria-hidden="true" tabindex="-1"></a>            renewable_share_df.loc[count, <span class="st">'Renewable share Year1'</span>] <span class="op">=</span> renewable_share_year1</span>
<span id="cb76-82"><a href="#cb76-82" aria-hidden="true" tabindex="-1"></a>            renewable_share_df.loc[count, <span class="st">'Renewable share Year2'</span>] <span class="op">=</span> renewable_share_year2</span>
<span id="cb76-83"><a href="#cb76-83" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb76-84"><a href="#cb76-84" aria-hidden="true" tabindex="-1"></a>        count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb76-85"><a href="#cb76-85" aria-hidden="true" tabindex="-1"></a>                              </span>
<span id="cb76-86"><a href="#cb76-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> output:  <span class="co"># Print renewable share</span></span>
<span id="cb76-87"><a href="#cb76-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-88"><a href="#cb76-88" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Total grid load: </span><span class="sc">{</span>grid_load<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">Sum of positive residual load: </span><span class="sc">{</span>data<span class="sc">.</span>clip(lower<span class="op">=</span><span class="dv">0</span>)<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:,.2f}</span><span class="ch">\t</span><span class="ss">Sum of negative residual load: </span><span class="sc">{</span>data<span class="sc">.</span>clip(upper<span class="op">=</span><span class="dv">0</span>)<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">Base storage size: </span><span class="sc">{</span>base_storage_capacity<span class="sc">:,.2f}</span><span class="ch">\t</span><span class="ss">Renewable share without storage: </span><span class="sc">{</span><span class="dv">1</span> <span class="op">-</span> (data.clip(lower<span class="op">=</span><span class="dv">0</span>).<span class="bu">sum</span>() <span class="op">/</span> grid_load.<span class="bu">sum</span>()) <span class="cf">if</span> <span class="bu">len</span>(grid_load) <span class="op">&gt;</span> <span class="dv">1</span> <span class="cf">else</span> <span class="st">'--'</span><span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb76-89"><a href="#cb76-89" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(renewable_share_df)</span>
<span id="cb76-90"><a href="#cb76-90" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb76-91"><a href="#cb76-91" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:  <span class="co"># Return residual load curves</span></span>
<span id="cb76-92"><a href="#cb76-92" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> residual_load_after_discharge</span>
<span id="cb76-93"><a href="#cb76-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-94"><a href="#cb76-94" aria-hidden="true" tabindex="-1"></a>calculate_renewable_share(residual_load, grid_load<span class="op">=</span>consumption[<span class="st">'Gesamt (Netzlast) [MWh]'</span>], charge_efficiency<span class="op">=</span><span class="fl">0.9</span>, discharge_efficiency<span class="op">=</span><span class="fl">0.9</span>, new_storage_capacitys<span class="op">=</span>[<span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.6</span>, <span class="fl">0.5</span>], output<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total grid load: 458,271,100.75
Sum of positive residual load: 207,842,228.25   Sum of negative residual load: -1,002,976.00
Base storage size: 102,674.54   Renewable share without storage: 0.55

   relative_storage_capacity  Renewable share Year1  Renewable share Year2
0                        1.0                   0.55                   0.55
1                        0.9                   0.55                   0.55
2                        0.8                   0.55                   0.55
3                        0.7                   0.55                   0.55
4                        0.6                   0.55                   0.55
5                        0.5                   0.55                   0.55</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>For the year 2023, integrating an electricity storage system into the grid to (partially) cover residual load from renewable surplus production would result in only a negligible increase in the share of renewable energy in the electricity mix. This is because the renewable surpluses to be stored amount to 1,002,976 MWh, or around 1 TWh, which is significantly smaller than the positive residual load to be covered of 207,842,228 MWh, or around 208 TWh. The renewable surplus production that can be shifted by the electricity storage corresponds to less than half a percent of the residual load to be covered.</p>
<p>However, as the share of renewable generation increases, storing surplus electricity will become increasingly relevant. The required size of electricity storage systems can be estimated using the developed functions for the renewable energy expansion pathway.</p>
</section>
</section>
<section id="task-final-data-analysis" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="task-final-data-analysis"><span class="header-section-number">7.5</span> Task: Final Data Analysis</h2>
<p><strong>Calculate the share of renewable electricity generation for the years 2030 and 2035 according to the expansion pathway specified by the federal government (see <a href="#lst-zubaufaktoren" class="quarto-xref">Code-Block&nbsp;<span>7.1</span></a>).</strong></p>
<ul>
<li><p>What is the maximum storage capacity required?</p></li>
<li><p>What share of renewable electricity generation is achieved if the storage is sized at half, one-tenth, or one-hundredth of the maximum capacity?</p></li>
<li><p>Use the projected electricity demand for the years 2030 and 2035 as the grid load (see note below).</p></li>
<li><p>For the efficiency, existing pumped-storage power plants can be used as a reference. The overall efficiency was calculated at 79.10 percent. This efficiency approximately corresponds to a breakdown of storage input efficiency = 0.9 and storage output efficiency = 0.88.</p></li>
</ul>
<div class="callout callout-style-simple callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warnung</span>Electricity Consumption Projections
</div>
</div>
<div class="callout-body-container callout-body">
<p>Future electricity consumption is unlikely to match that of 2023. Projections estimate electricity consumption of 658 TWh (Kemmler, Wünsch, and Burret 2021, p.&nbsp;4) for 2030 and 670.4 TWh in 2035 (Scenario B according to Nahmmacher et al.&nbsp;2021, p.&nbsp;54). The increase in electricity consumption compared to 2023 can be easily calculated:</p>
<div id="6e38fb0e" class="cell" data-execution_count="76">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>load_factor_2030_MWh <span class="op">=</span> (<span class="dv">658</span> <span class="op">*</span> <span class="dv">1000</span> <span class="op">*</span> <span class="dv">1000</span>) <span class="op">/</span> consumption[<span class="st">"Gesamt (Netzlast) [MWh]"</span>].<span class="bu">sum</span>()</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>load_factor_2035_MWh <span class="op">=</span> (<span class="fl">670.4</span> <span class="op">*</span> <span class="dv">1000</span> <span class="op">*</span> <span class="dv">1000</span>) <span class="op">/</span> consumption[<span class="st">"Gesamt (Netzlast) [MWh]"</span>].<span class="bu">sum</span>()</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Increase in electricity consumption in 2030 compared to 2023 Factor: </span><span class="sc">{</span>load_factor_2030_MWh<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Increase in electricity consumption in 2035 compared to 2023 Factor: </span><span class="sc">{</span>load_factor_2035_MWh<span class="sc">:,.2f}</span><span class="ss">"</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Increase in electricity consumption in 2030 compared to 2023 Factor: 1.44
Increase in electricity consumption in 2035 compared to 2023 Factor: 1.46</code></pre>
</div>
</div>
<p>Kemmler, Andreas, Aurel Wünsch, and Heiko Burret. 2021. “Development of Gross Electricity Consumption until 2030. Short Study.” <a href="https://www.bmwk.de/Redaktion/DE/Downloads/E/prognos-bruttostromverbrauch-2018-2030.pdf?__blob=publicationFile&amp;v=2" class="uri">https://www.bmwk.de/Redaktion/DE/Downloads/E/prognos-bruttostromverbrauch-2018-2030.pdf?__blob=publicationFile&amp;v=2</a></p>
<p>Nahmmacher, Paul, Christian Paris, Martin Ruge, Sebastian Spieker, Thomas Anderski, Sebastian Bohlen, Robin Kaiser, Caroline Podewski, Jürgen Apfelbeck, Timo Kahl, Fabian Lukas, Sven Schäfer, Paul-Steven Ganer, Max Muller, and Daniel Stützle. 2021. “Scenario Framework for the Electricity Grid Development Plan 2035, Version 2021. Draft by the Transmission System Operators.” <a href="https://www.netzausbau.de/SharedDocs/Downloads/DE/Bedarfsermittlung/2035/SR/Szenariorahmen_2035_Entwurf.pdf?__blob=publicationFile" class="uri">https://www.netzausbau.de/SharedDocs/Downloads/DE/Bedarfsermittlung/2035/SR/Szenariorahmen_2035_Entwurf.pdf?__blob=publicationFile</a></p>
</div>
</div>
<p>&nbsp;</p>
<div id="tip-closed-data-analysis-exercise" class="callout callout-style-default callout-tip callout-titled" title="Sample Solution: Closed Data Analysis Exercise">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tipp&nbsp;7.2: Sample Solution: Closed Data Analysis Exercise
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true" href="">Complete Sample Solution</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false" href="">Reference 2030</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false" href="">Reference 2035</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="boarder">
<div id="7ba03284" class="cell" data-execution_count="77">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set number of decimal places</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">"display.precision"</span>, <span class="dv">2</span>)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load datasets</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="co"># !</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="co"># For your own use, adjust the file path to the correct location of the downloaded .csv files.</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="co"># !</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>installed_capacity_ms <span class="op">=</span> pd.read_csv(<span class="st">"01-daten/Installierte_Erzeugungsleistung_202301010000_202401010000_Jahr.csv"</span>, <span class="op">\</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>sep <span class="op">=</span> <span class="st">";"</span>, thousands <span class="op">=</span> <span class="st">"."</span>, decimal <span class="op">=</span> <span class="st">","</span>, parse_dates <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">1</span>], date_format <span class="op">=</span> <span class="st">"</span><span class="sc">%d</span><span class="st">.%m.%Y"</span>)</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>generation_ms <span class="op">=</span> pd.read_csv(<span class="st">"01-daten/Realisierte_Erzeugung_202301010000_202401010000_Viertelstunde.csv"</span>, <span class="op">\</span></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>sep <span class="op">=</span> <span class="st">";"</span>, thousands <span class="op">=</span> <span class="st">"."</span>, decimal <span class="op">=</span> <span class="st">","</span>, parse_dates <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">1</span>], date_format <span class="op">=</span> <span class="st">"</span><span class="sc">%d</span><span class="st">.%m.%Y %H:%M"</span>)</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>consumption_ms <span class="op">=</span> pd.read_csv(<span class="st">"01-daten/Realisierter_Stromverbrauch_202301010000_202401010000_Viertelstunde.csv"</span>, <span class="op">\</span></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>sep <span class="op">=</span> <span class="st">";"</span>, thousands <span class="op">=</span> <span class="st">"."</span>, decimal <span class="op">=</span> <span class="st">","</span>, parse_dates <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">1</span>], date_format <span class="op">=</span> <span class="st">"</span><span class="sc">%d</span><span class="st">.%m.%Y %H:%M"</span>)</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the string " Originalauflösungen" from column names</span></span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>generation_ms.columns <span class="op">=</span> generation_ms.columns.<span class="bu">str</span>.replace(pat <span class="op">=</span> <span class="st">" Originalauflösungen"</span>, repl <span class="op">=</span> <span class="st">""</span>)</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>installed_capacity_ms.columns <span class="op">=</span> installed_capacity_ms.columns.<span class="bu">str</span>.replace(pat <span class="op">=</span> <span class="st">" Originalauflösungen"</span>, repl <span class="op">=</span> <span class="st">""</span>)</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>consumption_ms.columns <span class="op">=</span> consumption_ms.columns.<span class="bu">str</span>.replace(pat <span class="op">=</span> <span class="st">" Originalauflösungen"</span>, repl <span class="op">=</span> <span class="st">""</span>)</span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate renewable generation into a list</span></span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>renewables_ms <span class="op">=</span> [<span class="st">'Biomasse [MWh]'</span>, <span class="st">'Wasserkraft [MWh]'</span>, <span class="st">'Wind Offshore [MWh]'</span>, <span class="st">'Wind Onshore [MWh]'</span>, <span class="st">'Photovoltaik [MWh]'</span>, <span class="st">'Sonstige Erneuerbare [MWh]'</span>]</span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a>pumped_storage_capacity_MWh_ms <span class="op">=</span> <span class="fl">37.4</span> <span class="op">*</span> <span class="dv">1000</span></span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Projected generation and electricity consumption for 2030 &amp; 2035:</span></span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Onshore Wind 2030:</span><span class="ch">\t</span><span class="sc">{</span>( windonshore_growth_factor_2030_ms <span class="op">:=</span> <span class="dv">115</span> <span class="op">/</span> (installed_capacity_ms[<span class="st">'Wind Onshore [MW]'</span>].<span class="bu">sum</span>() <span class="op">/</span> <span class="dv">1000</span>) )<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Offshore Wind 2030:</span><span class="ch">\t</span><span class="sc">{</span>( windoffshore_growth_factor_2030_ms <span class="op">:=</span> <span class="dv">30</span> <span class="op">/</span> (installed_capacity_ms[<span class="st">'Wind Offshore [MW]'</span>].<span class="bu">sum</span>() <span class="op">/</span> <span class="dv">1000</span>) )<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Solar 2030:</span><span class="ch">\t\t\t</span><span class="sc">{</span>( solar_growth_factor_2030_ms <span class="op">:=</span> <span class="dv">215</span> <span class="op">/</span> (installed_capacity_ms[<span class="st">'Photovoltaik [MW]'</span>].<span class="bu">sum</span>() <span class="op">/</span> <span class="dv">1000</span>) )<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Biomass 2030:</span><span class="ch">\t\t</span><span class="sc">{</span><span class="fl">8.4</span> <span class="op">/</span> (installed_capacity_ms[<span class="st">'Biomasse [MW]'</span>].<span class="bu">sum</span>() <span class="op">/</span> <span class="dv">1000</span>)<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n\n</span><span class="ss">Onshore Wind 2035:</span><span class="ch">\t</span><span class="sc">{</span>( windonshore_growth_factor_2035_ms <span class="op">:=</span> <span class="dv">157</span> <span class="op">/</span> (installed_capacity_ms[<span class="st">'Wind Onshore [MW]'</span>].<span class="bu">sum</span>() <span class="op">/</span> <span class="dv">1000</span>) )<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Offshore Wind 2035:</span><span class="ch">\t</span><span class="sc">{</span>( windoffshore_growth_factor_2035_ms <span class="op">:=</span> <span class="dv">40</span> <span class="op">/</span> (installed_capacity_ms[<span class="st">'Wind Offshore [MW]'</span>].<span class="bu">sum</span>() <span class="op">/</span> <span class="dv">1000</span>) )<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb80-38"><a href="#cb80-38" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Solar 2035:</span><span class="ch">\t\t\t</span><span class="sc">{</span>( solar_growth_factor_2035_ms <span class="op">:=</span> <span class="dv">309</span> <span class="op">/</span> (installed_capacity_ms[<span class="st">'Photovoltaik [MW]'</span>].<span class="bu">sum</span>() <span class="op">/</span> <span class="dv">1000</span>) )<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb80-39"><a href="#cb80-39" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Biomass 2035:</span><span class="ch">\t\t</span><span class="sc">{</span><span class="fl">8.4</span> <span class="op">/</span> (installed_capacity_ms[<span class="st">'Biomasse [MW]'</span>].<span class="bu">sum</span>() <span class="op">/</span> <span class="dv">1000</span>)<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb80-40"><a href="#cb80-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-41"><a href="#cb80-41" aria-hidden="true" tabindex="-1"></a>load_factor_2030_MWh_ms <span class="op">=</span> (<span class="dv">658</span> <span class="op">*</span> <span class="dv">1000</span> <span class="op">*</span> <span class="dv">1000</span>) <span class="op">/</span> consumption_ms[<span class="st">"Gesamt (Netzlast) [MWh]"</span>].<span class="bu">sum</span>()</span>
<span id="cb80-42"><a href="#cb80-42" aria-hidden="true" tabindex="-1"></a>load_factor_2035_MWh_ms <span class="op">=</span> (<span class="fl">670.4</span> <span class="op">*</span> <span class="dv">1000</span> <span class="op">*</span> <span class="dv">1000</span>) <span class="op">/</span> consumption_ms[<span class="st">"Gesamt (Netzlast) [MWh]"</span>].<span class="bu">sum</span>()</span>
<span id="cb80-43"><a href="#cb80-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-44"><a href="#cb80-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Increase in electricity consumption 2030 vs 2023 factor: </span><span class="sc">{</span>load_factor_2030_MWh_ms<span class="sc">:,.2f}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb80-45"><a href="#cb80-45" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Increase in electricity consumption 2035 vs 2023 factor: </span><span class="sc">{</span>load_factor_2035_MWh_ms<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb80-46"><a href="#cb80-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-47"><a href="#cb80-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Define residual load</span></span>
<span id="cb80-48"><a href="#cb80-48" aria-hidden="true" tabindex="-1"></a>residual_load_ms <span class="op">=</span> pd.DataFrame()</span>
<span id="cb80-49"><a href="#cb80-49" aria-hidden="true" tabindex="-1"></a>residual_load_ms[<span class="st">"Netzlast [MWh]"</span>] <span class="op">=</span> consumption_ms[<span class="st">"Gesamt (Netzlast) [MWh]"</span>].copy() </span>
<span id="cb80-50"><a href="#cb80-50" aria-hidden="true" tabindex="-1"></a>residual_load_ms[<span class="st">"Erneuerbare [MWh]"</span>] <span class="op">=</span> generation_ms[renewables_ms].<span class="bu">sum</span>(axis <span class="op">=</span> <span class="st">"columns"</span>).copy()</span>
<span id="cb80-51"><a href="#cb80-51" aria-hidden="true" tabindex="-1"></a>residual_load_ms[<span class="st">"Restlast [MWh]"</span>] <span class="op">=</span> residual_load_ms[<span class="st">"Netzlast [MWh]"</span>] <span class="op">-</span> residual_load_ms[<span class="st">"Erneuerbare [MWh]"</span>]</span>
<span id="cb80-52"><a href="#cb80-52" aria-hidden="true" tabindex="-1"></a>residual_load_ms <span class="op">=</span> residual_load_ms[<span class="st">"Restlast [MWh]"</span>]</span>
<span id="cb80-53"><a href="#cb80-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-54"><a href="#cb80-54" aria-hidden="true" tabindex="-1"></a>generation_2030_ms <span class="op">=</span> generation_ms.copy()</span>
<span id="cb80-55"><a href="#cb80-55" aria-hidden="true" tabindex="-1"></a>generation_2035_ms <span class="op">=</span> generation_ms.copy()</span>
<span id="cb80-56"><a href="#cb80-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-57"><a href="#cb80-57" aria-hidden="true" tabindex="-1"></a>generation_2030_ms[<span class="st">"Wind Onshore [MWh]"</span>] <span class="op">=</span> generation_2030_ms[<span class="st">"Wind Onshore [MWh]"</span>] <span class="op">*</span> windonshore_growth_factor_2030_ms</span>
<span id="cb80-58"><a href="#cb80-58" aria-hidden="true" tabindex="-1"></a>generation_2030_ms[<span class="st">"Wind Offshore [MWh]"</span>] <span class="op">=</span> generation_2030_ms[<span class="st">"Wind Offshore [MWh]"</span>] <span class="op">*</span> windoffshore_growth_factor_2030_ms</span>
<span id="cb80-59"><a href="#cb80-59" aria-hidden="true" tabindex="-1"></a>generation_2030_ms[<span class="st">"Photovoltaik [MWh]"</span>] <span class="op">=</span> generation_2030_ms[<span class="st">"Photovoltaik [MWh]"</span>] <span class="op">*</span> solar_growth_factor_2030_ms</span>
<span id="cb80-60"><a href="#cb80-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Biomass does not need to change (factor ~1)</span></span>
<span id="cb80-61"><a href="#cb80-61" aria-hidden="true" tabindex="-1"></a>generation_2035_ms[<span class="st">"Wind Onshore [MWh]"</span>] <span class="op">=</span> generation_2035_ms[<span class="st">"Wind Onshore [MWh]"</span>] <span class="op">*</span> windonshore_growth_factor_2035_ms</span>
<span id="cb80-62"><a href="#cb80-62" aria-hidden="true" tabindex="-1"></a>generation_2035_ms[<span class="st">"Wind Offshore [MWh]"</span>] <span class="op">=</span> generation_2035_ms[<span class="st">"Wind Offshore [MWh]"</span>] <span class="op">*</span> windoffshore_growth_factor_2035_ms</span>
<span id="cb80-63"><a href="#cb80-63" aria-hidden="true" tabindex="-1"></a>generation_2035_ms[<span class="st">"Photovoltaik [MWh]"</span>] <span class="op">=</span> generation_2035_ms[<span class="st">"Photovoltaik [MWh]"</span>] <span class="op">*</span> solar_growth_factor_2035_ms</span>
<span id="cb80-64"><a href="#cb80-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-65"><a href="#cb80-65" aria-hidden="true" tabindex="-1"></a>consumption_2030_ms <span class="op">=</span> consumption_ms.copy()</span>
<span id="cb80-66"><a href="#cb80-66" aria-hidden="true" tabindex="-1"></a>consumption_2030_ms[<span class="st">"Gesamt (Netzlast) [MWh]"</span>] <span class="op">=</span> consumption_2030_ms[<span class="st">"Gesamt (Netzlast) [MWh]"</span>] <span class="op">*</span> load_factor_2030_MWh_ms</span>
<span id="cb80-67"><a href="#cb80-67" aria-hidden="true" tabindex="-1"></a>consumption_2035_ms <span class="op">=</span> consumption_ms.copy()</span>
<span id="cb80-68"><a href="#cb80-68" aria-hidden="true" tabindex="-1"></a>consumption_2035_ms[<span class="st">"Gesamt (Netzlast) [MWh]"</span>] <span class="op">=</span> consumption_2035_ms[<span class="st">"Gesamt (Netzlast) [MWh]"</span>] <span class="op">*</span> load_factor_2035_MWh_ms</span>
<span id="cb80-69"><a href="#cb80-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-70"><a href="#cb80-70" aria-hidden="true" tabindex="-1"></a>residual_load_2030_ms <span class="op">=</span> pd.DataFrame()</span>
<span id="cb80-71"><a href="#cb80-71" aria-hidden="true" tabindex="-1"></a>residual_load_2030_ms[<span class="st">"Netzlast [MWh]"</span>] <span class="op">=</span> consumption_2030_ms[<span class="st">"Gesamt (Netzlast) [MWh]"</span>].copy() </span>
<span id="cb80-72"><a href="#cb80-72" aria-hidden="true" tabindex="-1"></a>residual_load_2030_ms[<span class="st">"Erneuerbare [MWh]"</span>] <span class="op">=</span> generation_2030_ms[renewables_ms].<span class="bu">sum</span>(axis <span class="op">=</span> <span class="st">"columns"</span>).copy()</span>
<span id="cb80-73"><a href="#cb80-73" aria-hidden="true" tabindex="-1"></a>residual_load_2030_ms[<span class="st">"Restlast [MWh]"</span>] <span class="op">=</span> residual_load_2030_ms[<span class="st">"Netzlast [MWh]"</span>] <span class="op">-</span> residual_load_2030_ms[<span class="st">"Erneuerbare [MWh]"</span>]</span>
<span id="cb80-74"><a href="#cb80-74" aria-hidden="true" tabindex="-1"></a>residual_load_2030_ms <span class="op">=</span> residual_load_2030_ms[<span class="st">"Restlast [MWh]"</span>]</span>
<span id="cb80-75"><a href="#cb80-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-76"><a href="#cb80-76" aria-hidden="true" tabindex="-1"></a>residual_load_2035_ms <span class="op">=</span> pd.DataFrame()</span>
<span id="cb80-77"><a href="#cb80-77" aria-hidden="true" tabindex="-1"></a>residual_load_2035_ms[<span class="st">"Netzlast [MWh]"</span>] <span class="op">=</span> consumption_2035_ms[<span class="st">"Gesamt (Netzlast) [MWh]"</span>].copy() </span>
<span id="cb80-78"><a href="#cb80-78" aria-hidden="true" tabindex="-1"></a>residual_load_2035_ms[<span class="st">"Erneuerbare [MWh]"</span>] <span class="op">=</span> generation_2035_ms[renewables_ms].<span class="bu">sum</span>(axis <span class="op">=</span> <span class="st">"columns"</span>).copy()</span>
<span id="cb80-79"><a href="#cb80-79" aria-hidden="true" tabindex="-1"></a>residual_load_2035_ms[<span class="st">"Restlast [MWh]"</span>] <span class="op">=</span> residual_load_2035_ms[<span class="st">"Netzlast [MWh]"</span>] <span class="op">-</span> residual_load_2035_ms[<span class="st">"Erneuerbare [MWh]"</span>]</span>
<span id="cb80-80"><a href="#cb80-80" aria-hidden="true" tabindex="-1"></a>residual_load_2035_ms <span class="op">=</span> residual_load_2035_ms[<span class="st">"Restlast [MWh]"</span>]</span>
<span id="cb80-81"><a href="#cb80-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-82"><a href="#cb80-82" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">2030</span><span class="ch">\n</span><span class="st">======================</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb80-83"><a href="#cb80-83" aria-hidden="true" tabindex="-1"></a>storage_2030_ms <span class="op">=</span> calculate_storage_capacity(residual_load_2030_ms, charge_efficiency <span class="op">=</span> <span class="fl">0.9</span>, discharge_efficiency <span class="op">=</span> <span class="fl">0.88</span>, output <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb80-84"><a href="#cb80-84" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Required storage capacity in 2030: </span><span class="sc">{</span>storage_2030_ms<span class="sc">:,.1f}</span><span class="ss"> MWh"</span>)</span>
<span id="cb80-85"><a href="#cb80-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-86"><a href="#cb80-86" aria-hidden="true" tabindex="-1"></a>renewable_share_2030_ms <span class="op">=</span> calculate_renewable_share(residual_load_2030_ms, grid_load <span class="op">=</span> consumption_2030_ms[<span class="st">'Gesamt (Netzlast) [MWh]'</span>],</span>
<span id="cb80-87"><a href="#cb80-87" aria-hidden="true" tabindex="-1"></a>                                     charge_efficiency <span class="op">=</span> <span class="fl">0.9</span>, discharge_efficiency <span class="op">=</span> <span class="fl">0.88</span>, new_storage_capacitys <span class="op">=</span> [<span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="fl">0.01</span>], output <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb80-88"><a href="#cb80-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-89"><a href="#cb80-89" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">2035</span><span class="ch">\n</span><span class="st">======================</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb80-90"><a href="#cb80-90" aria-hidden="true" tabindex="-1"></a>storage_2035_ms <span class="op">=</span> calculate_storage_capacity(residual_load_2035_ms, charge_efficiency <span class="op">=</span> <span class="fl">0.9</span>, discharge_efficiency <span class="op">=</span> <span class="fl">0.88</span>, output <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb80-91"><a href="#cb80-91" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Required storage capacity in 2035: </span><span class="sc">{</span>storage_2035_ms<span class="sc">:,.1f}</span><span class="ss"> MWh"</span>)</span>
<span id="cb80-92"><a href="#cb80-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-93"><a href="#cb80-93" aria-hidden="true" tabindex="-1"></a>renewable_share_2035_ms <span class="op">=</span> calculate_renewable_share(residual_load_2035_ms, grid_load <span class="op">=</span> consumption_2035_ms[<span class="st">'Gesamt (Netzlast) [MWh]'</span>],</span>
<span id="cb80-94"><a href="#cb80-94" aria-hidden="true" tabindex="-1"></a>                                     charge_efficiency <span class="op">=</span> <span class="fl">0.9</span>, discharge_efficiency <span class="op">=</span> <span class="fl">0.88</span>, new_storage_capacitys <span class="op">=</span> [<span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="fl">0.01</span>], output <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Onshore Wind 2030:  2.00
Offshore Wind 2030: 3.69
Solar 2030:         3.41
Biomass 2030:       0.99


Onshore Wind 2035:  2.73
Offshore Wind 2035: 4.92
Solar 2035:         4.90
Biomass 2035:       0.99

Increase in electricity consumption 2030 vs 2023 factor: 1.44
Increase in electricity consumption 2035 vs 2023 factor: 1.46

2030
======================

Required storage capacity in 2030: 6,170,038.0 MWh
Total grid load: 658,000,000.00
Sum of positive residual load: 175,897,072.30   Sum of negative residual load: -85,250,478.82
Base storage size: 6,170,038.04 Renewable share without storage: 0.73

   relative_storage_capacity  Renewable share Year1  Renewable share Year2
0                       1.00                   0.83                   0.84
1                       0.50                   0.83                   0.83
2                       0.10                   0.81                   0.81
3                       0.01                   0.75                   0.75

2035
======================

Required storage capacity in 2035: 23,829,823.9 MWh
Total grid load: 670,400,000.00
Sum of positive residual load: 125,949,558.61   Sum of negative residual load: -221,510,407.41
Base storage size: 23,829,823.85    Renewable share without storage: 0.81

   relative_storage_capacity  Renewable share Year1  Renewable share Year2
0                       1.00                   0.98                   1.00
1                       0.50                   0.97                   0.97
2                       0.10                   0.94                   0.94
3                       0.01                   0.87                   0.87</code></pre>
</div>
</div>
<p>Sample solution by Marc Sönnecken. For compatibility with this script, the file paths and object names have been adjusted. The definitions of the functions used have been omitted (identical to those shown in the script). The code has been extended so that the output includes some additional blank lines and markers for the year 2030 and the year 2035.</p>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div id="57172730" class="cell" data-execution_count="78">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>my_storage_capacitys <span class="op">=</span> [<span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.6</span>, <span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.08</span>, <span class="fl">0.06</span>, <span class="fl">0.04</span>, <span class="fl">0.02</span>, <span class="fl">0.01</span>]</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>my_charge_efficiency <span class="op">=</span> <span class="fl">0.9</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>my_discharge_efficiency <span class="op">=</span> <span class="fl">0.88</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate 2030 dataset</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="co">## windonshore_growth_factor_2030</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="co">## windoffshore_growth_factor_2030</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="co">## solar_growth_factor_2030</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>generation_2030 <span class="op">=</span> generation.copy()</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>generation_2030[<span class="st">'Wind Onshore [MWh]'</span>] <span class="op">*=</span> windonshore_growth_factor_2030</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>generation_2030[<span class="st">'Wind Offshore [MWh]'</span>] <span class="op">*=</span> windoffshore_growth_factor_2030</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>generation_2030[<span class="st">'Photovoltaik [MWh]'</span>] <span class="op">*=</span> solar_growth_factor_2030</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>renewables_2030 <span class="op">=</span> pd.Series()</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>renewables <span class="op">=</span> [<span class="st">'Biomasse [MWh]'</span>, <span class="st">'Wasserkraft [MWh]'</span>, <span class="st">'Wind Offshore [MWh]'</span>, <span class="st">'Wind Onshore [MWh]'</span>, <span class="st">'Photovoltaik [MWh]'</span>,</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a><span class="st">'Sonstige Erneuerbare [MWh]'</span>]</span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>renewables_2030 <span class="op">=</span> generation_2030[renewables].<span class="bu">sum</span>(axis<span class="op">=</span><span class="st">"columns"</span>).copy()</span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>grid_load_2023 <span class="op">=</span> pd.Series()</span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>grid_load_2023 <span class="op">=</span> consumption[<span class="st">"Gesamt (Netzlast) [MWh]"</span>].copy()</span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>grid_load_2030 <span class="op">=</span> grid_load_2023 <span class="op">*</span> load_factor_2030_MWh</span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a>residual_load_2030 <span class="op">=</span> pd.Series()</span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a>residual_load_2030 <span class="op">=</span> grid_load_2030 <span class="op">-</span> renewables_2030</span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Output</span></span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a>storage_2030 <span class="op">=</span> calculate_storage_capacity(residual_load_2030, charge_efficiency<span class="op">=</span>my_charge_efficiency, discharge_efficiency<span class="op">=</span>my_discharge_efficiency, output<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Maximum required storage capacity 2030: </span><span class="sc">{</span>storage_2030<span class="sc">:,.1f}</span><span class="ss"> MWh</span><span class="ch">\n</span><span class="ss">This corresponds to </span><span class="sc">{</span>storage_2030 <span class="op">/</span> pumped_storage_capacity_MWh<span class="sc">:,.1f}</span><span class="ss"> pumped storage equivalents."</span>)</span>
<span id="cb82-30"><a href="#cb82-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb82-31"><a href="#cb82-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-32"><a href="#cb82-32" aria-hidden="true" tabindex="-1"></a>calculate_curtailment_effect(residual_load_2030, charge_efficiency<span class="op">=</span>my_charge_efficiency, discharge_efficiency<span class="op">=</span>my_discharge_efficiency, new_storage_capacitys<span class="op">=</span>my_storage_capacitys, output<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb82-33"><a href="#cb82-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb82-34"><a href="#cb82-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-35"><a href="#cb82-35" aria-hidden="true" tabindex="-1"></a>calculate_renewable_share(residual_load_2030, grid_load<span class="op">=</span>grid_load_2030, charge_efficiency<span class="op">=</span>my_charge_efficiency, discharge_efficiency<span class="op">=</span>my_discharge_efficiency, new_storage_capacitys<span class="op">=</span>my_storage_capacitys, output<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Maximum required storage capacity 2030: 6,170,038.0 MWh
This corresponds to 165.0 pumped storage equivalents.


    Storage size  Storage Year1  Cycles Year1  Storage Year2  Cycles Year2
0       6.17e+06       7.67e+07         11.99       7.67e+07         12.44
1       5.55e+06       7.67e+07         13.32       7.61e+07         13.71
2       4.94e+06       7.61e+07         14.92       7.55e+07         15.29
3       4.32e+06       7.55e+07         16.98       7.49e+07         17.34
4       3.70e+06       7.49e+07         19.73       7.43e+07         20.06
5       3.09e+06       7.43e+07         23.58       7.36e+07         23.87
6       2.47e+06       7.35e+07         29.29       7.29e+07         29.53
7       1.85e+06       7.17e+07         38.23       7.12e+07         38.45
8       1.23e+06       6.79e+07         54.56       6.76e+07         54.76
9       6.17e+05       5.90e+07         95.05       5.86e+07         94.96
10      4.94e+05       5.59e+07        112.65       5.55e+07        112.41
11      3.70e+05       5.13e+07        137.99       5.09e+07        137.51
12      2.47e+05       4.28e+07        172.79       4.25e+07        172.29
13      1.23e+05       2.66e+07        215.36       2.65e+07        214.86
14      6.17e+04       1.51e+07        243.93       1.50e+07        243.43


    Relative storage size  Curtailed storage Year1  Curtailed storage Year2
0                    0.90                 1.49e-08                 6.17e+05
1                    0.80                 5.95e+05                 1.23e+06
2                    0.70                 1.21e+06                 1.85e+06
3                    0.60                 1.83e+06                 2.47e+06
4                    0.50                 2.45e+06                 3.09e+06
5                    0.40                 3.21e+06                 3.85e+06
6                    0.30                 5.04e+06                 5.55e+06
7                    0.20                 8.78e+06                 9.15e+06
8                    0.10                 1.78e+07                 1.81e+07
9                    0.08                 2.09e+07                 2.12e+07
10                   0.06                 2.55e+07                 2.58e+07
11                   0.04                 3.40e+07                 3.42e+07
12                   0.02                 5.01e+07                 5.02e+07
13                   0.01                 6.16e+07                 6.17e+07


Total grid load: 658,000,000.00
Sum of positive residual load: 175,897,072.30   Sum of negative residual load: -85,250,478.82
Base storage size: 6,170,038.04 Renewable share without storage: 0.73

    relative_storage_capacity  Renewable share Year1  Renewable share Year2
0                        1.00                   0.83                   0.84
1                        0.90                   0.83                   0.83
2                        0.80                   0.83                   0.83
3                        0.70                   0.83                   0.83
4                        0.60                   0.83                   0.83
5                        0.50                   0.83                   0.83
6                        0.40                   0.83                   0.83
7                        0.30                   0.83                   0.83
8                        0.20                   0.82                   0.82
9                        0.10                   0.81                   0.81
10                       0.08                   0.81                   0.81
11                       0.06                   0.80                   0.80
12                       0.04                   0.79                   0.79
13                       0.02                   0.77                   0.77
14                       0.01                   0.75                   0.75</code></pre>
</div>
</div>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<div id="3ee66219" class="cell" data-execution_count="79">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate 2035 dataset</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ## windonshore_growth_factor_2035</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ## windoffshore_growth_factor_2035</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ## solar_growth_factor_2035</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>generation_2035 <span class="op">=</span> generation.copy()</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>generation_2035[<span class="st">'Wind Onshore [MWh]'</span>] <span class="op">*=</span> windonshore_growth_factor_2035</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>generation_2035[<span class="st">'Wind Offshore [MWh]'</span>] <span class="op">*=</span> windoffshore_growth_factor_2035</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>generation_2035[<span class="st">'Photovoltaik [MWh]'</span>] <span class="op">*=</span> solar_growth_factor_2035</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>renewables_2035 <span class="op">=</span> pd.Series()</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>renewables <span class="op">=</span> [<span class="st">'Biomasse [MWh]'</span>, <span class="st">'Wasserkraft [MWh]'</span>, <span class="st">'Wind Offshore [MWh]'</span>, <span class="st">'Wind Onshore [MWh]'</span>, <span class="st">'Photovoltaik [MWh]'</span>,</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a><span class="st">'Sonstige Erneuerbare [MWh]'</span>]</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>renewables_2035 <span class="op">=</span> generation_2035[renewables].<span class="bu">sum</span>(axis<span class="op">=</span><span class="st">"columns"</span>).copy()</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>grid_load_2023 <span class="op">=</span> pd.Series()</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>grid_load_2023 <span class="op">=</span> consumption[<span class="st">"Gesamt (Netzlast) [MWh]"</span>].copy()</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>grid_load_2035 <span class="op">=</span> grid_load_2023 <span class="op">*</span> load_factor_2035_MWh</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>residual_load_2035 <span class="op">=</span> pd.Series()</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>residual_load_2035 <span class="op">=</span> grid_load_2035 <span class="op">-</span> renewables_2035</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Output</span></span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>storage_2035 <span class="op">=</span> calculate_storage_capacity(residual_load_2035, charge_efficiency<span class="op">=</span>my_charge_efficiency, discharge_efficiency<span class="op">=</span>my_discharge_efficiency, output<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Maximum required storage capacity 2035: </span><span class="sc">{</span>storage_2035<span class="sc">:,.1f}</span><span class="ss"> MWh</span><span class="ch">\n</span><span class="ss">This corresponds to </span><span class="sc">{</span>storage_2035 <span class="op">/</span> pumped_storage_capacity_MWh<span class="sc">:,.1f}</span><span class="ss"> pumped storage equivalents."</span>)</span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>calculate_curtailment_effect(residual_load_2035, charge_efficiency<span class="op">=</span>my_charge_efficiency, discharge_efficiency<span class="op">=</span>my_discharge_efficiency, new_storage_capacitys<span class="op">=</span>my_storage_capacitys, output<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>calculate_renewable_share(residual_load_2035, grid_load<span class="op">=</span>grid_load_2035, charge_efficiency<span class="op">=</span>my_charge_efficiency, discharge_efficiency<span class="op">=</span>my_discharge_efficiency, new_storage_capacitys<span class="op">=</span>my_storage_capacitys, output<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Maximum required storage capacity 2035: 23,829,823.9 MWh
This corresponds to 637.2 pumped storage equivalents.


    Storage size  Storage Year1  Cycles Year1  Storage Year2  Cycles Year2
0       2.38e+07       1.49e+08          5.84       1.43e+08          6.01
1       2.14e+07       1.47e+08          6.44       1.41e+08          6.56
2       1.91e+07       1.44e+08          7.17       1.38e+08          7.24
3       1.67e+07       1.42e+08          8.05       1.33e+08          7.99
4       1.43e+07       1.39e+08          9.19       1.29e+08          8.99
5       1.19e+07       1.34e+08         10.73       1.24e+08         10.39
6       9.53e+06       1.29e+08         12.99       1.19e+08         12.49
7       7.15e+06       1.21e+08         16.49       1.14e+08         15.99
8       4.77e+06       1.13e+08         23.15       1.08e+08         22.65
9       2.38e+06       1.01e+08         41.76       9.83e+07         41.26
10      1.91e+06       9.72e+07         50.47       9.53e+07         49.97
11      1.43e+06       9.18e+07         63.73       9.04e+07         63.23
12      9.53e+05       8.23e+07         85.86       8.14e+07         85.36
13      4.77e+05       6.58e+07        137.54       6.53e+07        137.04
14      2.38e+05       4.29e+07        179.40       4.26e+07        178.90


    Relative storage size  Curtailed storage Year1  Curtailed storage Year2
0                    0.90                 2.38e+06                 2.38e+06
1                    0.80                 4.77e+06                 5.01e+06
2                    0.70                 7.15e+06                 9.77e+06
3                    0.60                 1.07e+07                 1.45e+07
4                    0.50                 1.55e+07                 1.93e+07
5                    0.40                 2.07e+07                 2.41e+07
6                    0.30                 2.78e+07                 2.88e+07
7                    0.20                 3.65e+07                 3.52e+07
8                    0.10                 4.86e+07                 4.48e+07
9                    0.08                 5.21e+07                 4.79e+07
10                   0.06                 5.74e+07                 5.27e+07
11                   0.04                 6.69e+07                 6.18e+07
12                   0.02                 8.35e+07                 7.78e+07
13                   0.01                 1.06e+08                 1.00e+08


Total grid load: 670,400,000.00
Sum of positive residual load: 125,949,558.61   Sum of negative residual load: -221,510,407.41
Base storage size: 23,829,823.85    Renewable share without storage: 0.81

    relative_storage_capacity  Renewable share Year1  Renewable share Year2
0                        1.00                   0.98                   1.00
1                        0.90                   0.98                   1.00
2                        0.80                   0.98                   0.99
3                        0.70                   0.98                   0.99
4                        0.60                   0.98                   0.98
5                        0.50                   0.97                   0.97
6                        0.40                   0.97                   0.97
7                        0.30                   0.96                   0.96
8                        0.20                   0.95                   0.95
9                        0.10                   0.94                   0.94
10                       0.08                   0.94                   0.94
11                       0.06                   0.93                   0.93
12                       0.04                   0.92                   0.92
13                       0.02                   0.90                   0.90
14                       0.01                   0.87                   0.87</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<section id="graphical-representation-of-selected-storage-configurations" class="level3">
<h3 class="anchored" data-anchor-id="graphical-representation-of-selected-storage-configurations">Graphical Representation of Selected Storage Configurations</h3>
<p>A graphical representation of the annual storage profile can be generated for different configurations relative to the maximum required storage capacity (C<span class="math inline">\(_{max}\)</span>) using the function <code>calculate_annual_storage(output = False)</code>. First, a residual load curve for the years 2030 and 2035 is calculated from the projected grid load and the planned renewable expansion.</p>
<div id="029f2c8a" class="cell" data-execution_count="80">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate residual load 2030</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co">## windonshore_growth_factor_2030</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="co">## windoffshore_growth_factor_2030</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co">## solar_growth_factor_2030</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>generation_2030 <span class="op">=</span> generation.copy()</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>generation_2030[<span class="st">'Wind Onshore [MWh]'</span>] <span class="op">*=</span> windonshore_growth_factor_2030</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>generation_2030[<span class="st">'Wind Offshore [MWh]'</span>] <span class="op">*=</span> windoffshore_growth_factor_2030</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>generation_2030[<span class="st">'Photovoltaik [MWh]'</span>] <span class="op">*=</span> solar_growth_factor_2030</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>renewables_2030 <span class="op">=</span> pd.Series()</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>renewables <span class="op">=</span> [<span class="st">'Biomasse [MWh]'</span>, <span class="st">'Wasserkraft [MWh]'</span>, <span class="st">'Wind Offshore [MWh]'</span>, <span class="st">'Wind Onshore [MWh]'</span>, <span class="st">'Photovoltaik [MWh]'</span>, <span class="st">'Sonstige Erneuerbare [MWh]'</span>]</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>renewables_2030 <span class="op">=</span> generation_2030[renewables].<span class="bu">sum</span>(axis<span class="op">=</span><span class="st">"columns"</span>).copy()</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>grid_load_2023 <span class="op">=</span> pd.Series()</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>grid_load_2023 <span class="op">=</span> consumption[<span class="st">"Gesamt (Netzlast) [MWh]"</span>].copy()</span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>grid_load_2030 <span class="op">=</span> grid_load_2023 <span class="op">*</span> load_factor_2030_MWh</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>residual_load_2030 <span class="op">=</span> pd.Series()</span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>residual_load_2030 <span class="op">=</span> grid_load_2030 <span class="op">-</span> renewables_2030</span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate residual load 2035</span></span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a><span class="co">## windonshore_growth_factor_2035</span></span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a><span class="co">## windoffshore_growth_factor_2035</span></span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a><span class="co">## solar_growth_factor_2035</span></span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>generation_2035 <span class="op">=</span> generation.copy()</span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a>generation_2035[<span class="st">'Wind Onshore [MWh]'</span>] <span class="op">*=</span> windonshore_growth_factor_2035</span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a>generation_2035[<span class="st">'Wind Offshore [MWh]'</span>] <span class="op">*=</span> windoffshore_growth_factor_2035</span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a>generation_2035[<span class="st">'Photovoltaik [MWh]'</span>] <span class="op">*=</span> solar_growth_factor_2035</span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a>renewables_2035 <span class="op">=</span> pd.Series()</span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a>renewables <span class="op">=</span> [<span class="st">'Biomasse [MWh]'</span>, <span class="st">'Wasserkraft [MWh]'</span>, <span class="st">'Wind Offshore [MWh]'</span>, <span class="st">'Wind Onshore [MWh]'</span>, <span class="st">'Photovoltaik [MWh]'</span>, <span class="st">'Sonstige Erneuerbare [MWh]'</span>]</span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a>renewables_2035 <span class="op">=</span> generation_2035[renewables].<span class="bu">sum</span>(axis<span class="op">=</span><span class="st">"columns"</span>).copy()</span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a>grid_load_2023 <span class="op">=</span> pd.Series()</span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a>grid_load_2023 <span class="op">=</span> consumption[<span class="st">"Gesamt (Netzlast) [MWh]"</span>].copy()</span>
<span id="cb86-38"><a href="#cb86-38" aria-hidden="true" tabindex="-1"></a>grid_load_2035 <span class="op">=</span> grid_load_2023 <span class="op">*</span> load_factor_2035_MWh</span>
<span id="cb86-39"><a href="#cb86-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-40"><a href="#cb86-40" aria-hidden="true" tabindex="-1"></a>residual_load_2035 <span class="op">=</span> pd.Series()</span>
<span id="cb86-41"><a href="#cb86-41" aria-hidden="true" tabindex="-1"></a>residual_load_2035 <span class="op">=</span> grid_load_2035 <span class="op">-</span> renewables_2035</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>&nbsp;</p>
<p>Based on the calculated residual load curves, 80%, 20%, and 4% configurations of the maximum required storage capacity are calculated and visualized.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true" href="">80% 2030</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false" href="">80% 2035</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-3" role="tab" aria-controls="tabset-18-3" aria-selected="false" href="">20% 2030</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-4" role="tab" aria-controls="tabset-18-4" aria-selected="false" href="">20% 2035</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-5" role="tab" aria-controls="tabset-18-5" aria-selected="false" href="">4% 2030</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-6" role="tab" aria-controls="tabset-18-6" aria-selected="false" href="">4% 2035</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-7" role="tab" aria-controls="tabset-18-7" aria-selected="false" href="">Code Example</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div id="084940d4" class="cell" data-execution_count="81">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-82-output-1.png" alt="The plot shows the residual load for the year 2030, which is mostly negative but subject to strong and very frequent fluctuations. It also shows the annual profiles in year 1 and year 2 of the storage with a capacity of 80% of the maximum required storage, a charge efficiency of 0.9, and a discharge efficiency of 0.88. In year 1, the storage feeds into the grid and charges continuously until mid-January. By mid-March, the storage frequently discharges strongly or completely. Then, during summer until early December, the storage remains fully or nearly fully charged. In the first half of December, the storage discharges strongly for an extended period and fully twice. By the end of December, it reaches full charge again, which carries into year 2, otherwise similar to year 1." width="710" height="569" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of cycles year 1: 14.92
Number of cycles year 2: 15.29
Total grid load: 658,000,000.00
Sum of positive residual load: 175,897,072.30   Sum of negative residual load: -85,250,478.82
Base storage size: 6,170,038.04 Renewable share without storage: 0.73

   relative_storage_capacity  Renewable share Year1  Renewable share Year2
0                        1.0                   0.83                   0.84
1                        0.8                   0.83                   0.83

The storage size is 4,936,030.4 MWh
This corresponds to 132.0 pumped storage equivalents.</code></pre>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div id="f9aca20c" class="cell" data-execution_count="82">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-83-output-1.png" alt="The plot shows the residual load for the year 2035, which is mostly negative and rarely positive despite strong and frequent fluctuations. It also shows the annual profiles in year 1 and year 2 of the storage with a capacity of 80% of the maximum required storage, a charge efficiency of 0.9, and a discharge efficiency of 0.88. In year 1, the storage feeds into the grid and charges continuously until fully charged after a few days. From mid to late January, the storage discharges strongly, reaching full depletion. From early February to early December, the storage remains nearly fully charged. In the first half of December, the storage discharges strongly but is only briefly empty. By the end of December, full charge is reached again, which carries into year 2, otherwise similar to year 1." width="710" height="569" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of cycles year 1: 7.17
Number of cycles year 2: 7.24
Total grid load: 670,400,000.00
Sum of positive residual load: 125,949,558.61   Sum of negative residual load: -221,510,407.41
Base storage size: 23,829,823.85    Renewable share without storage: 0.81

   relative_storage_capacity  Renewable share Year1  Renewable share Year2
0                        1.0                   0.98                   1.00
1                        0.8                   0.98                   0.99

The storage size is 19,063,859.1 MWh
This corresponds to 509.7 pumped storage equivalents.</code></pre>
</div>
</div>
</div>
<div id="tabset-18-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-3-tab">
<div id="10c57d63" class="cell" data-execution_count="83">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-84-output-1.png" alt="The plot shows the residual load for the year 2030, corresponding to the previous scenario. It also shows the annual profiles in year 1 and year 2 of the storage with a capacity of 20% of the maximum required storage, a charge efficiency of 0.9, and a discharge efficiency of 0.88. In year 1, the storage feeds into the grid and charges continuously until fully charged after a few days. From mid-January to mid-March, the storage discharges strongly four times to full depletion. From mid-March to mid-August, the storage remains nearly fully charged. This is followed by a one-month period of strong and temporarily full discharge. From mid-September to early December, pronounced charge and discharge cycles occur. At the beginning of December, the storage is empty for several days, then briefly reaches a high charge level before discharging fully again. In the second half of December, full charge is reached again, which carries into year 2, otherwise similar to year 1." width="710" height="569" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of cycles year 1: 54.56
Number of cycles year 2: 54.76
Total grid load: 658,000,000.00
Sum of positive residual load: 175,897,072.30   Sum of negative residual load: -85,250,478.82
Base storage size: 6,170,038.04 Renewable share without storage: 0.73

   relative_storage_capacity  Renewable share Year1  Renewable share Year2
0                        1.0                   0.83                   0.84
1                        0.2                   0.82                   0.82

The storage size is 1,234,007.6 MWh
This corresponds to 33.0 pumped storage equivalents.</code></pre>
</div>
</div>
</div>
<div id="tabset-18-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-4-tab">
<div id="af543c7e" class="cell" data-execution_count="84">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-85-output-1.png" alt="The plot shows the residual load for the year 2035, corresponding to the previous scenario. It also shows the annual profiles in year 1 and year 2 of the storage with a capacity of 20% of the maximum required storage, a charge efficiency of 0.9, and a discharge efficiency of 0.88. The annual profiles are similar to those in 2030. However, the periods of strong discharge at the beginning of the year are significantly shorter, and the storage usually reaches full charge again after a short time. The strong discharge at the end of August does not occur; the storage drops only to about half capacity. The strong discharge in early December is less drastic but still occurs fully several times." width="710" height="569" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of cycles year 1: 23.15
Number of cycles year 2: 22.65
Total grid load: 670,400,000.00
Sum of positive residual load: 125,949,558.61   Sum of negative residual load: -221,510,407.41
Base storage size: 23,829,823.85    Renewable share without storage: 0.81

   relative_storage_capacity  Renewable share Year1  Renewable share Year2
0                        1.0                   0.98                   1.00
1                        0.2                   0.95                   0.95

The storage size is 4,765,964.8 MWh
This corresponds to 127.4 pumped storage equivalents.</code></pre>
</div>
</div>
</div>
<div id="tabset-18-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-5-tab">
<div id="2fc412ed" class="cell" data-execution_count="85">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-86-output-1.png" alt="The plot shows the residual load for the year 2030, which corresponds to the previous scenario. It also shows the annual profiles in year 1 and year 2 of the storage with a capacity of 4% of the maximum required storage, a charge efficiency of 0.9, and a discharge efficiency of 0.88. Throughout the year, short consecutive cycles of full charge and discharge occur. Only in early January and late December is the storage full for approximately 2 weeks each." width="710" height="569" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of cycles year 1: 172.79
Number of cycles year 2: 172.29
Total grid load: 658,000,000.00
Sum of positive residual load: 175,897,072.30   Sum of negative residual load: -85,250,478.82
Base storage size: 6,170,038.04 Renewable share without storage: 0.73

   relative_storage_capacity  Renewable share Year1  Renewable share Year2
0                       1.00                   0.83                   0.84
1                       0.04                   0.79                   0.79

The storage size is 246,801.5 MWh
This corresponds to 6.6 pumped storage equivalents.</code></pre>
</div>
</div>
</div>
<div id="tabset-18-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-6-tab">
<div id="228f6f3d" class="cell" data-execution_count="86">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="energiedatenanalyse_files/figure-html/cell-87-output-1.png" alt="The plot shows the residual load for the year 2035, which corresponds to the previous scenario. It also shows the annual profiles in year 1 and year 2 of the storage with a capacity of 4% of the maximum required storage, a charge efficiency of 0.9, and a discharge efficiency of 0.88. Throughout the year, short consecutive cycles of full charge and discharge occur. Only in early January and late December is the storage full for approximately 2 weeks. During the summer, the cycle density is even higher than in 2030." width="710" height="569" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of cycles year 1: 85.86
Number of cycles year 2: 85.36
Total grid load: 670,400,000.00
Sum of positive residual load: 125,949,558.61   Sum of negative residual load: -221,510,407.41
Base storage size: 23,829,823.85    Renewable share without storage: 0.81

   relative_storage_capacity  Renewable share Year1  Renewable share Year2
0                       1.00                   0.98                   1.00
1                       0.04                   0.92                   0.92

The storage size is 953,193.0 MWh
This corresponds to 25.5 pumped storage equivalents.</code></pre>
</div>
</div>
</div>
<div id="tabset-18-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-7-tab">
<div id="6e8af740" class="cell" data-execution_count="87">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Determine storage size and calculate 80 percent</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>storage_capacity_2030_80 <span class="op">=</span> calculate_storage_capacity(residual_load_2030, charge_efficiency<span class="op">=</span><span class="fl">0.9</span>, discharge_efficiency<span class="op">=</span><span class="fl">0.88</span>, output<span class="op">=</span><span class="va">False</span>) <span class="op">*</span> <span class="fl">0.8</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Determine annual storage profile</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>storage_2030_80_eff_90_88 <span class="op">=</span> calculate_annual_storage(residual_load_2030, storage_capacity<span class="op">=</span>storage_capacity_2030_80, charge_efficiency<span class="op">=</span><span class="fl">0.9</span>, discharge_efficiency<span class="op">=</span><span class="fl">0.88</span>, output<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>annual_storage_year1 <span class="op">=</span> storage_2030_80_eff_90_88[<span class="dv">1</span>]</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>annual_storage_year2 <span class="op">=</span> storage_2030_80_eff_90_88[<span class="dv">2</span>]</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate x-ticks</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>months_index <span class="op">=</span> generation[<span class="op">~</span>generation[<span class="st">"Datum von"</span>].dt.month.duplicated()].index</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>month_names <span class="op">=</span> generation[<span class="st">"Datum von"</span>].iloc[months_index].dt.strftime(<span class="st">"%B"</span>) </span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot with three subplots</span></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2, ax3) <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="fl">7.5</span>, <span class="dv">6</span>), height_ratios<span class="op">=</span>[<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>], sharex<span class="op">=</span><span class="va">True</span>, layout<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Residual Load 2030 and Annual Profile of a Storage with</span><span class="ch">\n</span><span class="st"> C$_</span><span class="sc">{max}</span><span class="st">$ = 0.8, η$_</span><span class="sc">{charge}</span><span class="st">$ = 0.9 and η$_</span><span class="sc">{discharge}</span><span class="st">$ = 0.88'</span>)</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>plt.xticks(months_index, month_names, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>plt.minorticks_off()</span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>plt.setp([ax1, ax2, ax3], xlim<span class="op">=</span>(residual_load.index.<span class="bu">min</span>() <span class="op">-</span> <span class="bu">len</span>(residual_load.index)<span class="op">/</span><span class="dv">100</span>, residual_load.index.<span class="bu">max</span>() <span class="op">*</span> <span class="fl">1.01</span>))</span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a>plt.setp([ax2, ax3], ylim<span class="op">=</span>(<span class="dv">0</span>, <span class="bu">max</span>(<span class="bu">max</span>(annual_storage_year1), <span class="bu">max</span>(annual_storage_year2)) <span class="op">*</span> <span class="fl">1.2</span>))</span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a><span class="co">## Plot residual load</span></span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a>ax1.plot(residual_load_2030, label<span class="op">=</span><span class="st">"Residual Load"</span>)</span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a>ax1.grid()</span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'MWh'</span>)</span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a>ax1.legend()</span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-29"><a href="#cb93-29" aria-hidden="true" tabindex="-1"></a><span class="co">## Plot annual_storage_year1</span></span>
<span id="cb93-30"><a href="#cb93-30" aria-hidden="true" tabindex="-1"></a>ax2.plot(annual_storage_year1, color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, label<span class="op">=</span><span class="st">'Storage Year 1'</span>)</span>
<span id="cb93-31"><a href="#cb93-31" aria-hidden="true" tabindex="-1"></a>ax2.grid()</span>
<span id="cb93-32"><a href="#cb93-32" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'MWh'</span>)</span>
<span id="cb93-33"><a href="#cb93-33" aria-hidden="true" tabindex="-1"></a>ax2.legend()</span>
<span id="cb93-34"><a href="#cb93-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-35"><a href="#cb93-35" aria-hidden="true" tabindex="-1"></a><span class="co">## Plot annual_storage_year2</span></span>
<span id="cb93-36"><a href="#cb93-36" aria-hidden="true" tabindex="-1"></a>ax3.plot(annual_storage_year2, color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, label<span class="op">=</span><span class="st">'Storage Year 2'</span>)</span>
<span id="cb93-37"><a href="#cb93-37" aria-hidden="true" tabindex="-1"></a>ax3.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb93-38"><a href="#cb93-38" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">'MWh'</span>)</span>
<span id="cb93-39"><a href="#cb93-39" aria-hidden="true" tabindex="-1"></a>ax3.grid()</span>
<span id="cb93-40"><a href="#cb93-40" aria-hidden="true" tabindex="-1"></a>ax3.legend()</span>
<span id="cb93-41"><a href="#cb93-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-42"><a href="#cb93-42" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb93-43"><a href="#cb93-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-44"><a href="#cb93-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate number of cycles; passing tuple of efficiencies not needed</span></span>
<span id="cb93-45"><a href="#cb93-45" aria-hidden="true" tabindex="-1"></a>calculate_cycles(storage_2030_80_eff_90_88, output<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-46"><a href="#cb93-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-47"><a href="#cb93-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate renewable share</span></span>
<span id="cb93-48"><a href="#cb93-48" aria-hidden="true" tabindex="-1"></a>calculate_renewable_share(residual_load_2030, grid_load<span class="op">=</span>grid_load_2030, charge_efficiency<span class="op">=</span><span class="fl">0.9</span>, discharge_efficiency<span class="op">=</span><span class="fl">0.88</span>, new_storage_capacitys<span class="op">=</span>[<span class="fl">0.8</span>], output<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-49"><a href="#cb93-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-50"><a href="#cb93-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Print storage size</span></span>
<span id="cb93-51"><a href="#cb93-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">The storage size is </span><span class="sc">{</span>storage_2030_80_eff_90_88[<span class="dv">0</span>]<span class="sc">:,.1f}</span><span class="ss"> MWh</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb93-52"><a href="#cb93-52" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"This corresponds to </span><span class="sc">{</span>storage_2030_80_eff_90_88[<span class="dv">0</span>] <span class="op">/</span> pumped_storage_capacity_MWh<span class="sc">:,.1f}</span><span class="ss"> pumped storage equivalents."</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
<p>With an 80-percent sizing of the storage, the system appears oversized. In 2030, the storage can hardly utilize its full capacity over the course of the year. The storage rarely reaches state-of-charge levels around 50 percent. Only during the turn of the year is the maximum capacity used. In contrast, in 2035 the storage is mostly fully charged, and only minimal charging and discharging occurs. In particular, in 2035 the storage undergoes only a few full cycles.</p>
<p>The storage capacity required in 2030 of 4,936 GWh corresponds to 132 times the existing pumped-storage plants or 99 annual productions of the Tesla Gigafactory Berlin-Brandenburg in its first expansion stage with 50 GWh/year (<a href="https://en.wikipedia.org/wiki/List_of_battery_cell_factories_in_Germany">Wikipedia</a>). The storage capacity required in 2035 of 19,064 GWh corresponds to 510 times the existing pumped-storage plants or 381 annual productions of the Tesla Gigafactory Berlin-Brandenburg.<br>
<strong>Note:</strong> The reference to the Tesla Gigafactory Berlin-Brandenburg is only for context. The Grünheide factory currently does not produce battery cells. Plans for additional battery factories in Germany have recently been canceled.</p>
<p>With a 20-percent sizing, more full cycles and more extensive partial cycles are achieved. Nevertheless, in 2035 consistently high state-of-charge levels are observed from April to the end of August. In 2030, 1,234 GWh of storage capacity would be needed, and in 2035, 4,766 GWh. This corresponds to 33 and 127 times the existing pumped-storage capacity or 25 and 95 annual productions of the Tesla Gigafactory Berlin-Brandenburg in the first expansion stage.</p>
<p>The 4-percent sizing shows a constant up-and-down pattern. At this scale, operating a storage economically could be feasible. This would require 247 GWh in 2030 and 953 GWh in 2035. 247 GWh corresponds to 6.6 times the existing pumped-storage capacity or 5 annual productions of the Tesla Gigafactory Berlin-Brandenburg in the first expansion stage. 953 GWh corresponds to 25.5 pumped-storage equivalents and 19 annual productions of the Tesla Gigafactory Berlin-Brandenburg.</p>
<p>In all scenarios, it is notable that the number of cycles in year 1 and year 2 is almost identical. The difference of half a cycle arises because the storage starts the first year empty. Depending on the scenario, the storage is then first fully charged over the course of the year (80% sizing), within a few weeks (20% sizing), or almost immediately (4% sizing).</p>
<p>It is evident that the 80-20 rule (<a href="https://en.wikipedia.org/wiki/Pareto_principle">Pareto principle</a>) applies to storage sizing: 20 percent of the effort achieves 80 percent of the result. If in 2035 the share of renewable energy without storage is 81 percent, then 19 percent must be covered by storage (or otherwise). To achieve 100 percent demand coverage from electricity storage, 23.8 TWh of storage capacity would be required. A storage 20 percent of this size achieves a total renewable share of 95 percent. A storage 20 percent of that size achieves a total share of 92 percent.</p>
</section>
</section>
<section id="bonus-estimating-the-required-peak-power-of-backup-power-plants" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="bonus-estimating-the-required-peak-power-of-backup-power-plants"><span class="header-section-number">7.6</span> Bonus: Estimating the Required Peak Power of Backup Power Plants</h2>
<p>From the calculation of different storage sizes, it became clear that even relatively small storage systems can lead to a high share of renewable energy in the electricity mix. Nevertheless, smaller storage capacities mean that at certain times, the grid load must be met by backup load-following power plants. In this section, the required generation capacity of these backup plants is estimated. The maximum positive residual load after discharging is multiplied by four, since the dataset is based on 15-minute intervals.</p>
<div id="b5678daa" class="cell" data-execution_count="88">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>peak_power_2030 <span class="op">=</span> calculate_renewable_share(residual_load_2030, grid_load <span class="op">=</span> grid_load_2030, charge_efficiency <span class="op">=</span> <span class="fl">0.9</span>, discharge_efficiency <span class="op">=</span> <span class="fl">0.88</span>, new_storage_capacitys <span class="op">=</span> [<span class="fl">0.2</span>, <span class="fl">0.04</span>], output <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>peak_power_2035 <span class="op">=</span> calculate_renewable_share(residual_load_2035, grid_load <span class="op">=</span> grid_load_2035, charge_efficiency <span class="op">=</span> <span class="fl">0.9</span>, discharge_efficiency <span class="op">=</span> <span class="fl">0.88</span>, new_storage_capacitys <span class="op">=</span> [<span class="fl">0.2</span>, <span class="fl">0.04</span>], output <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Examine data structure</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Column 0 contains storage size = 1, the following columns contain the new storage sizes. Row 0 contains the residual load curve for year 1, row 1 for year 2</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print(peak_power_2030.shape)</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print(peak_power_2030.head())</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Row 1 contains the annual profile in year 2</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Column 0 contains the baseline scenario with storage size = 1</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Peak power 2030 for Cmax = 0.20: </span><span class="sc">{</span><span class="bu">max</span>(peak_power_2030.iloc[<span class="dv">1</span>, <span class="dv">1</span>]) <span class="op">*</span> <span class="dv">4</span> <span class="op">/</span> <span class="dv">1000</span><span class="sc">:.2f}</span><span class="ss"> GW</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Peak power 2030 for Cmax = 0.04: </span><span class="sc">{</span><span class="bu">max</span>(peak_power_2030.iloc[<span class="dv">1</span>, <span class="dv">2</span>]) <span class="op">*</span> <span class="dv">4</span> <span class="op">/</span> <span class="dv">1000</span><span class="sc">:.2f}</span><span class="ss"> GW</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Peak power 2035 for Cmax = 0.20: </span><span class="sc">{</span><span class="bu">max</span>(peak_power_2035.iloc[<span class="dv">1</span>, <span class="dv">1</span>]) <span class="op">*</span> <span class="dv">4</span> <span class="op">/</span> <span class="dv">1000</span><span class="sc">:.2f}</span><span class="ss"> GW</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"Peak power 2035 for Cmax = 0.04: </span><span class="sc">{</span><span class="bu">max</span>(peak_power_2035.iloc[<span class="dv">1</span> , <span class="dv">2</span>]) <span class="op">*</span> <span class="dv">4</span> <span class="op">/</span> <span class="dv">1000</span><span class="sc">:.2f}</span><span class="ss"> GW"</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Peak power 2030 for Cmax = 0.20: 87.64 GW
Peak power 2030 for Cmax = 0.04: 87.64 GW
Peak power 2035 for Cmax = 0.20: 87.53 GW
Peak power 2035 for Cmax = 0.04: 87.53 GW</code></pre>
</div>
</div>
</section>
</section>
<section id="key-takeaways" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Key Takeaways</h1>
<p>In the comparative analysis of generation and consumption data for Germany and Austria, it became clear that comparable datasets can be structured differently. The intention behind the compilation of a dataset does not necessarily align with the objectives of your analysis, which, for example, may justify separating power plants from energy storage systems. In this module, you have learned two general approaches for analyzing datasets that can be applied to other domains and datasets. The first approach involves reading, organizing, checking, and validating data. The second approach involves describing, exploring, and evaluating data using key metrics and data visualization techniques.</p>
<p>Metric-based and visual methods of data analysis complement each other and help in understanding a dataset. For example, a purely metric-based approach might easily overlook the shutdown of German nuclear power plants, whereas this is clearly visible in the graphical representation of the annual profile. Conversely, when solely visualizing the generation share of different power plant types in Austria, charging and discharging of storage systems might be unintentionally summed.</p>
<p>The tools presented provide you with the means to make data-driven decisions and participate in climate and energy policy discussions. However, you should always keep in mind that analyzing aggregate data simplifies relationships and carries the risk of ecological misinterpretation. A comprehensive data analysis therefore also involves reflecting on and transparently communicating the blind spots in your own approach.</p>
</section>
<section id="learning-check" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Learning Check</h1>
<section id="skills-quiz" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="skills-quiz"><span class="header-section-number">9.1</span> Skills Quiz</h2>
<!-- (Optionally collapsible callout block, text reference for PDF, polished solutions can be decided later via Lumi) -->
<ol class="example" type="1">
<li>What is the full command to convert the following string into a <code>datetime</code> object using the Python module Pandas?</li>
</ol>
<pre class="{raw}"><code>
date_str = '2008-Oct-29'
date_pd = pd.to_datetime(date_str, format = " ... ")
</code></pre>
<p>&nbsp;</p>
<ol start="2" class="example" type="1">
<li><p>Which method can be used to concatenate the data series a, b, and c?</p>
<ol type="a">
<li><p>pandas.concat(a, b, c)</p></li>
<li><p>pandas.append(a, b, c)</p></li>
<li><p>pandas.concatenate[a, b, c]</p></li>
<li><p>pandas.concat([a, b, c])</p></li>
</ol></li>
</ol>
<p>&nbsp;</p>
<ol start="3" class="example" type="1">
<li><p>What is the purpose of descriptive data analysis?</p>
<ol type="a">
<li><p>Identify errors in the dataset</p></li>
<li><p>Load required modules</p></li>
<li><p>Prepare for exploratory and inferential data analysis</p></li>
<li><p>Gain an overview of the dataset</p></li>
</ol></li>
</ol>
<p>&nbsp;</p>
<ol start="4" class="example" type="1">
<li><p>Which statements are true?</p>
<ol type="a">
<li><p>Exploratory data analysis is an iterative process to explore a dataset and generate new questions based on the insights gained.</p></li>
<li><p>The methods of exploratory data analysis are strictly predefined.</p></li>
<li><p>Exploratory data analysis is purely numeric.</p></li>
<li><p>Exploratory data analysis prepares for inferential data analysis.</p></li>
</ol></li>
</ol>
<p>&nbsp;</p>
<ol start="5" class="example" type="1">
<li><p>The sizing of an electricity storage system depends on:</p>
<ol type="a">
<li><p>The cyclic nature of charging</p></li>
<li><p>The ratio of storable excess generation to the load to be served by the storage</p></li>
<li><p>The capping of generation peaks</p></li>
<li><p>The efficiency of the storage system</p></li>
</ol></li>
</ol>
<div id="tip-skills-quiz" class="callout callout-style-default callout-tip callout-titled" title="Solutions">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tipp&nbsp;9.1: Solutions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Solution 1: date_pd = pd.to_datetime(date_str, format = “%Y-%b-%d”)</p>
<p>Solution 2: pandas.concat([a, b, c])</p>
<p>Solution 3: a, c, d</p>
<p>Solution 4: a, d</p>
<p>Solution 5: a, b, c, d</p>
</div>
</div>
</div>
</section>
<section id="exercises" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="exercises"><span class="header-section-number">9.2</span> Exercises</h2>
<p>Within the framework of inferential data analysis, it was found that by capping generation peaks in a power system dominated by renewable surplus production, the required electricity storage can be dimensioned orders of magnitude smaller. However, a few percent of the annual electricity demand would remain that cannot be covered by ongoing renewable generation or storage. One option would be to operate biomass power plants in load-following mode.</p>
<p>Calculate the required storage size (charging efficiency = 0.9, discharging efficiency = 0.88) if the share of renewable energy in 2035 is to be 100 percent and biomass power plants are operated in load-following mode. Assume that biomass plants store gas production during periods when the electricity demand is fully met by other renewable sources and generate electricity when there is positive residual load. The production profile of biogas plants corresponds to the generation curve of 2023.</p>
<ul>
<li><p>How large would the gas storage need to be (in MWh of electrical energy)?</p></li>
<li><p>What is the maximum required electricity generation capacity of the biomass plants, both absolute and relative to the installed 2023 capacity?</p></li>
<li><p>How large does the required electricity storage need to be if biomass power plants are operated in load-following mode?</p></li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-energy-charts-strom" class="csl-entry" role="listitem">
Fraunhofer Institut für Solare Energiesysteme ISE. o.&nbsp;J. <span>„Öffentliche Nettostromerzeugung in Deutschland“</span>. Zugegriffen 3. Juni 2024. <a href="https://energy-charts.info/charts/energy/chart.htm?l=de&amp;c=DE&amp;chartColumnSorting=default&amp;year=-1&amp;interval=year&amp;legendItems=lz1zb&amp;source=public">https://energy-charts.info/charts/energy/chart.htm?l=de&amp;c=DE&amp;chartColumnSorting=default&amp;year=-1&amp;interval=year&amp;legendItems=lz1zb&amp;source=public</a>.
</div>
<div id="ref-Heimerl-Kohler-2017-Pumpspeicher-in-Deutschland" class="csl-entry" role="listitem">
Heimerl, Stephan, und Beate Kohler. 2017. <span>„Aktueller Stand der Pumpspeicherkraftwerke in Deutschland“</span>. WasserWirtschaft. 2017. <a href="https://www.fwt.fichtner.de/userfiles/fileadmin-fwt/Publikationen/WaWi_2017_10_Heimerl_Kohler_PSKW.pdf">https://www.fwt.fichtner.de/userfiles/fileadmin-fwt/Publikationen/WaWi_2017_10_Heimerl_Kohler_PSKW.pdf</a>.
</div>
<div id="ref-R-for-Data-Science" class="csl-entry" role="listitem">
Wickham, Hadley, Mine Çetinkaya-Rundel, und Garrett Grolemund. 2023. <span>„R for data science: Import, tidy, transform, visualize, and model data“</span>. Beijing; Boston; Farnham; Sebastopol; Tokyo: O’Reilly. 2023. <a href="https://r4ds.hadley.nz/">https://r4ds.hadley.nz/</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Kopiert");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Kopiert");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../index.html" class="pagination-link" aria-label="Preamble">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preamble</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/bausteine-der-datenanalyse/a-energiedatenanalyse/blob/main/skript/energiedatenanalyse.qmd" class="toc-action"><i class="bi bi-github"></i>Quellcode anzeigen</a></li></ul></div></div></div></footer></body></html>